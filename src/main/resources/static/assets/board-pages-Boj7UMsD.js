var e=Object.defineProperty,t=Object.defineProperties,r=Object.getOwnPropertyDescriptors,n=Object.getOwnPropertySymbols,s=Object.prototype.hasOwnProperty,a=Object.prototype.propertyIsEnumerable,i=(t,r,n)=>r in t?e(t,r,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[r]=n,l=(e,t)=>{for(var r in t||(t={}))s.call(t,r)&&i(e,r,t[r]);if(n)for(var r of n(t))a.call(t,r)&&i(e,r,t[r]);return e},o=(e,n)=>t(e,r(n)),c=(e,t)=>{var r={};for(var i in e)s.call(e,i)&&t.indexOf(i)<0&&(r[i]=e[i]);if(null!=e&&n)for(var i of n(e))t.indexOf(i)<0&&a.call(e,i)&&(r[i]=e[i]);return r},d=(e,t,r)=>i(e,"symbol"!=typeof t?t+"":t,r),u=(e,t,r)=>new Promise((n,s)=>{var a=e=>{try{l(r.next(e))}catch(t){s(t)}},i=e=>{try{l(r.throw(e))}catch(t){s(t)}},l=e=>e.done?n(e.value):Promise.resolve(e.value).then(a,i);l((r=r.apply(e,t)).next())});import{c as h,R as m,j as g,C as p,a as y,b as f,d as N,T as b,I as x,u as v,e as w,r as E,P as T,M as C,S as R,f as A,E as O,g as I,U as S,H as k,h as _,i as $,k as L,l as D,m as U,n as j,A as M,o as B,p as P,F as K,B as F,q as z,s as V,L as H,t as W,v as q,w as J,Q as Y,x as Q,y as G}from"./react-vendor-DjlEhPtN.js";import{B as Z,M as X,a as ee,b as te,c as re,d as ne,I as se}from"./core-ui-CLdLL7GI.js";import{t as ae,c as ie,a as le}from"./style-utils-DeQRAeyh.js";import{a as oe}from"./http-client-9JY-woyA.js";import{p as ce}from"./state-management-DnGX11vy.js";function de(e){return"object"==typeof e&&null!==e&&"message"in e&&"code"in e&&"status"in e&&"timestamp"in e&&"path"in e}function ue(e){return e instanceof Error&&"code"in e&&["NETWORK_ERROR","TIMEOUT_ERROR","CONNECTION_ERROR"].includes(e.code)}function he(e){return de(e)&&["UNAUTHORIZED","FORBIDDEN","TOKEN_EXPIRED","INVALID_CREDENTIALS"].includes(e.code)}function me(e){return de(e)&&["VALIDATION_FAILED","RESOURCE_NOT_FOUND","BUSINESS_RULE_VIOLATION"].includes(e.code)}function ge(e){return de(e)&&["INTERNAL_ERROR","SERVICE_UNAVAILABLE","DATABASE_ERROR"].includes(e.code)}function pe(e,t){if(de(e)||ue(e))return e;if(e instanceof Error)return{name:e.name,message:e.message,code:"NETWORK_ERROR",stack:e.stack};if("string"==typeof e)return{name:"Error",message:e,code:"NETWORK_ERROR"};if("object"==typeof e&&null!==e){const r=e;if("response"in r&&"object"==typeof r.response&&null!==r.response){const e=r.response;if("data"in e&&"object"==typeof e.data&&null!==e.data){const r=e.data;return{message:r.message||"알 수 없는 오류가 발생했습니다.",code:r.code||"UNKNOWN_ERROR",status:e.status||500,timestamp:r.timestamp||(new Date).toISOString(),path:r.path||(null==t?void 0:t.route)||"",details:r.details||{}}}}return{message:r.message||"알 수 없는 오류가 발생했습니다.",code:r.code||"UNKNOWN_ERROR",status:r.status||500,timestamp:(new Date).toISOString(),path:(null==t?void 0:t.route)||"",details:r}}return{message:"알 수 없는 오류가 발생했습니다.",code:"UNKNOWN_ERROR",status:500,timestamp:(new Date).toISOString(),path:(null==t?void 0:t.route)||""}}function ye(e){if(he(e))switch(e.code){case"UNAUTHORIZED":return"로그인이 필요합니다.";case"FORBIDDEN":return"접근 권한이 없습니다.";case"TOKEN_EXPIRED":return"세션이 만료되었습니다. 다시 로그인해주세요.";case"INVALID_CREDENTIALS":return"이메일 또는 비밀번호가 올바르지 않습니다.";default:return"인증 오류가 발생했습니다."}if(ue(e))switch(e.code){case"NETWORK_ERROR":return"네트워크 연결을 확인해주세요.";case"TIMEOUT_ERROR":return"요청 시간이 초과되었습니다. 잠시 후 다시 시도해주세요.";case"CONNECTION_ERROR":return"서버에 연결할 수 없습니다.";default:return"네트워크 오류가 발생했습니다."}if(me(e))switch(e.code){case"VALIDATION_FAILED":return"입력 정보를 확인해주세요.";case"RESOURCE_NOT_FOUND":return"요청하신 정보를 찾을 수 없습니다.";case"BUSINESS_RULE_VIOLATION":return"비즈니스 규칙 위반입니다.";default:return"처리 중 오류가 발생했습니다."}if(ge(e))switch(e.code){case"INTERNAL_ERROR":return"시스템 오류가 발생했습니다. 관리자에게 문의해주세요.";case"SERVICE_UNAVAILABLE":return"서비스가 일시적으로 사용할 수 없습니다.";case"DATABASE_ERROR":return"데이터 처리 중 오류가 발생했습니다.";default:return"시스템 오류가 발생했습니다."}return e.message||"알 수 없는 오류가 발생했습니다."}const fe={error:(e,t)=>{!function(e){const t=function(e){return ue(e)?"NETWORK":he(e)?"AUTH":me(e)?"BUSINESS":ge(e)?"SYSTEM":de(e)?"VALIDATION":"UNKNOWN"}(e),r=function(e){return he(e)?"UNAUTHORIZED"===e.code?"HIGH":"MEDIUM":ge(e)?"CRITICAL":ue(e)?"MEDIUM":me(e)?"LOW":"MEDIUM"}(e);e.message,"details"in e&&e.details,ye(e)}(pe(e,t))},warn:(e,t)=>{pe(e,t)},info:(e,t)=>{}},Ne=e=>{return{id:e.id,email:e.email,name:e.name,phoneNumber:e.phoneNumber,role:(t=e.role,{ADMIN:"ADMIN",FACILITY:"FACILITY",COORDINATOR:"COORDINATOR",USER_DOMESTIC:"USER_DOMESTIC",USER_OVERSEAS:"USER_OVERSEAS",JOB_SEEKER_DOMESTIC:"JOB_SEEKER_DOMESTIC",JOB_SEEKER_OVERSEAS:"JOB_SEEKER_OVERSEAS"}[t]||"USER_DOMESTIC"),profileCompletionRate:e.profileCompletionRate||0,isActive:e.isActive,isJobSeeker:e.isJobSeeker,language:e.language,region:e.region,createdAt:e.createdAt,updatedAt:e.updatedAt};var t},be=e=>({accessToken:e.accessToken,refreshToken:e.refreshToken,tokenType:e.tokenType,expiresIn:e.expiresIn,member:Ne(e.member)}),xe=e=>e&&"number"==typeof e.id&&"string"==typeof e.email&&"string"==typeof e.name&&"string"==typeof e.role&&"boolean"==typeof e.isActive,ve=e=>e&&"string"==typeof e.accessToken&&"string"==typeof e.tokenType&&"number"==typeof e.expiresIn&&e.member&&xe(e.member),we=oe.create({baseURL:"http://localhost:8080/api/auth",timeout:1e4,headers:{"Content-Type":"application/json"}}),Ee=oe.create({baseURL:"http://localhost:8080/api/auth",timeout:1e4,headers:{"Content-Type":"application/json"}});we.interceptors.request.use(e=>{if(["/login","/register","/signup","/login-test","/login-dto-test","/login-simple-test","/login-map-test","/password-hash-test"].some(t=>{const r=e.url||"";return r===t||r.endsWith(t)}))delete e.headers.Authorization;else{const t=sessionStorage.getItem("accessToken");t&&(e.headers.Authorization=`Bearer ${t}`)}return e}),Ee.interceptors.request.use(e=>{const t=sessionStorage.getItem("accessToken");return t&&(e.headers.Authorization=`Bearer ${t}`),e});const Te=e=>{var t,r,n;const s=e,a={component:"authApi",route:(null==(t=null==s?void 0:s.config)?void 0:t.url)||""};if(401===(null==(r=null==s?void 0:s.response)?void 0:r.status)){const t=(null==(n=s.config)?void 0:n.url)||"";if(t.includes("/login")||t.includes("/register")){const t=pe(e,a);return Promise.reject(t)}{sessionStorage.removeItem("accessToken"),sessionStorage.removeItem("refreshToken"),sessionStorage.removeItem("user"),localStorage.removeItem("accessToken"),localStorage.removeItem("refreshToken"),localStorage.removeItem("user");const t=pe(e,a);return fe.warn(t,a),Promise.reject(t)}}const i=pe(e,a);return fe.error(i,a),Promise.reject(i)};we.interceptors.response.use(e=>e,Te),Ee.interceptors.response.use(e=>e,Te);const Ce={login(e){return u(this,null,function*(){const t=yield we.post("/login",e);if(ve(t.data))return be(t.data);throw new Error("Invalid login response format")})},register(e){return u(this,null,function*(){const t=yield we.post("/register",e);if(ve(t.data))return be(t.data);throw new Error("Invalid register response format")})},logout(){return u(this,null,function*(){yield we.post("/logout")})},refreshToken(e){return u(this,null,function*(){return(yield we.post("/refresh",e)).data})},validateToken(e){return u(this,null,function*(){return(yield we.post("/validate",e)).data})},invalidateAllTokens(){return u(this,null,function*(){yield we.post("/invalidate-all")})},getActiveTokens(){return u(this,null,function*(){return(yield we.get("/active-tokens")).data})},invalidateToken(e){return u(this,null,function*(){yield we.post(`/invalidate/${e}`)})},getTokenMetadata(){return u(this,null,function*(){return(yield we.get("/token-metadata")).data})}},Re={getProfile(){return u(this,null,function*(){const e=yield Ee.get("/me");if(xe(e.data))return Ne(e.data);throw new Error("Invalid member response format")})},updateProfile(e){return u(this,null,function*(){return(yield Ee.put("/me",e)).data})},deleteAccount(){return u(this,null,function*(){yield Ee.delete("/me")})},getMember(e){return u(this,null,function*(){return(yield Ee.get(`/${e}`)).data})},getAllMembers(){return u(this,null,function*(){return(yield Ee.get("")).data})},getMembersByRole(e){return u(this,null,function*(){return(yield Ee.get(`/role/${e}`)).data})},createMember(e){return u(this,null,function*(){return(yield Ee.post("",e)).data})},updateMember(e,t){return u(this,null,function*(){return(yield Ee.put(`/${e}`,t)).data})},deleteMember(e){return u(this,null,function*(){yield Ee.delete(`/${e}`)})}},Ae={ACCESS_TOKEN:"accessToken",REFRESH_TOKEN:"refreshToken",USER:"user"},Oe=e=>{try{return sessionStorage.getItem(Ae[e])}catch(t){return null}},Ie=(e,t)=>{try{sessionStorage.setItem(Ae[e],t)}catch(r){}},Se=e=>{try{sessionStorage.removeItem(Ae[e])}catch(t){}},ke=e=>{try{sessionStorage.setItem(Ae.USER,JSON.stringify(e))}catch(t){}},_e=()=>{try{sessionStorage.removeItem(Ae.USER)}catch(e){}},$e={user:(()=>{try{const e=sessionStorage.getItem(Ae.USER);return e?JSON.parse(e):null}catch(e){return null}})(),accessToken:Oe("ACCESS_TOKEN"),refreshToken:Oe("REFRESH_TOKEN"),isAuthenticated:!!Oe("ACCESS_TOKEN"),isLoading:!1,error:null},Le=h()(ce((e,t)=>o(l({},$e),{login:t=>u(null,null,function*(){var r;try{e({isLoading:!0,error:null}),Se("ACCESS_TOKEN"),Se("REFRESH_TOKEN"),_e();const r=yield Ce.login(t),n={id:r.member.id,email:r.member.email,name:r.member.name,role:r.member.role,profileCompletionRate:r.member.profileCompletionRate||0,isActive:r.member.isActive};Ie("ACCESS_TOKEN",r.accessToken),r.refreshToken&&Ie("REFRESH_TOKEN",r.refreshToken),ke(n),e({user:n,accessToken:r.accessToken,refreshToken:r.refreshToken||null,isAuthenticated:!0,isLoading:!1,error:null})}catch(n){const t={component:"authStore",action:"login"},s=pe(n,t),a=(null==(r=s.message)?void 0:r.includes("401"))?"이메일 또는 비밀번호가 올바르지 않습니다.":s.message||"로그인에 실패했습니다.";throw fe.warn(s,t),e({isLoading:!1,error:a}),s}}),register:t=>u(null,null,function*(){var r;try{e({isLoading:!0,error:null});const r=yield Ce.register(t),n={id:r.member.id,email:r.member.email,name:r.member.name,role:r.member.role,profileCompletionRate:r.member.profileCompletionRate||0,isActive:r.member.isActive};Ie("ACCESS_TOKEN",r.accessToken),Ie("REFRESH_TOKEN",r.refreshToken),ke(n),e({user:n,accessToken:r.accessToken,refreshToken:r.refreshToken,isAuthenticated:!0,isLoading:!1,error:null})}catch(n){const t={component:"authStore",action:"register"},s=pe(n,t),a=(null==(r=s.message)?void 0:r.includes("409"))?"이미 사용중인 이메일입니다.":s.message||"회원가입에 실패했습니다.";throw fe.warn(s,t),e({isLoading:!1,error:a}),s}}),logout:()=>u(null,null,function*(){try{e({isLoading:!0}),yield Ce.logout()}catch(t){fe.warn(t,{component:"authStore",action:"logout"})}finally{Se("ACCESS_TOKEN"),Se("REFRESH_TOKEN"),_e(),e({user:null,accessToken:null,refreshToken:null,isAuthenticated:!1,isLoading:!1,error:null})}}),refreshToken:()=>u(null,null,function*(){try{const{refreshToken:r}=t();if(!r)throw new Error("리프레시 토큰이 없습니다.");const n=yield Ce.refreshToken({refreshToken:r}),s={id:n.member.id,email:n.member.email,name:n.member.name,role:n.member.role,profileCompletionRate:n.member.profileCompletionRate||0,isActive:n.member.isActive};Ie("ACCESS_TOKEN",n.accessToken),Ie("REFRESH_TOKEN",n.refreshToken),ke(s),e({user:s,accessToken:n.accessToken,refreshToken:n.refreshToken,isAuthenticated:!0,error:null})}catch(r){const e={component:"authStore",action:"refreshToken"},n=pe(r,e);throw fe.error(n,e),t().logout(),n}}),refreshUser:()=>u(null,null,function*(){try{e({isLoading:!0});const t=yield Re.getProfile(),r={id:t.id,email:t.email,name:t.name,role:t.role,profileCompletionRate:t.profileCompletionRate,isActive:t.isActive};ke(r),e({user:r,isLoading:!1,error:null})}catch(t){const r={component:"authStore",action:"refreshUser"},n=pe(t,r);throw fe.error(n,r),e({isLoading:!1,error:n.message||"사용자 정보 조회에 실패했습니다."}),n}}),updateProfile:t=>u(null,null,function*(){try{e({isLoading:!0,error:null});const r=yield Re.updateProfile(t),n={id:r.id,email:r.email,name:r.name,role:r.role,profileCompletionRate:r.profileCompletionRate,isActive:r.isActive};ke(n),e({user:n,isLoading:!1,error:null})}catch(r){const t={component:"authStore",action:"updateProfile"},n=pe(r,t);throw fe.error(n,t),e({isLoading:!1,error:n.message||"프로필 업데이트에 실패했습니다."}),n}}),validateToken:()=>u(null,null,function*(){try{const{accessToken:e}=t();return!!e&&(yield Ce.validateToken({token:e})).valid}catch(e){return fe.warn(e,{component:"authStore",action:"validateToken"}),!1}}),clearError:()=>{e({error:null})},setLoading:t=>{e({isLoading:t})},reset:()=>{Se("ACCESS_TOKEN"),Se("REFRESH_TOKEN"),_e(),e({user:null,accessToken:null,refreshToken:null,isAuthenticated:!1,isLoading:!1,error:null})}}),{name:"elderberry-auth",partialize:e=>({isAuthenticated:e.isAuthenticated})})),De=new class{constructor(e={}){d(this,"config"),d(this,"tokenProvider",null),d(this,"isRefreshing",!1),d(this,"failedQueue",[]),this.config=l({baseURL:"/api",timeout:1e4,withCredentials:!0},e)}setTokenProvider(e){this.tokenProvider=e}injectAuthHeaders(e={}){var t;const r=new Headers(e),n=null==(t=this.tokenProvider)?void 0:t.getAccessToken();return n&&r.set("Authorization",`Bearer ${n}`),r.has("Content-Type")||r.set("Content-Type","application/json"),r}handleResponse(e,t){return u(this,null,function*(){if(e.ok)return{data:yield e.json(),status:e.status,statusText:e.statusText,headers:e.headers};if(401===e.status&&this.tokenProvider)return this.handleTokenRefresh(e,t);const r=yield e.json().catch(()=>({}));throw{message:r.message||e.statusText,status:e.status,code:r.code,details:r}})}handleTokenRefresh(e,t){return u(this,null,function*(){if(this.isRefreshing)return new Promise((e,t)=>{this.failedQueue.push({resolve:e,reject:t})});try{return this.isRefreshing=!0,yield this.tokenProvider.refreshToken(),this.failedQueue.forEach(({resolve:e})=>{e(this.request(t.method,t.url,t))}),this.failedQueue=[],yield this.request(t.method,t.url,t)}catch(e){throw this.tokenProvider.logout(),this.failedQueue.forEach(({reject:t})=>{t(e)}),this.failedQueue=[],e}finally{this.isRefreshing=!1}})}request(e,t){return u(this,arguments,function*(e,t,r={}){const n=r,{baseURL:s=this.config.baseURL,timeout:a=this.config.timeout}=n,i=c(n,["baseURL","timeout"]),o=t.startsWith("http")?t:`${s}${t}`,d=new AbortController,u=setTimeout(()=>d.abort(),a);try{const n=yield fetch(o,l({method:e,headers:this.injectAuthHeaders(i.headers),signal:d.signal,credentials:this.config.withCredentials?"include":"same-origin"},i));return yield this.handleResponse(n,l({method:e,url:t},r))}catch(h){if(h instanceof Error&&"AbortError"===h.name)throw new Error(`요청 시간 초과 (${a}ms)`);throw h}finally{clearTimeout(u)}})}get(e,t){return u(this,null,function*(){return this.request("GET",e,t)})}post(e,t,r){return u(this,null,function*(){return this.request("POST",e,o(l({},r),{body:t?JSON.stringify(t):void 0}))})}put(e,t,r){return u(this,null,function*(){return this.request("PUT",e,o(l({},r),{body:t?JSON.stringify(t):void 0}))})}delete(e,t){return u(this,null,function*(){return this.request("DELETE",e,t)})}patch(e,t,r){return u(this,null,function*(){return this.request("PATCH",e,o(l({},r),{body:t?JSON.stringify(t):void 0}))})}upload(e,t,r){return u(this,null,function*(){const n=l({},r);if(n.headers){const e=new Headers(n.headers);e.delete("Content-Type"),n.headers=e}return this.request("POST",e,o(l({},n),{body:t}))})}getWithParams(e){return u(this,arguments,function*(e,t={},r){const n=new URLSearchParams;Object.entries(t).forEach(([e,t])=>{null!=t&&(Array.isArray(t)?t.forEach(t=>n.append(e,String(t))):n.append(e,String(t)))});const s=n.toString(),a=s?`${e}?${s}`:e;return this.get(a,r)})}}({baseURL:"/api",timeout:15e3,withCredentials:!0});function Ue(...e){return ae(ie(e))}De.get.bind(De),De.post.bind(De),De.put.bind(De),De.delete.bind(De),De.patch.bind(De),De.upload.bind(De),De.getWithParams.bind(De);const je=le("inline-flex items-center px-2 py-1 text-xs font-medium rounded-md",{variants:{variant:{default:"bg-gray-100 text-gray-800",primary:"bg-blue-100 text-blue-800",secondary:"bg-purple-100 text-purple-800",success:"bg-green-100 text-green-800",error:"bg-red-100 text-red-800",warning:"bg-yellow-100 text-yellow-800",outline:"border border-gray-300 text-gray-700"}},defaultVariants:{variant:"default"}}),Me=m.forwardRef((e,t)=>{var r=e,{className:n,variant:s,children:a}=r,i=c(r,["className","variant","children"]);return g.jsx("span",o(l({ref:t,className:Ue(je({variant:s}),n)},i),{children:a}))});Me.displayName="Badge";const Be=le("animate-spin rounded-full border-solid",{variants:{size:{sm:"h-4 w-4 border-2",md:"h-6 w-6 border-2",lg:"h-8 w-8 border-2",xl:"h-12 w-12 border-3","2xl":"h-16 w-16 border-4"},variant:{default:"border-gray-300 border-t-gray-600",primary:"border-blue-200 border-t-blue-600",secondary:"border-gray-200 border-t-gray-500",white:"border-white/20 border-t-white"}},defaultVariants:{size:"md",variant:"default"}}),Pe=({size:e,variant:t,className:r="",label:n="로딩 중..."})=>g.jsx("div",{className:Be({size:e,variant:t,className:r}),role:"status","aria-label":n,children:g.jsx("span",{className:"sr-only",children:n})}),Ke=({message:e,onRetry:t,retryLabel:r="다시 시도",className:n="",showIcon:s=!0})=>g.jsxs("div",{className:`flex flex-col items-center justify-center p-6 ${n}`,children:[s&&g.jsx("div",{className:"w-12 h-12 bg-red-100 rounded-full flex items-center justify-center mb-4",children:g.jsx(p,{className:"w-6 h-6 text-red-600"})}),g.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"오류가 발생했습니다"}),g.jsx("p",{className:"text-gray-600 text-center mb-6 max-w-md",children:e}),t&&g.jsxs(Z,{onClick:t,variant:"outline",className:"flex items-center gap-2",children:[g.jsx(y,{className:"w-4 h-4"}),r]})]}),Fe={info:{icon:x,iconColor:"text-blue-600",iconBg:"bg-blue-100",confirmButtonVariant:"primary"},warning:{icon:b,iconColor:"text-yellow-600",iconBg:"bg-yellow-100",confirmButtonVariant:"primary"},danger:{icon:N,iconColor:"text-red-600",iconBg:"bg-red-100",confirmButtonVariant:"primary"},success:{icon:f,iconColor:"text-green-600",iconBg:"bg-green-100",confirmButtonVariant:"primary"}},ze=({open:e,onClose:t,onConfirm:r,title:n,message:s,confirmLabel:a="확인",cancelLabel:i="취소",variant:l="info",isLoading:o=!1})=>{const c=Fe[l],d=c.icon;return g.jsx(X,{open:e,onClose:t,size:"sm",children:g.jsxs(ee,{children:[g.jsx(te,{children:g.jsxs("div",{className:"flex items-center gap-4",children:[g.jsx("div",{className:`w-10 h-10 rounded-full flex items-center justify-center ${c.iconBg}`,children:g.jsx(d,{className:`w-5 h-5 ${c.iconColor}`})}),g.jsx(re,{children:n})]})}),g.jsx("div",{className:"px-6 py-4",children:g.jsx("p",{className:"text-gray-600 leading-relaxed",children:s})}),g.jsxs(ne,{children:[g.jsx(Z,{variant:"ghost",onClick:t,disabled:o,children:i}),g.jsx(Z,{variant:c.confirmButtonVariant,onClick:r,disabled:o,className:"danger"===l?"bg-red-600 hover:bg-red-700":"",children:o?"처리 중...":a})]})]})})},Ve={baseURL:"http://localhost:8080",timeout:3e4,headers:{"Content-Type":"application/json"}};class He{constructor(){d(this,"ACCESS_TOKEN_KEY","accessToken"),d(this,"REFRESH_TOKEN_KEY","refreshToken")}getAccessToken(){return localStorage.getItem(this.ACCESS_TOKEN_KEY)}getRefreshToken(){return localStorage.getItem(this.REFRESH_TOKEN_KEY)}setTokens(e,t){localStorage.setItem(this.ACCESS_TOKEN_KEY,e),localStorage.setItem(this.REFRESH_TOKEN_KEY,t)}clearTokens(){localStorage.removeItem(this.ACCESS_TOKEN_KEY),localStorage.removeItem(this.REFRESH_TOKEN_KEY)}isTokenExpired(e){try{return 1e3*JSON.parse(atob(e.split(".")[1])).exp<Date.now()}catch(t){return!0}}}const We=new class{constructor(){d(this,"client"),d(this,"tokenManager"),d(this,"isRefreshing",!1),d(this,"refreshPromise",null),this.client=oe.create(Ve),this.tokenManager=new He,this.setupInterceptors()}setupInterceptors(){this.client.interceptors.request.use(e=>{const t=this.tokenManager.getAccessToken();return t&&!this.tokenManager.isTokenExpired(t)&&(e.headers.Authorization=`Bearer ${t}`),e},e=>Promise.reject(e)),this.client.interceptors.response.use(e=>e,e=>u(this,null,function*(){var t;const r=e.config;if(401===(null==(t=e.response)?void 0:t.status)&&!r.t){r.t=!0;try{const e=yield this.refreshAccessToken();return r.headers.Authorization=`Bearer ${e}`,this.client(r)}catch(n){return this.tokenManager.clearTokens(),window.location.href="/login",Promise.reject(n)}}return Promise.reject(this.handleError(e))}))}refreshAccessToken(){return u(this,null,function*(){if(this.isRefreshing&&this.refreshPromise)return this.refreshPromise;this.isRefreshing=!0,this.refreshPromise=this.performTokenRefresh();try{return yield this.refreshPromise}finally{this.isRefreshing=!1,this.refreshPromise=null}})}performTokenRefresh(){return u(this,null,function*(){const e=this.tokenManager.getRefreshToken();if(!e)throw new Error("No refresh token available");const t=yield oe.post(`${Ve.baseURL}/auth/refresh`,{refreshToken:e},{headers:Ve.headers}),{accessToken:r,refreshToken:n}=t.data;return this.tokenManager.setTokens(r,n),r})}handleError(e){var t,r;return(null==(t=e.response)?void 0:t.data)?e.response.data:{error:"NETWORK_ERROR",message:e.message||"Network error occurred",statusCode:(null==(r=e.response)?void 0:r.status)||0,timestamp:(new Date).toISOString()}}get(e,t){return u(this,null,function*(){return(yield this.client.get(e,t)).data})}post(e,t,r){return u(this,null,function*(){return(yield this.client.post(e,t,r)).data})}put(e,t,r){return u(this,null,function*(){return(yield this.client.put(e,t,r)).data})}patch(e,t,r){return u(this,null,function*(){return(yield this.client.patch(e,t,r)).data})}delete(e,t){return u(this,null,function*(){return(yield this.client.delete(e,t)).data})}uploadFile(e,t,r){return u(this,null,function*(){const n=new FormData;n.append("file",t);const s={headers:{"Content-Type":"multipart/form-data"},onUploadProgress:e=>{if(r&&e.total){const t=Math.round(100*e.loaded/e.total);r(t)}}};return(yield this.client.post(e,n,s)).data})}setTokens(e,t){this.tokenManager.setTokens(e,t)}clearTokens(){this.tokenManager.clearTokens()}getAccessToken(){return this.tokenManager.getAccessToken()}isAuthenticated(){const e=this.tokenManager.getAccessToken();return!!e&&!this.tokenManager.isTokenExpired(e)}};apiClient,configureApiClient,api;const qe=new class{constructor(){d(this,"baseUrl","/api/boards")}getAllBoards(){return u(this,null,function*(){try{return(yield De.get(this.baseUrl)).data}catch(e){throw e}})}getBoardById(e){return u(this,null,function*(){try{return(yield De.get(`${this.baseUrl}/${e}`)).data}catch(t){throw t}})}getPostsByBoard(e,t=0,r=20,n="createdDate",s="DESC"){return u(this,null,function*(){try{return(yield De.get(`${this.baseUrl}/${e}/posts`,{params:{page:t,size:r,sort:n,direction:s}})).data}catch(a){throw a}})}searchPosts(e,t){return u(this,null,function*(){try{return(yield De.get(`${this.baseUrl}/${e}/posts/search`,{params:{keyword:t.keyword,searchType:t.searchType,page:t.page||0,size:t.size||20}})).data}catch(r){throw r}})}createPost(e,t){return u(this,null,function*(){try{return(yield De.post(`${this.baseUrl}/${e}/posts`,t)).data}catch(r){throw r}})}getPostDetail(e,t){return u(this,null,function*(){try{return(yield De.get(`${this.baseUrl}/${e}/posts/${t}`)).data}catch(r){throw r}})}updatePost(e,t,r){return u(this,null,function*(){try{return(yield De.put(`${this.baseUrl}/${e}/posts/${t}`,r)).data}catch(n){throw n}})}deletePost(e,t){return u(this,null,function*(){try{yield De.delete(`${this.baseUrl}/${e}/posts/${t}`)}catch(r){throw r}})}getComments(e,t,r=0,n=50){return u(this,null,function*(){try{return(yield De.get(`${this.baseUrl}/${e}/posts/${t}/comments`,{params:{page:r,size:n}})).data}catch(s){throw s}})}createComment(e,t,r){return u(this,null,function*(){try{return(yield De.post(`${this.baseUrl}/${e}/posts/${t}/comments`,r)).data}catch(n){throw n}})}updateComment(e,t,r,n){return u(this,null,function*(){try{return(yield De.put(`${this.baseUrl}/${e}/posts/${t}/comments/${r}`,n)).data}catch(s){throw s}})}deleteComment(e,t,r){return u(this,null,function*(){try{yield De.delete(`${this.baseUrl}/${e}/posts/${t}/comments/${r}`)}catch(n){throw n}})}createBoard(e){return u(this,null,function*(){try{return(yield De.post(this.baseUrl,e)).data}catch(t){throw t}})}updateBoard(e,t){return u(this,null,function*(){try{return(yield De.put(`${this.baseUrl}/${e}`,t)).data}catch(r){throw r}})}deactivateBoard(e){return u(this,null,function*(){try{yield De.delete(`${this.baseUrl}/${e}`)}catch(t){throw t}})}},Je={GENERAL:{label:"일반 게시판",description:"자유로운 의견 교환 공간입니다",icon:"💬",color:"blue",allowAnonymous:!1,requireAuth:!0},NOTICE:{label:"공지사항",description:"중요한 공지사항을 확인하세요",icon:"📢",color:"red",allowAnonymous:!0,requireAuth:!1},FAQ:{label:"자주묻는질문",description:"자주 묻는 질문과 답변입니다",icon:"❓",color:"yellow",allowAnonymous:!0,requireAuth:!1},QNA:{label:"Q&A",description:"궁금한 점을 질문하고 답변받으세요",icon:"🙋‍♀️",color:"green",allowAnonymous:!1,requireAuth:!0},JOB:{label:"구인구직",description:"요양원 채용정보와 구직정보를 공유하세요",icon:"💼",color:"purple",allowAnonymous:!1,requireAuth:!0},COMMUNITY:{label:"커뮤니티",description:"같은 관심사를 가진 사람들과 소통하세요",icon:"👥",color:"indigo",allowAnonymous:!1,requireAuth:!0},ANNOUNCEMENT:{label:"공고",description:"시설 및 기관의 공식 공고입니다",icon:"📋",color:"orange",allowAnonymous:!0,requireAuth:!1},REVIEW:{label:"후기",description:"시설 이용 후기와 경험담을 나누세요",icon:"⭐",color:"pink",allowAnonymous:!1,requireAuth:!0}},Ye=100,Qe=1e4,Ge=1e3,Ze={GENERAL:"blue",NOTICE:"red",FAQ:"yellow",QNA:"green",JOB:"purple",COMMUNITY:"indigo",ANNOUNCEMENT:"orange",REVIEW:"pink"},Xe=()=>{const{boardId:e}=v(),t=w(),{user:r,isAuthenticated:n}=Le(),[s,a]=E.useState([]),[i,l]=E.useState(!0),[o,c]=E.useState(null);E.useEffect(()=>{u(null,null,function*(){try{l(!0),c(null);const e=yield qe.getBoards();a(e)}catch(e){c("게시판 목록을 불러오는데 실패했습니다.")}finally{l(!1)}})},[]);const d=e=>{const n=Je[e.type],s=Ze[e.type],a=!e.adminOnly||r&&("ADMIN"===r.role||"FACILITY"===r.role);return a?g.jsx("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 hover:shadow-md transition-all cursor-pointer group "+(a?"":"opacity-50 cursor-not-allowed"),onClick:()=>t(`/boards/${e.id}`),children:g.jsxs("div",{className:"p-6",children:[g.jsxs("div",{className:"flex items-start justify-between mb-4",children:[g.jsxs("div",{className:"flex items-center gap-3",children:[g.jsx("div",{className:`w-12 h-12 ${s.bg} ${s.text} rounded-lg flex items-center justify-center`,children:n.icon}),g.jsxs("div",{children:[g.jsx("h3",{className:"text-lg font-semibold text-gray-900 group-hover:text-elderberry-600 transition-colors",children:e.name}),g.jsx("p",{className:"text-sm text-gray-500",children:e.description||n.description})]})]}),g.jsxs("div",{className:"flex items-center gap-2",children:[e.adminOnly&&g.jsx(R,{className:"w-4 h-4 text-orange-500"}),g.jsx(A,{className:"w-5 h-5 text-gray-400 group-hover:text-elderberry-600 transition-colors"})]})]}),g.jsxs("div",{className:"flex items-center gap-4 text-sm text-gray-500",children:[g.jsxs("div",{className:"flex items-center gap-1",children:[g.jsx(C,{className:"w-4 h-4"}),g.jsxs("span",{children:[e.postCount||0,"개 게시글"]})]}),g.jsxs("div",{className:"flex items-center gap-1",children:[g.jsx(O,{className:"w-4 h-4"}),g.jsxs("span",{children:[e.totalViews||0,"회 조회"]})]}),e.lastPostDate&&g.jsxs("div",{className:"flex items-center gap-1",children:[g.jsx(I,{className:"w-4 h-4"}),g.jsxs("span",{children:["최근 ",new Date(e.lastPostDate).toLocaleDateString()]})]})]}),e.recentPosts&&e.recentPosts.length>0&&g.jsx("div",{className:"mt-4 pt-4 border-t border-gray-100",children:g.jsx("div",{className:"space-y-2",children:e.recentPosts.slice(0,2).map(e=>g.jsxs("div",{className:"flex items-center justify-between text-sm",children:[g.jsx("span",{className:"text-gray-600 truncate flex-1",children:e.title}),g.jsx("span",{className:"text-gray-400 text-xs ml-2",children:new Date(e.createdDate).toLocaleDateString()})]},e.id))})})]})},e.id):null},h=(e,t,r,n)=>r&&0!==r.length?g.jsxs("div",{className:"mb-8",children:[g.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[t,g.jsxs("div",{children:[g.jsx("h2",{className:"text-xl font-bold text-gray-900",children:e}),n&&g.jsx("p",{className:"text-sm text-gray-500",children:n})]})]}),g.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:r.map(d)})]}):null;if(i)return g.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:g.jsx(Pe,{size:"lg"})});if(o)return g.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:g.jsx(Ke,{message:o,onRetry:()=>window.location.reload()})});const m={community:s.filter(e=>["GENERAL","ANNOUNCEMENT","NOTICE"].includes(e.type)),support:s.filter(e=>["FAQ","QNA"].includes(e.type)),social:s.filter(e=>["COMMUNITY","REVIEW"].includes(e.type)),business:s.filter(e=>["JOB"].includes(e.type))};return g.jsx("div",{className:"min-h-screen bg-gray-50",children:g.jsxs("div",{className:"max-w-7xl mx-auto px-4 py-8",children:[g.jsxs("div",{className:"mb-8",children:[g.jsx("h1",{className:"text-3xl font-bold text-gray-900 mb-2",children:"커뮤니티"}),g.jsx("p",{className:"text-gray-600",children:"다양한 주제의 게시판에서 소통하고 정보를 공유하세요."})]}),r&&("ADMIN"===r.role||"FACILITY"===r.role)&&g.jsx("div",{className:"mb-8",children:g.jsxs(Z,{onClick:()=>t("/admin/boards/create"),className:"flex items-center gap-2",children:[g.jsx(T,{className:"w-4 h-4"}),"새 게시판 만들기"]})}),g.jsxs("div",{className:"space-y-8",children:[h("일반 커뮤니티",g.jsx(C,{className:"w-4 h-4 text-blue-600"}),m.community,"공지사항과 일반적인 이야기를 나누세요"),h("지원 & 문의",g.jsx(S,{className:"w-4 h-4 text-green-600"}),m.support,"궁금한 점을 해결하고 도움을 받으세요"),h("소셜 & 리뷰",g.jsx(k,{className:"w-4 h-4 text-red-600"}),m.social,"경험을 공유하고 리뷰를 작성하세요"),h("구인구직",g.jsx(_,{className:"w-4 h-4 text-purple-600"}),m.business,"채용 정보와 구직 정보를 확인하세요"),0===s.length&&g.jsxs("div",{className:"text-center py-16",children:[g.jsx("div",{className:"w-16 h-16 bg-gray-100 rounded-full flex items-center justify-center mx-auto mb-4",children:g.jsx(C,{className:"w-8 h-8 text-gray-400"})}),g.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"아직 게시판이 없습니다"}),g.jsx("p",{className:"text-gray-500 mb-6",children:"관리자가 게시판을 생성하면 여기에 표시됩니다."})]})]})]})})},et=Object.freeze(Object.defineProperty({__proto__:null,BoardListPage:Xe,default:Xe},Symbol.toStringTag,{value:"Module"})),tt=({boardId:e,postId:t,parentId:r,initialContent:n="",onCommentAdded:s,onCancel:a,placeholder:i="댓글을 입력하세요..."})=>{const[o,c]=E.useState(n),[d,h]=E.useState(!1),[m,p]=E.useState(null);return g.jsx("form",{onSubmit:n=>u(null,null,function*(){if(n.preventDefault(),o.trim())if(o.length>Ge)p("댓글은 1000자 이하로 작성해주세요.");else try{h(!0),p(null);const n=l({content:o.trim()},r&&{parentId:r});yield qe.createComment(e,t,n),c(""),s()}catch(a){p("댓글 작성에 실패했습니다.")}finally{h(!1)}else p("댓글 내용을 입력해주세요.")}),className:"space-y-3",children:g.jsxs("div",{children:[g.jsx("textarea",{value:o,onChange:e=>c(e.target.value),placeholder:i,rows:3,className:"w-full px-3 py-2 border rounded-lg resize-y focus:ring-2 focus:ring-blue-500 focus:border-blue-500 "+(m?"border-red-500":"border-gray-300"),maxLength:Ge}),m&&g.jsx("p",{className:"mt-1 text-sm text-red-600",children:m}),g.jsxs("div",{className:"flex justify-between items-center mt-2",children:[g.jsxs("p",{className:"text-sm text-gray-500",children:[o.length," / ",Ge]}),g.jsxs("div",{className:"flex gap-2",children:[a&&g.jsx(Z,{type:"button",variant:"ghost",size:"sm",onClick:a,children:"취소"}),g.jsx(Z,{type:"submit",variant:"primary",size:"sm",disabled:d||!o.trim(),children:d?"작성 중...":g.jsxs(g.Fragment,{children:[g.jsx($,{className:"w-4 h-4 mr-1"}),r?"답글 작성":"댓글 작성"]})})]})]})]})})},rt=({comment:e,boardId:t,postId:r,onCommentUpdated:n,level:s=0})=>{const{user:a}=Le(),[i,l]=E.useState(!1),[o,c]=E.useState(!1),[d,h]=E.useState(!1),[m,p]=E.useState(!1),y=a&&a.id===e.author.id,f=y,N=y||a&&("ADMIN"===a.role||"FACILITY"===a.role);return g.jsxs(g.Fragment,{children:[g.jsxs("div",{className:s>0?"ml-8 pl-4 border-l-2 border-gray-200":"",children:[g.jsxs("div",{className:"py-4",children:[g.jsxs("div",{className:"flex items-start justify-between mb-2",children:[g.jsxs("div",{className:"flex items-center gap-2",children:[g.jsx(L,{className:"w-4 h-4 text-gray-400"}),g.jsx("span",{className:"text-sm font-medium text-gray-900",children:e.author.name}),g.jsxs("div",{className:"flex items-center gap-1 text-xs text-gray-500",children:[g.jsx(I,{className:"w-3 h-3"}),g.jsx("span",{children:new Date(e.createdDate).toLocaleString()})]}),e.lastModifiedDate&&e.lastModifiedDate!==e.createdDate&&g.jsx("span",{className:"text-xs text-gray-400",children:"(수정됨)"})]}),(f||N)&&g.jsxs("div",{className:"flex items-center gap-1",children:[f&&g.jsx(Z,{variant:"ghost",size:"sm",onClick:()=>l(!0),className:"p-1",children:g.jsx(D,{className:"w-3 h-3"})}),N&&g.jsx(Z,{variant:"ghost",size:"sm",onClick:()=>h(!0),className:"p-1 text-red-600 hover:text-red-700",children:g.jsx(U,{className:"w-3 h-3"})})]})]}),i?g.jsx("div",{className:"mb-3",children:g.jsx(tt,{boardId:t,postId:r,initialContent:e.content,onCommentAdded:()=>{l(!1),n()},onCancel:()=>l(!1),placeholder:"댓글을 수정하세요..."})}):g.jsxs(g.Fragment,{children:[g.jsx("div",{className:"text-sm text-gray-900 mb-2 whitespace-pre-wrap",children:"DELETED"===e.status?g.jsx("span",{className:"text-gray-500 italic",children:"삭제된 댓글입니다."}):e.content}),"ACTIVE"===e.status&&s<2&&g.jsx("div",{className:"flex items-center gap-2",children:g.jsxs(Z,{variant:"ghost",size:"sm",onClick:()=>c(!o),className:"text-xs p-1",children:[g.jsx(j,{className:"w-3 h-3 mr-1"}),"답글"]})}),o&&g.jsx("div",{className:"mt-3 ml-4",children:g.jsx(tt,{boardId:t,postId:r,parentId:e.id,onCommentAdded:()=>{c(!1),n()},onCancel:()=>c(!1),placeholder:"답글을 입력하세요..."})})]})]}),e.replies&&e.replies.length>0&&g.jsx("div",{className:"space-y-0",children:e.replies.map(e=>g.jsx(rt,{comment:e,boardId:t,postId:r,onCommentUpdated:n,level:s+1},e.id))})]}),g.jsx(ze,{open:d,onClose:()=>h(!1),onConfirm:()=>u(null,null,function*(){try{p(!0),yield qe.deleteComment(t,r,e.id),n()}catch(s){alert("댓글 삭제에 실패했습니다.")}finally{p(!1),h(!1)}}),title:"댓글 삭제",message:"정말로 이 댓글을 삭제하시겠습니까?",confirmLabel:"삭제",isLoading:m,variant:"danger"})]})},nt=({boardId:e,postId:t,comments:r,onCommentUpdated:n})=>r&&0!==r.content.length?g.jsx("div",{className:"divide-y divide-gray-200",children:r.content.map(r=>g.jsx(rt,{comment:r,boardId:e,postId:t,onCommentUpdated:n},r.id))}):g.jsxs("div",{className:"p-6 text-center text-gray-500",children:[g.jsx(C,{className:"w-8 h-8 mx-auto mb-2 text-gray-400"}),g.jsx("p",{children:"아직 댓글이 없습니다."}),g.jsx("p",{className:"text-sm",children:"첫 번째 댓글을 작성해보세요!"})]}),st=()=>{const{boardId:e,postId:t}=v(),r=w(),{user:n,isAuthenticated:s}=Le(),[a,i]=E.useState(null),[l,o]=E.useState(null),[c,d]=E.useState(null),[h,p]=E.useState(!0),[y,f]=E.useState(null),[N,b]=E.useState(!1),[x,T]=E.useState(!1),R=e?parseInt(e,10):null,A=t?parseInt(t,10):null;if(!R||isNaN(R)||!A||isNaN(A))return r("/boards"),null;const S=E.useCallback(()=>u(null,null,function*(){try{p(!0),f(null);const[e,t]=yield Promise.all([qe.getBoardById(R),qe.getPostDetail(R,A)]);i(e),o(t);const r=yield qe.getComments(R,A);d(r)}catch(e){f("게시글을 불러오는데 실패했습니다.")}finally{p(!1)}}),[R,A]);E.useEffect(()=>{S()},[S]);const _=E.useCallback(()=>{qe.getComments(R,A).then(d).catch(console.error)},[R,A]),$=n&&l&&n.id===l.author.id,j=$,F=$||n&&("ADMIN"===n.role||"FACILITY"===n.role);return h?g.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:g.jsx(Pe,{size:"lg"})}):!y&&a&&l?(a.type,m.useEffect(()=>(l&&a&&(document.title=`${l.title} - ${a.name} - 엘더베리 커뮤니티`),()=>{document.title="엘더베리"}),[l,a]),g.jsxs(g.Fragment,{children:[g.jsx("div",{className:"min-h-screen bg-gray-50",children:g.jsxs("div",{className:"max-w-4xl mx-auto px-4 py-6",children:[g.jsxs("div",{className:"flex items-center gap-2 mb-6",children:[g.jsx(Z,{variant:"ghost",size:"sm",onClick:()=>r(`/boards/${a.id}`),className:"p-2",children:g.jsx(M,{className:"w-5 h-5"})}),g.jsxs("div",{className:"flex items-center gap-2 text-sm text-gray-500",children:[g.jsx("span",{children:"커뮤니티"}),g.jsx("span",{children:">"}),g.jsx("span",{children:a.name}),g.jsx("span",{children:">"}),g.jsx("span",{className:"text-gray-900 truncate max-w-xs",children:l.title})]})]}),g.jsxs("article",{className:"bg-white rounded-xl shadow-sm border border-gray-200 mb-6",children:[g.jsxs("header",{className:"p-6 border-b border-gray-200",children:[g.jsxs("div",{className:"flex items-start justify-between mb-4",children:[g.jsxs("div",{className:"flex-1",children:[g.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[l.pinned&&g.jsx(B,{className:"w-5 h-5 text-orange-500"}),g.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:l.title}),"ACTIVE"!==l.status&&g.jsx(Me,{variant:"secondary",children:"INACTIVE"===l.status?"비활성":"삭제됨"})]}),l.tags&&l.tags.length>0&&g.jsx("div",{className:"flex flex-wrap gap-2 mb-4",children:l.tags.map(e=>g.jsxs(Me,{variant:"outline",className:"text-sm",children:["#",e]},e))})]}),(j||F)&&g.jsxs("div",{className:"flex items-center gap-2",children:[j&&g.jsx(Z,{variant:"ghost",size:"sm",onClick:()=>r(`/boards/${a.id}/posts/${l.id}/edit`),children:g.jsx(D,{className:"w-4 h-4"})}),F&&g.jsx(Z,{variant:"ghost",size:"sm",onClick:()=>b(!0),className:"text-red-600 hover:text-red-700",children:g.jsx(U,{className:"w-4 h-4"})})]})]}),g.jsxs("div",{className:"flex items-center justify-between",children:[g.jsxs("div",{className:"flex items-center gap-4",children:[g.jsxs("div",{className:"flex items-center gap-2",children:[g.jsx(L,{className:"w-4 h-4 text-gray-400"}),g.jsx("span",{className:"text-sm text-gray-600",children:l.author.name})]}),g.jsxs("div",{className:"flex items-center gap-2",children:[g.jsx(I,{className:"w-4 h-4 text-gray-400"}),g.jsx("span",{className:"text-sm text-gray-600",children:new Date(l.createdDate).toLocaleString()})]}),l.lastModifiedDate&&l.lastModifiedDate!==l.createdDate&&g.jsxs("span",{className:"text-sm text-gray-500",children:["(수정됨: ",new Date(l.lastModifiedDate).toLocaleString(),")"]})]}),g.jsxs("div",{className:"flex items-center gap-4",children:[g.jsxs("div",{className:"flex items-center gap-1 text-sm text-gray-500",children:[g.jsx(O,{className:"w-4 h-4"}),g.jsx("span",{children:l.viewCount})]}),g.jsxs("div",{className:"flex items-center gap-1 text-sm text-gray-500",children:[g.jsx(C,{className:"w-4 h-4"}),g.jsx("span",{children:l.commentCount})]}),void 0!==l.likeCount&&g.jsxs("div",{className:"flex items-center gap-1 text-sm text-gray-500",children:[g.jsx(k,{className:"w-4 h-4"}),g.jsx("span",{children:l.likeCount})]})]})]})]}),g.jsx("div",{className:"p-6",children:g.jsx("div",{className:"prose max-w-none",dangerouslySetInnerHTML:{i:l.content.replace(/\*\*(.*?)\*\*/g,"<strong>$1</strong>").replace(/\*(.*?)\*/g,"<em>$1</em>").replace(/`(.*?)`/g,"<code>$1</code>").replace(/^> (.+)$/gm,"<blockquote>$1</blockquote>").replace(/^- (.+)$/gm,"<li>$1</li>").replace(/\n/g,"<br>")}})}),g.jsx("footer",{className:"px-6 py-4 border-t border-gray-200 bg-gray-50",children:g.jsxs("div",{className:"flex items-center justify-between",children:[g.jsxs("div",{className:"flex items-center gap-2",children:[g.jsxs(Z,{variant:"ghost",size:"sm",disabled:!0,children:[g.jsx(k,{className:"w-4 h-4 mr-1"}),"좋아요"]}),g.jsxs(Z,{variant:"ghost",size:"sm",disabled:!0,children:[g.jsx(P,{className:"w-4 h-4 mr-1"}),"공유"]})]}),g.jsxs(Z,{variant:"ghost",size:"sm",disabled:!0,children:[g.jsx(K,{className:"w-4 h-4 mr-1"}),"신고"]})]})})]}),g.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200",children:[g.jsxs("div",{className:"p-6 border-b border-gray-200",children:[g.jsxs("h2",{className:"text-lg font-semibold text-gray-900 mb-4",children:["댓글 ",(null==c?void 0:c.totalElements)||0,"개"]}),s?g.jsx(tt,{boardId:R,postId:A,onCommentAdded:_}):g.jsxs("div",{className:"text-center py-8 bg-gray-50 rounded-lg",children:[g.jsx("p",{className:"text-gray-500 mb-4",children:"댓글을 작성하려면 로그인이 필요합니다."}),g.jsx(Z,{variant:"primary",onClick:()=>r("/auth/signin"),children:"로그인하기"})]})]}),g.jsx(nt,{boardId:R,postId:A,comments:c,onCommentUpdated:_})]})]})}),g.jsx(ze,{open:N,onClose:()=>b(!1),onConfirm:()=>u(null,null,function*(){try{T(!0),yield qe.deletePost(R,A),r(`/boards/${R}`)}catch(e){alert("게시글 삭제에 실패했습니다.")}finally{T(!1),b(!1)}}),title:"게시글 삭제",message:"정말로 이 게시글을 삭제하시겠습니까? 삭제된 게시글은 복구할 수 없습니다.",confirmLabel:"삭제",isLoading:x,variant:"danger"})]})):g.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:g.jsx(Ke,{message:y||"게시글을 찾을 수 없습니다.",onRetry:()=>window.location.reload()})})},at=Object.freeze(Object.defineProperty({__proto__:null,PostDetailPage:st,default:st},Symbol.toStringTag,{value:"Module"})),it=({initialData:e,onSubmit:t,onCancel:r,isLoading:n=!1,submitLabel:s="게시글 작성"})=>{const[a,i]=E.useState((null==e?void 0:e.title)||""),[l,o]=E.useState((null==e?void 0:e.content)||""),[c,d]=E.useState((null==e?void 0:e.tags)||[]),[h,m]=E.useState(""),[p,y]=E.useState(!1),[f,N]=E.useState({}),b=E.useRef(null),x=(e,t="")=>{const r=b.current;if(!r)return;const n=r.selectionStart,s=r.selectionEnd,a=l.substring(n,s),i=l.substring(0,n)+e+a+t+l.substring(s);o(i),setTimeout(()=>{r.focus(),r.setSelectionRange(n+e.length,n+e.length+a.length)},0)},v=()=>{const e=h.trim();e&&!c.includes(e)&&c.length<10&&(d([...c,e]),m(""))};return g.jsx("div",{className:"max-w-4xl mx-auto",children:g.jsxs("form",{onSubmit:e=>u(null,null,function*(){if(e.preventDefault(),(()=>{const e={};return a.trim()?a.length>Ye&&(e.title="제목은 100자 이하로 작성해주세요."):e.title="제목을 입력해주세요.",l.trim()?l.length>Qe&&(e.content="내용은 10000자 이하로 작성해주세요."):e.content="내용을 입력해주세요.",N(e),0===Object.keys(e).length})())try{yield t({title:a.trim(),content:l.trim(),tags:c.filter(e=>e.trim())})}catch(r){}}),className:"space-y-6",children:[g.jsxs("div",{children:[g.jsx(se,{type:"text",placeholder:"제목을 입력하세요",value:a,onChange:e=>i(e.target.value),className:"text-lg font-medium "+(f.title?"border-red-500":""),maxLength:Ye}),f.title&&g.jsx("p",{className:"mt-1 text-sm text-red-600",children:f.title}),g.jsxs("p",{className:"mt-1 text-sm text-gray-500",children:[a.length," / ",Ye]})]}),g.jsxs("div",{className:"border border-gray-300 rounded-lg",children:[g.jsxs("div",{className:"flex items-center gap-2 p-3 border-b border-gray-200 bg-gray-50",children:[g.jsxs("div",{className:"flex items-center gap-1",children:[g.jsx("button",{type:"button",onClick:()=>x("**","**"),className:"p-2 text-gray-600 hover:text-gray-900 hover:bg-white rounded",title:"굵게",children:g.jsx(F,{className:"w-4 h-4"})}),g.jsx("button",{type:"button",onClick:()=>x("*","*"),className:"p-2 text-gray-600 hover:text-gray-900 hover:bg-white rounded",title:"기울임",children:g.jsx(z,{className:"w-4 h-4"})}),g.jsx("button",{type:"button",onClick:()=>x("<u>","</u>"),className:"p-2 text-gray-600 hover:text-gray-900 hover:bg-white rounded",title:"밑줄",children:g.jsx(V,{className:"w-4 h-4"})})]}),g.jsx("div",{className:"w-px h-6 bg-gray-300"}),g.jsxs("div",{className:"flex items-center gap-1",children:[g.jsx("button",{type:"button",onClick:()=>x("[링크 텍스트](",")"),className:"p-2 text-gray-600 hover:text-gray-900 hover:bg-white rounded",title:"링크",children:g.jsx(H,{className:"w-4 h-4"})}),g.jsx("button",{type:"button",onClick:()=>x("![이미지 설명](",")"),className:"p-2 text-gray-600 hover:text-gray-900 hover:bg-white rounded",title:"이미지",children:g.jsx(W,{className:"w-4 h-4"})})]}),g.jsx("div",{className:"w-px h-6 bg-gray-300"}),g.jsxs("div",{className:"flex items-center gap-1",children:[g.jsx("button",{type:"button",onClick:()=>x("- "),className:"p-2 text-gray-600 hover:text-gray-900 hover:bg-white rounded",title:"목록",children:g.jsx(q,{className:"w-4 h-4"})}),g.jsx("button",{type:"button",onClick:()=>x("1. "),className:"p-2 text-gray-600 hover:text-gray-900 hover:bg-white rounded",title:"번호 목록",children:g.jsx(J,{className:"w-4 h-4"})}),g.jsx("button",{type:"button",onClick:()=>x("> "),className:"p-2 text-gray-600 hover:text-gray-900 hover:bg-white rounded",title:"인용",children:g.jsx(Y,{className:"w-4 h-4"})}),g.jsx("button",{type:"button",onClick:()=>x("`","`"),className:"p-2 text-gray-600 hover:text-gray-900 hover:bg-white rounded",title:"코드",children:g.jsx(Q,{className:"w-4 h-4"})})]}),g.jsx("div",{className:"flex-1"}),g.jsxs("button",{type:"button",onClick:()=>y(!p),className:"flex items-center gap-2 px-3 py-2 text-sm text-gray-600 hover:text-gray-900 hover:bg-white rounded",children:[p?g.jsx(G,{className:"w-4 h-4"}):g.jsx(O,{className:"w-4 h-4"}),p?"편집":"미리보기"]})]}),g.jsx("div",{className:"p-4",children:p?g.jsx("div",{className:"min-h-[400px] prose max-w-none",dangerouslySetInnerHTML:{i:l.replace(/\*\*(.*?)\*\*/g,"<strong>$1</strong>").replace(/\*(.*?)\*/g,"<em>$1</em>").replace(/`(.*?)`/g,"<code>$1</code>").replace(/^> (.+)$/gm,"<blockquote>$1</blockquote>").replace(/^- (.+)$/gm,"<li>$1</li>").replace(/\n/g,"<br>")}}):g.jsx("textarea",{ref:b,value:l,onChange:e=>o(e.target.value),placeholder:"내용을 입력하세요...",className:"w-full min-h-[400px] resize-y border-0 outline-none "+(f.content?"text-red-600":""),maxLength:Qe})}),f.content&&g.jsx("div",{className:"px-4 pb-3",children:g.jsx("p",{className:"text-sm text-red-600",children:f.content})}),g.jsx("div",{className:"px-4 pb-3",children:g.jsxs("p",{className:"text-sm text-gray-500",children:[l.length," / ",Qe]})})]}),g.jsxs("div",{children:[g.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"태그 (최대 10개)"}),g.jsx("div",{className:"flex flex-wrap gap-2 mb-3",children:c.map(e=>g.jsxs(Me,{variant:"secondary",className:"flex items-center gap-1 cursor-pointer",onClick:()=>{return t=e,void d(c.filter(e=>e!==t));var t},children:["#",e,g.jsx("span",{className:"text-xs",children:"×"})]},e))}),g.jsxs("div",{className:"flex gap-2",children:[g.jsx(se,{type:"text",placeholder:"태그를 입력하고 Enter 또는 쉼표를 누르세요",value:h,onChange:e=>m(e.target.value),onKeyDown:e=>{"Enter"!==e.key&&","!==e.key||(e.preventDefault(),v())},disabled:c.length>=10}),g.jsx(Z,{type:"button",variant:"outline",onClick:v,disabled:!h.trim()||c.length>=10,children:"추가"})]})]}),g.jsxs("div",{className:"flex justify-end gap-3",children:[g.jsx(Z,{type:"button",variant:"ghost",onClick:r,disabled:n,children:"취소"}),g.jsx(Z,{type:"submit",variant:"primary",disabled:n,children:n?"저장 중...":s})]})]})})},lt=()=>{const{boardId:e}=v(),t=w(),{user:r,isAuthenticated:n}=Le(),[s,a]=E.useState(null),[i,l]=E.useState(!0),[o,c]=E.useState(null),[d,h]=E.useState(!1),m=e?parseInt(e,10):null;if(!m||isNaN(m))return t("/boards"),null;E.useEffect(()=>{n?u(null,null,function*(){try{l(!0),c(null);const e=yield qe.getBoardById(m);if(a(e),e.adminOnly&&(!r||"ADMIN"!==r.role&&"FACILITY"!==r.role))return void c("이 게시판에 글을 작성할 권한이 없습니다.")}catch(e){c("게시판 정보를 불러오는데 실패했습니다.")}finally{l(!1)}}):t("/auth/signin")},[m,n,t,r]);const p=()=>{t(`/boards/${m}`)};if(!n)return null;if(i)return g.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:g.jsx(Pe,{size:"lg"})});if(o||!s)return g.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:g.jsx(Ke,{message:o||"게시판을 찾을 수 없습니다.",onRetry:()=>window.location.reload()})});const y=Je[s.type];return g.jsx(g.Fragment,{children:g.jsx("div",{className:"min-h-screen bg-gray-50",children:g.jsxs("div",{className:"max-w-6xl mx-auto px-4 py-6",children:[g.jsx("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-6 mb-6",children:g.jsxs("div",{className:"flex items-center gap-4",children:[g.jsx(Z,{variant:"ghost",size:"sm",onClick:p,className:"p-2",children:g.jsx(M,{className:"w-5 h-5"})}),g.jsxs("div",{className:"flex items-center gap-3",children:[g.jsx("div",{className:"w-10 h-10 bg-blue-100 rounded-lg flex items-center justify-center text-xl",children:y.icon}),g.jsxs("div",{children:[g.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"글쓰기"}),g.jsxs("p",{className:"text-gray-600",children:[s.name,"에 새로운 글을 작성하세요"]})]})]})]})}),g.jsx("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-6",children:g.jsx(it,{onSubmit:e=>u(null,null,function*(){try{h(!0);const r=yield qe.createPost(m,e);t(`/boards/${m}/posts/${r.id}`)}catch(r){throw new Error("게시글 작성에 실패했습니다.")}finally{h(!1)}}),onCancel:p,isLoading:d,submitLabel:"게시글 작성"})})]})})})},ot=Object.freeze(Object.defineProperty({__proto__:null,PostCreatePage:lt,default:lt},Symbol.toStringTag,{value:"Module"}));export{Me as B,Ke as E,Pe as L,at as P,De as a,We as b,Ue as c,et as d,fe as e,ot as f,pe as n,Le as u};

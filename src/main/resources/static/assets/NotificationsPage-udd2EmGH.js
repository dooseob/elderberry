var e=Object.defineProperty,t=Object.defineProperties,o=Object.getOwnPropertyDescriptors,r=Object.getOwnPropertySymbols,i=Object.prototype.hasOwnProperty,l=Object.prototype.propertyIsEnumerable,n=(t,o,r)=>o in t?e(t,o,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[o]=r,a=(e,t)=>{for(var o in t||(t={}))i.call(t,o)&&n(e,o,t[o]);if(r)for(var o of r(t))l.call(t,o)&&n(e,o,t[o]);return e},c=(e,r)=>t(e,o(r)),s=(e,t,o)=>new Promise((r,i)=>{var l=e=>{try{a(o.next(e))}catch(t){i(t)}},n=e=>{try{a(o.throw(e))}catch(t){i(t)}},a=e=>e.done?r(e.value):Promise.resolve(e.value).then(l,n);a((o=o.apply(e,t)).next())});import{c as d,j as m,r as u}from"./react-vendor-DjlEhPtN.js";import{p}from"./state-management-DnGX11vy.js";import{n as b,e as g,L as x}from"./board-pages-Boj7UMsD.js";import{C as h}from"./index-BnHvVWTh.js";import{f,k as y}from"./date-utils-DpO5pKPm.js";import{B as v}from"./core-ui-CLdLL7GI.js";import{C as w}from"./chat-pages-DZlm3u1D.js";import"./vendor-Bp3O2Fb0.js";import"./style-utils-DeQRAeyh.js";import"./http-client-9JY-woyA.js";import"./theme-layout-lfdIx57L.js";import"./facility-pages-CdldLj64.js";import"./animation-lib-Df_skjj_.js";import"./schema-validation-CGaxRmGr.js";import"./form-libs-BWg46H5N.js";var N=(e=>(e.FACILITY_MATCH_FOUND="facility_match_found",e.FACILITY_MATCH_CONFIRMED="facility_match_confirmed",e.FACILITY_MATCH_CANCELLED="facility_match_cancelled",e.REVIEW_APPROVED="review_approved",e.REVIEW_REJECTED="review_rejected",e.REVIEW_REPORTED="review_reported",e.JOB_APPLICATION_RECEIVED="job_application_received",e.JOB_APPLICATION_APPROVED="job_application_approved",e.JOB_APPLICATION_REJECTED="job_application_rejected",e.JOB_INTERVIEW_SCHEDULED="job_interview_scheduled",e.SYSTEM_MAINTENANCE="system_maintenance",e.SYSTEM_UPDATE="system_update",e.ACCOUNT_SECURITY="account_security",e.GENERAL_INFO="general_info",e.PROMOTION="promotion",e))(N||{}),C=(e=>(e.LOW="low",e.MEDIUM="medium",e.HIGH="high",e.URGENT="urgent",e))(C||{});const j={facility_match_found:{icon:"🏥",color:"blue",bgColor:"bg-blue-50",textColor:"text-blue-600"},facility_match_confirmed:{icon:"✅",color:"green",bgColor:"bg-green-50",textColor:"text-green-600"},facility_match_cancelled:{icon:"❌",color:"red",bgColor:"bg-red-50",textColor:"text-red-600"},review_approved:{icon:"⭐",color:"yellow",bgColor:"bg-yellow-50",textColor:"text-yellow-600"},review_rejected:{icon:"⚠️",color:"orange",bgColor:"bg-orange-50",textColor:"text-orange-600"},review_reported:{icon:"🚨",color:"red",bgColor:"bg-red-50",textColor:"text-red-600"},job_application_received:{icon:"📝",color:"blue",bgColor:"bg-blue-50",textColor:"text-blue-600"},job_application_approved:{icon:"🎉",color:"green",bgColor:"bg-green-50",textColor:"text-green-600"},job_application_rejected:{icon:"📋",color:"gray",bgColor:"bg-gray-50",textColor:"text-gray-600"},job_interview_scheduled:{icon:"📅",color:"purple",bgColor:"bg-purple-50",textColor:"text-purple-600"},system_maintenance:{icon:"🔧",color:"gray",bgColor:"bg-gray-50",textColor:"text-gray-600"},system_update:{icon:"🔄",color:"blue",bgColor:"bg-blue-50",textColor:"text-blue-600"},account_security:{icon:"🔒",color:"red",bgColor:"bg-red-50",textColor:"text-red-600"},general_info:{icon:"ℹ️",color:"blue",bgColor:"bg-blue-50",textColor:"text-blue-600"},promotion:{icon:"🎁",color:"purple",bgColor:"bg-purple-50",textColor:"text-purple-600"}},_={enabled:!0,email:!0,push:!0,sms:!1,types:{[N.FACILITY_MATCH_FOUND]:!0,[N.FACILITY_MATCH_CONFIRMED]:!0,[N.FACILITY_MATCH_CANCELLED]:!0,[N.REVIEW_APPROVED]:!0,[N.REVIEW_REJECTED]:!0,[N.REVIEW_REPORTED]:!1,[N.JOB_APPLICATION_RECEIVED]:!0,[N.JOB_APPLICATION_APPROVED]:!0,[N.JOB_APPLICATION_REJECTED]:!0,[N.JOB_INTERVIEW_SCHEDULED]:!0,[N.SYSTEM_MAINTENANCE]:!0,[N.SYSTEM_UPDATE]:!1,[N.ACCOUNT_SECURITY]:!0,[N.GENERAL_INFO]:!1,[N.PROMOTION]:!1},quietHours:{enabled:!1,start:"22:00",end:"08:00"}},k={total:0,unread:0,byType:Object.fromEntries(Object.values(N).map(e=>[e,0])),byPriority:{[C.LOW]:0,[C.MEDIUM]:0,[C.HIGH]:0,[C.URGENT]:0}},D=d()(p((e,t)=>({notifications:[],summary:k,settings:_,isLoading:!1,error:null,isDropdownOpen:!1,hasMore:!1,filter:{},isPolling:!1,fetchNotifications:(...o)=>s(null,[...o],function*(o={},r=!1){const i={operation:"fetchNotifications",context:{filter:o,loadMore:r}};try{r||e({isLoading:!0,error:null});let i,n=[],a=!1;try{throw new Error("API not implemented yet")}catch(l){n=[{id:"1",type:N.FACILITY_MATCH_FOUND,title:"새로운 시설 매칭",message:"조건에 맞는 요양시설이 발견되었습니다.",read:!1,createdAt:(new Date).toISOString(),priority:C.HIGH,actionUrl:"/facilities/1"},{id:"2",type:N.JOB_APPLICATION_APPROVED,title:"구인 지원 승인",message:"지원하신 구인이 승인되었습니다.",read:!0,createdAt:new Date(Date.now()-864e5).toISOString(),readAt:(new Date).toISOString(),priority:C.MEDIUM,actionUrl:"/jobs/applications"},{id:"3",type:N.REVIEW_APPROVED,title:"리뷰 승인됨",message:"작성하신 리뷰가 승인되어 게시되었습니다.",read:!1,createdAt:new Date(Date.now()-36e5).toISOString(),priority:C.MEDIUM,actionUrl:"/reviews"}].filter(e=>(void 0===o.read||e.read===o.read)&&(!(o.types&&!o.types.includes(e.type))&&((!o.priority||e.priority===o.priority)&&(!(o.dateFrom&&new Date(e.createdAt)<new Date(o.dateFrom))&&!(o.dateTo&&new Date(e.createdAt)>new Date(o.dateTo)))))),a=!1}const c=t(),s=r?[...c.notifications,...n]:n;e({notifications:s,hasMore:a,nextCursor:i,isLoading:!1,lastFetchTime:new Date}),t().updateSummary()}catch(n){const t=b(n,i);g.logError(t,i),e({error:t,isLoading:!1})}}),markAsRead:o=>s(null,null,function*(){const r={operation:"markAsRead",context:{notificationId:o}};try{const r=t().notifications.map(e=>e.id===o?c(a({},e),{read:!0,readAt:(new Date).toISOString()}):e);e({notifications:r}),t().updateSummary()}catch(i){const t=b(i,r);g.logError(t,r),e({error:t})}}),markAllAsRead:()=>s(null,null,function*(){const o={operation:"markAllAsRead",context:{}};try{const o=t(),r=(new Date).toISOString(),i=o.notifications.map(e=>c(a({},e),{read:!0,readAt:e.readAt||r}));e({notifications:i}),t().updateSummary()}catch(r){const t=b(r,o);g.logError(t,o),e({error:t})}}),deleteNotification:o=>s(null,null,function*(){const r={operation:"deleteNotification",context:{notificationId:o}};try{const r=t().notifications.filter(e=>e.id!==o);e({notifications:r}),t().updateSummary()}catch(i){const t=b(i,r);g.logError(t,r),e({error:t})}}),clearAllNotifications:()=>s(null,null,function*(){const t={operation:"clearAllNotifications",context:{}};try{e({notifications:[],summary:k})}catch(o){const r=b(o,t);g.logError(r,t),e({error:r})}}),updateSettings:o=>s(null,null,function*(){const r={operation:"updateSettings",context:{settings:o}};try{const r=t(),i=a(a({},r.settings),o);e({settings:i})}catch(i){const t=b(i,r);g.logError(t,r),e({error:t})}}),toggleDropdown:()=>{e(e=>({isDropdownOpen:!e.isDropdownOpen}))},closeDropdown:()=>{e({isDropdownOpen:!1})},setFilter:o=>{const r=t();e({filter:a(a({},r.filter),o)})},clearFilter:()=>{e({filter:{}})},startPolling:()=>{if(t().isPolling)return;e({isPolling:!0});const o=setInterval(()=>{const e=t();e.isPolling?e.fetchNotifications(e.filter,!1):clearInterval(o)},3e4);window.notificationPollingInterval=o},stopPolling:()=>{e({isPolling:!1}),window.notificationPollingInterval&&(clearInterval(window.notificationPollingInterval),delete window.notificationPollingInterval)},addNotification:o=>{const r=t();e({notifications:[o,...r.notifications]}),t().updateSummary()},clearError:()=>{e({error:null})},setLoading:t=>{e({isLoading:t})},updateSummary:()=>{const o=t().notifications,r={total:o.length,unread:o.filter(e=>!e.read).length,byType:Object.fromEntries(Object.values(N).map(e=>[e,o.filter(t=>t.type===e).length])),byPriority:{[C.LOW]:o.filter(e=>e.priority===C.LOW).length,[C.MEDIUM]:o.filter(e=>e.priority===C.MEDIUM).length,[C.HIGH]:o.filter(e=>e.priority===C.HIGH).length,[C.URGENT]:o.filter(e=>e.priority===C.URGENT).length}};e({summary:r})}}),{name:"notification-store",partialize:e=>({settings:e.settings,filter:e.filter})})),A=({notification:e,onClick:t,showActions:o=!0,compact:r=!1})=>{const{markAsRead:i,deleteNotification:l}=D(),n=j[e.type],a=()=>{e.read||i(e.id),t?t(e):e.actionUrl&&(window.location.href=e.actionUrl)},c=f(new Date(e.createdAt),{addSuffix:!0,locale:y}),s={[C.LOW]:"border-l-gray-300",[C.MEDIUM]:"border-l-blue-400",[C.HIGH]:"border-l-orange-400",[C.URGENT]:"border-l-red-500"};return m.jsx(h,{animation:{initial:{opacity:0,x:-20},animate:{opacity:1,x:0},exit:{opacity:0,x:20},transition:{duration:.2}},children:m.jsxs("div",{className:`\n          relative p-4 border-l-4 cursor-pointer transition-all duration-200\n          ${s[e.priority]}\n          ${e.read?"bg-gray-50 opacity-75":`${n.bgColor} hover:shadow-md`}\n          ${r?"p-3":"p-4"}\n          hover:bg-opacity-80 focus:outline-none focus:ring-2 focus:ring-blue-500\n        `,onClick:a,onKeyDown:e=>{"Enter"!==e.key&&" "!==e.key||(e.preventDefault(),a())},tabIndex:0,role:"button","aria-label":`알림: ${e.title}. ${e.read?"읽음":"읽지 않음"}`,children:[!e.read&&m.jsx("div",{className:"absolute top-2 right-2 w-2 h-2 bg-blue-500 rounded-full","aria-label":"읽지 않은 알림"}),m.jsxs("div",{className:"flex items-start gap-3",children:[m.jsx("div",{className:`text-lg ${n.textColor} flex-shrink-0`,children:n.icon}),m.jsxs("div",{className:"flex-1 min-w-0",children:[m.jsxs("div",{className:"flex items-center justify-between mb-1",children:[m.jsx("h3",{className:`\n                font-medium text-sm ${e.read?"text-gray-600":"text-gray-900"}\n                ${r?"text-xs":"text-sm"}\n                truncate\n              `,children:e.title}),!r&&m.jsx("span",{className:`\n                  text-xs ${e.read?"text-gray-400":"text-gray-500"}\n                  flex-shrink-0 ml-2\n                `,children:c})]}),m.jsx("p",{className:`\n              text-sm ${e.read?"text-gray-500":"text-gray-700"}\n              ${r?"text-xs line-clamp-1":"line-clamp-2"}\n            `,children:e.message}),e.priority===C.URGENT&&m.jsx("div",{className:"mt-2",children:m.jsx("span",{className:"inline-flex items-center px-2 py-1 text-xs font-medium bg-red-100 text-red-800 rounded-full",children:"🚨 긴급"})}),o&&!r&&m.jsxs("div",{className:"mt-3 flex gap-2",children:[!e.read&&m.jsx("button",{onClick:t=>{t.stopPropagation(),i(e.id)},className:"text-xs text-blue-600 hover:text-blue-800 focus:outline-none focus:underline","aria-label":"읽음으로 표시",children:"읽음 표시"}),m.jsx("button",{onClick:t=>{t.stopPropagation(),l(e.id)},className:"text-xs text-red-600 hover:text-red-800 focus:outline-none focus:underline","aria-label":"알림 삭제",children:"삭제"})]})]})]})]})})},O=()=>{const{notifications:e,summary:t,filter:o,isLoading:r,error:i,hasMore:l,fetchNotifications:n,markAllAsRead:c,clearAllNotifications:s,setFilter:d,clearFilter:p}=D(),[b,g]=u.useState(!1);u.useEffect(()=>{n()},[n]);const h=e=>{d(e),n(a(a({},o),e))},f=Object.keys(o).length>0;return m.jsxs("div",{className:"max-w-4xl mx-auto p-6 space-y-6",children:[m.jsxs("div",{className:"flex items-center justify-between",children:[m.jsxs("div",{children:[m.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"알림"}),m.jsxs("p",{className:"text-sm text-gray-600 mt-1",children:["총 ",t.total,"개의 알림 중 ",t.unread,"개를 읽지 않았습니다."]})]}),m.jsxs("div",{className:"flex gap-3",children:[m.jsxs(v,{variant:"outline",size:"small",onClick:()=>g(!b),children:["필터 ",b?"숨기기":"보기"]}),t.unread>0&&m.jsx(v,{variant:"outline",size:"small",onClick:()=>{c()},disabled:r,children:"모두 읽음 표시"}),e.length>0&&m.jsx(v,{variant:"outline",size:"small",onClick:()=>{window.confirm("모든 알림을 삭제하시겠습니까? 이 작업은 되돌릴 수 없습니다.")&&s()},disabled:r,className:"text-red-600 hover:text-red-800",children:"모두 삭제"})]})]}),b&&m.jsx(w,{className:"p-4",children:m.jsxs("div",{className:"space-y-4",children:[m.jsxs("div",{className:"flex items-center justify-between",children:[m.jsx("h3",{className:"text-sm font-semibold text-gray-900",children:"필터"}),f&&m.jsx(v,{variant:"ghost",size:"small",onClick:()=>{p(),n()},children:"초기화"})]}),m.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[m.jsxs("div",{children:[m.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-2",children:"읽음 상태"}),m.jsxs("select",{value:void 0===o.read?"all":o.read.toString(),onChange:e=>{const t="all"===e.target.value?void 0:"true"===e.target.value;h({read:t})},className:"w-full px-3 py-2 text-sm border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-blue-500",children:[m.jsx("option",{value:"all",children:"전체"}),m.jsx("option",{value:"false",children:"읽지 않음"}),m.jsx("option",{value:"true",children:"읽음"})]})]}),m.jsxs("div",{children:[m.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-2",children:"우선순위"}),m.jsxs("select",{value:o.priority||"all",onChange:e=>{const t="all"===e.target.value?void 0:e.target.value;h({priority:t})},className:"w-full px-3 py-2 text-sm border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-blue-500",children:[m.jsx("option",{value:"all",children:"전체"}),m.jsx("option",{value:C.URGENT,children:"긴급"}),m.jsx("option",{value:C.HIGH,children:"높음"}),m.jsx("option",{value:C.MEDIUM,children:"보통"}),m.jsx("option",{value:C.LOW,children:"낮음"})]})]}),m.jsxs("div",{children:[m.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-2",children:"기간"}),m.jsxs("select",{onChange:e=>{const t=e.target.value,o=new Date;let r;switch(t){case"today":r=new Date(o.getFullYear(),o.getMonth(),o.getDate()).toISOString();break;case"week":r=new Date(o.getTime()-6048e5).toISOString();break;case"month":r=new Date(o.getTime()-2592e6).toISOString();break;default:r=void 0}h({dateFrom:r,dateTo:void 0})},className:"w-full px-3 py-2 text-sm border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-blue-500",children:[m.jsx("option",{value:"all",children:"전체"}),m.jsx("option",{value:"today",children:"오늘"}),m.jsx("option",{value:"week",children:"최근 7일"}),m.jsx("option",{value:"month",children:"최근 30일"})]})]})]}),m.jsxs("div",{children:[m.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-2",children:"알림 타입"}),m.jsx("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-2",children:Object.values(N).map(e=>{var t;return m.jsxs("label",{className:"flex items-center space-x-2",children:[m.jsx("input",{type:"checkbox",checked:(null==(t=o.types)?void 0:t.includes(e))||!1,onChange:t=>{const r=o.types||[],i=t.target.checked?[...r,e]:r.filter(t=>t!==e);h({types:i.length>0?i:void 0})},className:"rounded text-blue-600 focus:ring-blue-500"}),m.jsx("span",{className:"text-xs text-gray-700",children:$(e)})]},e)})})]})]})}),m.jsx("div",{className:"space-y-2",children:r&&0===e.length?m.jsxs("div",{className:"flex items-center justify-center py-12",children:[m.jsx(x,{size:"medium"}),m.jsx("span",{className:"ml-3 text-gray-600",children:"알림을 불러오는 중..."})]}):i?m.jsxs(w,{className:"p-8 text-center",children:[m.jsx("p",{className:"text-red-600 mb-4",children:"알림을 불러오는데 실패했습니다."}),m.jsx(v,{variant:"outline",onClick:()=>n(),children:"다시 시도"})]}):0===e.length?m.jsxs(w,{className:"p-12 text-center",children:[m.jsx("div",{className:"text-6xl mb-4",children:"🔔"}),m.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"알림이 없습니다"}),m.jsx("p",{className:"text-gray-600",children:f?"필터 조건에 맞는 알림이 없습니다.":"새로운 알림이 없습니다."})]}):m.jsxs(m.Fragment,{children:[m.jsx("div",{className:"space-y-2",children:e.map(e=>m.jsx(w,{className:"overflow-hidden",children:m.jsx(A,{notification:e,showActions:!0,compact:!1})},e.id))}),l&&m.jsx("div",{className:"text-center py-6",children:m.jsx(v,{variant:"outline",onClick:()=>{n(o,!0)},disabled:r,children:r?"불러오는 중...":"더 보기"})})]})})]})};function $(e){return{[N.FACILITY_MATCH_FOUND]:"시설 매칭",[N.FACILITY_MATCH_CONFIRMED]:"매칭 확정",[N.FACILITY_MATCH_CANCELLED]:"매칭 취소",[N.REVIEW_APPROVED]:"리뷰 승인",[N.REVIEW_REJECTED]:"리뷰 거부",[N.REVIEW_REPORTED]:"리뷰 신고",[N.JOB_APPLICATION_RECEIVED]:"지원 접수",[N.JOB_APPLICATION_APPROVED]:"지원 승인",[N.JOB_APPLICATION_REJECTED]:"지원 거부",[N.JOB_INTERVIEW_SCHEDULED]:"면접 일정",[N.SYSTEM_MAINTENANCE]:"시스템 점검",[N.SYSTEM_UPDATE]:"시스템 업데이트",[N.ACCOUNT_SECURITY]:"계정 보안",[N.GENERAL_INFO]:"일반 정보",[N.PROMOTION]:"프로모션"}[e]||e}const P=()=>m.jsx("div",{className:"container mx-auto py-6",children:m.jsx(O,{})});export{P as default};

var e=Object.defineProperty,s=Object.defineProperties,t=Object.getOwnPropertyDescriptors,a=Object.getOwnPropertySymbols,i=Object.prototype.hasOwnProperty,l=Object.prototype.propertyIsEnumerable,r=(s,t,a)=>t in s?e(s,t,{enumerable:!0,configurable:!0,writable:!0,value:a}):s[t]=a,n=(e,s)=>{for(var t in s||(s={}))i.call(s,t)&&r(e,t,s[t]);if(a)for(var t of a(s))l.call(s,t)&&r(e,t,s[t]);return e},c=(e,a)=>s(e,t(a)),o=(e,s,t)=>r(e,"symbol"!=typeof s?s+"":s,t),d=(e,s,t)=>new Promise((a,i)=>{var l=e=>{try{n(t.next(e))}catch(s){i(s)}},r=e=>{try{n(t.throw(e))}catch(s){i(s)}},n=e=>e.done?a(e.value):Promise.resolve(e.value).then(l,r);n((t=t.apply(e,s)).next())});import{c as m,r as x,j as h,i as u,V as g,W as p,Y as y,m as f,d as j,Z as v,S as w,X as b,_ as N,$ as k,a0 as C,a1 as S,a2 as $,a3 as R,a4 as F,a5 as E,g as T,a6 as M,b as P,C as A,a7 as L,a8 as z,a9 as I,aa as O,ab as B,ac as _,ad as H,ae as D,I as G,af as K,ag as U,ah as W,ai as Y,aj as q,ak as V,f as Q,al as J,F as Z,am as X,w as ee,h as se,an as te,ao as ae,ap as ie,aq as le,ar as re,as as ne}from"./react-vendor-DxVTcXnD.js";import{i as ce,d as oe,s as de}from"./state-management-DszUOxv_.js";import{C as me,d as xe,B as he,e as ue,f as ge,L as pe,u as ye,g as fe,S as je}from"./board-pages-B7TFhQ6F.js";import{m as ve,A as we}from"./ui-libs-CJrx2-W2.js";import{a as be}from"./utils-D3YFsgXT.js";var Ne=(e=>(e.LATEST="latest",e.OLDEST="oldest",e.HIGHEST_RATING="highest",e.LOWEST_RATING="lowest",e.MOST_HELPFUL="helpful",e))(Ne||{});const ke={baseURL:"http://localhost:8080",timeout:3e4,headers:{"Content-Type":"application/json"}};class Ce{constructor(){o(this,"ACCESS_TOKEN_KEY","accessToken"),o(this,"REFRESH_TOKEN_KEY","refreshToken")}getAccessToken(){return localStorage.getItem(this.ACCESS_TOKEN_KEY)}getRefreshToken(){return localStorage.getItem(this.REFRESH_TOKEN_KEY)}setTokens(e,s){localStorage.setItem(this.ACCESS_TOKEN_KEY,e),localStorage.setItem(this.REFRESH_TOKEN_KEY,s)}clearTokens(){localStorage.removeItem(this.ACCESS_TOKEN_KEY),localStorage.removeItem(this.REFRESH_TOKEN_KEY)}isTokenExpired(e){try{return 1e3*JSON.parse(atob(e.split(".")[1])).exp<Date.now()}catch(s){return!0}}}const Se=new class{constructor(){o(this,"client"),o(this,"tokenManager"),o(this,"isRefreshing",!1),o(this,"refreshPromise",null),this.client=be.create(ke),this.tokenManager=new Ce,this.setupInterceptors()}setupInterceptors(){this.client.interceptors.request.use(e=>{const s=this.tokenManager.getAccessToken();return s&&!this.tokenManager.isTokenExpired(s)&&(e.headers.Authorization=`Bearer ${s}`),e},e=>Promise.reject(e)),this.client.interceptors.response.use(e=>e,e=>d(this,null,function*(){var s;const t=e.config;if(401===(null==(s=e.response)?void 0:s.status)&&!t._retry){t._retry=!0;try{const e=yield this.refreshAccessToken();return t.headers.Authorization=`Bearer ${e}`,this.client(t)}catch(a){return this.tokenManager.clearTokens(),window.location.href="/login",Promise.reject(a)}}return Promise.reject(this.handleError(e))}))}refreshAccessToken(){return d(this,null,function*(){if(this.isRefreshing&&this.refreshPromise)return this.refreshPromise;this.isRefreshing=!0,this.refreshPromise=this.performTokenRefresh();try{return yield this.refreshPromise}finally{this.isRefreshing=!1,this.refreshPromise=null}})}performTokenRefresh(){return d(this,null,function*(){const e=this.tokenManager.getRefreshToken();if(!e)throw new Error("No refresh token available");const s=yield be.post(`${ke.baseURL}/auth/refresh`,{refreshToken:e},{headers:ke.headers}),{accessToken:t,refreshToken:a}=s.data;return this.tokenManager.setTokens(t,a),t})}handleError(e){var s,t;return(null==(s=e.response)?void 0:s.data)?e.response.data:{error:"NETWORK_ERROR",message:e.message||"Network error occurred",statusCode:(null==(t=e.response)?void 0:t.status)||0,timestamp:(new Date).toISOString()}}get(e,s){return d(this,null,function*(){return(yield this.client.get(e,s)).data})}post(e,s,t){return d(this,null,function*(){return(yield this.client.post(e,s,t)).data})}put(e,s,t){return d(this,null,function*(){return(yield this.client.put(e,s,t)).data})}patch(e,s,t){return d(this,null,function*(){return(yield this.client.patch(e,s,t)).data})}delete(e,s){return d(this,null,function*(){return(yield this.client.delete(e,s)).data})}uploadFile(e,s,t){return d(this,null,function*(){const a=new FormData;a.append("file",s);const i={headers:{"Content-Type":"multipart/form-data"},onUploadProgress:e=>{if(t&&e.total){const s=Math.round(100*e.loaded/e.total);t(s)}}};return(yield this.client.post(e,a,i)).data})}setTokens(e,s){this.tokenManager.setTokens(e,s)}clearTokens(){this.tokenManager.clearTokens()}getAccessToken(){return this.tokenManager.getAccessToken()}isAuthenticated(){const e=this.tokenManager.getAccessToken();return!!e&&!this.tokenManager.isTokenExpired(e)}},$e=e=>{var s,t,a;if(null==(t=null==(s=e.response)?void 0:s.data)?void 0:t.message)return e.response.data.message;switch(null==(a=e.response)?void 0:a.status){case 400:return"잘못된 요청입니다. 입력 정보를 확인해주세요.";case 401:return"로그인이 필요합니다.";case 403:return"권한이 없습니다.";case 404:return"리뷰를 찾을 수 없습니다.";case 409:return"이미 리뷰를 작성하셨거나 중복된 요청입니다.";case 500:return"서버 오류가 발생했습니다. 잠시 후 다시 시도해주세요.";default:return"알 수 없는 오류가 발생했습니다."}},Re={reviews:[],currentReview:null,reviewStatistics:null,pagination:{page:0,size:10,totalElements:0,totalPages:0,hasNext:!1,hasPrevious:!1},currentFilter:{},currentSort:Ne.LATEST,loading:{reviews:!1,create:!1,update:!1,delete:!1,vote:!1,report:!1,statistics:!1},error:null,selectedFacilityId:null,myReviews:[],myReviewsPagination:{page:0,totalElements:0,totalPages:0}},Fe=m()(ce((e,s)=>c(n({},Re),{loadReviews:(s,t=0,a=10)=>d(null,null,function*(){e(e=>{e.loading.reviews=!0,e.error=null,e.selectedFacilityId=s});try{const i=yield((e,s=0,t=10)=>d(null,null,function*(){return(yield Se.get(`/reviews/facility/${e}?page=${s}&size=${t}`)).data}))(s,t,a);e(e=>{e.reviews=i.content,e.pagination={page:i.number,size:i.size,totalElements:i.totalElements,totalPages:i.totalPages,hasNext:!i.last,hasPrevious:!i.first},e.loading.reviews=!1})}catch(i){e(e=>{e.error=$e(i),e.loading.reviews=!1})}}),loadReviewById:s=>d(null,null,function*(){e(e=>{e.loading.reviews=!0,e.error=null});try{const t=yield(e=>d(null,null,function*(){return(yield Se.get(`/reviews/${e}`)).data}))(s);e(e=>{e.currentReview=t,e.loading.reviews=!1})}catch(t){e(e=>{e.error=$e(t),e.loading.reviews=!1})}}),createReview:(s,t)=>d(null,null,function*(){e(e=>{e.loading.create=!0,e.error=null});try{const a=yield((e,s)=>d(null,null,function*(){return(yield Se.post(`/reviews/facility/${e}`,s)).data}))(s,t);return e(e=>{e.reviews.unshift(a),e.loading.create=!1}),a}catch(a){throw e(e=>{e.error=$e(a),e.loading.create=!1}),a}}),updateReview:(s,t)=>d(null,null,function*(){e(e=>{e.loading.update=!0,e.error=null});try{const a=yield((e,s)=>d(null,null,function*(){return(yield Se.put(`/reviews/${e}`,s)).data}))(s,t);return e(e=>{var t;const i=e.reviews.findIndex(e=>e.id===s);-1!==i&&(e.reviews[i]=a),(null==(t=e.currentReview)?void 0:t.id)===s&&(e.currentReview=a),e.loading.update=!1}),a}catch(a){throw e(e=>{e.error=$e(a),e.loading.update=!1}),a}}),deleteReview:s=>d(null,null,function*(){e(e=>{e.loading.delete=!0,e.error=null});try{yield(e=>d(null,null,function*(){yield Se.delete(`/reviews/${e}`)}))(s),e(e=>{var t;e.reviews=e.reviews.filter(e=>e.id!==s),(null==(t=e.currentReview)?void 0:t.id)===s&&(e.currentReview=null),e.loading.delete=!1})}catch(t){throw e(e=>{e.error=$e(t),e.loading.delete=!1}),t}}),loadLatestReviews:(t,a=0)=>d(null,null,function*(){e(e=>{e.loading.reviews=!0,e.error=null,e.selectedFacilityId=t,e.currentSort=Ne.LATEST});try{const i=yield((e,s=0,t=10)=>d(null,null,function*(){return(yield Se.get(`/reviews/facility/${e}/latest?page=${s}&size=${t}`)).data}))(t,a,s().pagination.size);e(e=>{e.reviews=i.content,e.pagination.page=i.number,e.pagination.totalElements=i.totalElements,e.pagination.totalPages=i.totalPages,e.pagination.hasNext=!i.last,e.pagination.hasPrevious=!i.first,e.loading.reviews=!1})}catch(i){e(e=>{e.error=$e(i),e.loading.reviews=!1})}}),loadBestReviews:(t,a=0)=>d(null,null,function*(){e(e=>{e.loading.reviews=!0,e.error=null,e.selectedFacilityId=t,e.currentSort=Ne.MOST_HELPFUL});try{const i=yield((e,s=0,t=10)=>d(null,null,function*(){return(yield Se.get(`/reviews/facility/${e}/best?page=${s}&size=${t}`)).data}))(t,a,s().pagination.size);e(e=>{e.reviews=i.content,e.pagination.page=i.number,e.pagination.totalElements=i.totalElements,e.pagination.totalPages=i.totalPages,e.pagination.hasNext=!i.last,e.pagination.hasPrevious=!i.first,e.loading.reviews=!1})}catch(i){e(e=>{e.error=$e(i),e.loading.reviews=!1})}}),loadVerifiedReviews:(t,a=0)=>d(null,null,function*(){e(e=>{e.loading.reviews=!0,e.error=null,e.selectedFacilityId=t,e.currentFilter=c(n({},e.currentFilter),{verified:!0})});try{const i=yield((e,s=0,t=10)=>d(null,null,function*(){return(yield Se.get(`/reviews/facility/${e}/verified?page=${s}&size=${t}`)).data}))(t,a,s().pagination.size);e(e=>{e.reviews=i.content,e.pagination.page=i.number,e.pagination.totalElements=i.totalElements,e.pagination.totalPages=i.totalPages,e.pagination.hasNext=!i.last,e.pagination.hasPrevious=!i.first,e.loading.reviews=!1})}catch(i){e(e=>{e.error=$e(i),e.loading.reviews=!1})}}),loadReviewsWithImages:(t,a=0)=>d(null,null,function*(){e(e=>{e.loading.reviews=!0,e.error=null,e.selectedFacilityId=t,e.currentFilter=c(n({},e.currentFilter),{hasImages:!0})});try{const i=yield((e,s=0,t=10)=>d(null,null,function*(){return(yield Se.get(`/reviews/facility/${e}/with-images?page=${s}&size=${t}`)).data}))(t,a,s().pagination.size);e(e=>{e.reviews=i.content,e.pagination.page=i.number,e.pagination.totalElements=i.totalElements,e.pagination.totalPages=i.totalPages,e.pagination.hasNext=!i.last,e.pagination.hasPrevious=!i.first,e.loading.reviews=!1})}catch(i){e(e=>{e.error=$e(i),e.loading.reviews=!1})}}),applyFilter:t=>d(null,null,function*(){const{selectedFacilityId:a,currentSort:i,pagination:l}=s();a&&(e(e=>{e.currentFilter=t}),yield s().loadFilteredReviews(a,t,i,0))}),changeSort:t=>d(null,null,function*(){const{selectedFacilityId:a,currentFilter:i}=s();a&&(e(e=>{e.currentSort=t}),yield s().loadFilteredReviews(a,i,t,0))}),loadFilteredReviews:(t,a,i,l=0)=>d(null,null,function*(){e(e=>{e.loading.reviews=!0,e.error=null,e.selectedFacilityId=t,e.currentFilter=a,e.currentSort=i});try{const r=yield((e,s,...t)=>d(null,[e,s,...t],function*(e,s,t=Ne.LATEST,a=0,i=10){const l=new URLSearchParams({page:a.toString(),size:i.toString(),sort:t});return s.reviewType&&l.append("reviewType",s.reviewType),s.minRating&&l.append("minRating",s.minRating.toString()),s.maxRating&&l.append("maxRating",s.maxRating.toString()),void 0!==s.verified&&l.append("verified",s.verified.toString()),void 0!==s.hasImages&&l.append("hasImages",s.hasImages.toString()),void 0!==s.recommended&&l.append("recommended",s.recommended.toString()),(yield Se.get(`/reviews/facility/${e}/filtered?${l.toString()}`)).data}))(t,a,i,l,s().pagination.size);e(e=>{e.reviews=r.content,e.pagination.page=r.number,e.pagination.totalElements=r.totalElements,e.pagination.totalPages=r.totalPages,e.pagination.hasNext=!r.last,e.pagination.hasPrevious=!r.first,e.loading.reviews=!1})}catch(r){e(e=>{e.error=$e(r),e.loading.reviews=!1})}}),clearFilter:()=>{e(e=>{e.currentFilter={}})},voteHelpful:s=>d(null,null,function*(){e(e=>{e.loading.vote=!0,e.error=null});try{yield(e=>d(null,null,function*(){yield Se.post(`/reviews/${e}/vote/helpful`)}))(s),e(e=>{var t;const a=e.reviews.find(e=>e.id===s);a&&(a.helpfulCount+=1),(null==(t=e.currentReview)?void 0:t.id)===s&&(e.currentReview.helpfulCount+=1),e.loading.vote=!1})}catch(t){throw e(e=>{e.error=$e(t),e.loading.vote=!1}),t}}),voteNotHelpful:s=>d(null,null,function*(){e(e=>{e.loading.vote=!0,e.error=null});try{yield(e=>d(null,null,function*(){yield Se.post(`/reviews/${e}/vote/not-helpful`)}))(s),e(e=>{var t;const a=e.reviews.find(e=>e.id===s);a&&(a.notHelpfulCount+=1),(null==(t=e.currentReview)?void 0:t.id)===s&&(e.currentReview.notHelpfulCount+=1),e.loading.vote=!1})}catch(t){throw e(e=>{e.error=$e(t),e.loading.vote=!1}),t}}),reportReview:(s,t,a)=>d(null,null,function*(){e(e=>{e.loading.report=!0,e.error=null});try{yield((e,s,t)=>d(null,null,function*(){yield Se.post(`/reviews/${e}/report`,{reason:s,description:t})}))(s,t,a),e(e=>{var t;const a=e.reviews.find(e=>e.id===s);a&&(a.reportCount+=1),(null==(t=e.currentReview)?void 0:t.id)===s&&(e.currentReview.reportCount+=1),e.loading.report=!1})}catch(i){throw e(e=>{e.error=$e(i),e.loading.report=!1}),i}}),loadReviewStatistics:s=>d(null,null,function*(){e(e=>{e.loading.statistics=!0,e.error=null});try{const t=yield(e=>d(null,null,function*(){return(yield Se.get(`/reviews/facility/${e}/statistics`)).data}))(s);e(e=>{e.reviewStatistics=t,e.loading.statistics=!1})}catch(t){e(e=>{e.error=$e(t),e.loading.statistics=!1})}}),loadMyReviews:(s=0)=>d(null,null,function*(){e(e=>{e.loading.reviews=!0,e.error=null});try{const t=yield((e=0,s=10)=>d(null,null,function*(){return(yield Se.get(`/reviews/my?page=${e}&size=${s}`)).data}))(s,10);e(e=>{e.myReviews=t.content,e.myReviewsPagination={page:t.number,totalElements:t.totalElements,totalPages:t.totalPages},e.loading.reviews=!1})}catch(t){e(e=>{e.error=$e(t),e.loading.reviews=!1})}}),addAdminResponse:(s,t)=>d(null,null,function*(){e(e=>{e.loading.update=!0,e.error=null});try{const a=yield((e,s)=>d(null,null,function*(){return(yield Se.post(`/admin/reviews/${e}/response`,s)).data}))(s,{response:t});e(e=>{var t;const i=e.reviews.findIndex(e=>e.id===s);-1!==i&&(e.reviews[i]=a),(null==(t=e.currentReview)?void 0:t.id)===s&&(e.currentReview=a),e.loading.update=!1})}catch(a){throw e(e=>{e.error=$e(a),e.loading.update=!1}),a}}),blockReview:s=>d(null,null,function*(){try{const t=yield(e=>d(null,null,function*(){return(yield Se.post(`/admin/reviews/${e}/block`)).data}))(s);e(e=>{var a;const i=e.reviews.findIndex(e=>e.id===s);-1!==i&&(e.reviews[i]=t),(null==(a=e.currentReview)?void 0:a.id)===s&&(e.currentReview=t)})}catch(t){throw e(e=>{e.error=$e(t)}),t}}),activateReview:s=>d(null,null,function*(){try{const t=yield(e=>d(null,null,function*(){return(yield Se.post(`/admin/reviews/${e}/activate`)).data}))(s);e(e=>{var a;const i=e.reviews.findIndex(e=>e.id===s);-1!==i&&(e.reviews[i]=t),(null==(a=e.currentReview)?void 0:a.id)===s&&(e.currentReview=t)})}catch(t){throw e(e=>{e.error=$e(t)}),t}}),setReviewVerified:(s,t)=>d(null,null,function*(){try{const a=yield((e,s)=>d(null,null,function*(){return(yield Se.patch(`/admin/reviews/${e}/verified`,{verified:s})).data}))(s,t);e(e=>{var t;const i=e.reviews.findIndex(e=>e.id===s);-1!==i&&(e.reviews[i]=a),(null==(t=e.currentReview)?void 0:t.id)===s&&(e.currentReview=a)})}catch(a){throw e(e=>{e.error=$e(a)}),a}}),setSelectedFacility:s=>{e(e=>{e.selectedFacilityId=s})},clearCurrentReview:()=>{e(e=>{e.currentReview=null})},clearError:()=>{e(e=>{e.error=null})},resetStore:()=>{e(e=>{Object.assign(e,Re)})},goToPage:e=>d(null,null,function*(){const{selectedFacilityId:t,currentFilter:a,currentSort:i}=s();t&&(Object.keys(a).length>0?yield s().loadFilteredReviews(t,a,i,e):yield s().loadReviews(t,e))}),goToNextPage:()=>d(null,null,function*(){const{pagination:e}=s();e.hasNext&&(yield s().goToPage(e.page+1))}),goToPreviousPage:()=>d(null,null,function*(){const{pagination:e}=s();e.hasPrevious&&(yield s().goToPage(e.page-1))})}))),Ee={searchResults:[],recommendations:[],selectedFacility:null,searchFilters:{},matchingPreference:{preferredRegions:new Set(["서울특별시","경기도"]),preferredFacilityTypes:new Set(["요양원","요양병원"]),maxMonthlyFee:3e6,minFacilityGrade:"C",requiredSpecialties:new Set,maxDistanceKm:null,prioritizeAvailability:!0,prioritizeCost:!1,prioritizeQuality:!0},userHistory:[],isSearching:!1,isLoadingRecommendations:!1,isLoadingHistory:!1,searchError:null,recommendationError:null,isDetailModalOpen:!1,isRecommendationModalOpen:!1,isMatchingFormOpen:!1},Te={searchFacilities(e){return d(this,null,function*(){const s=new URLSearchParams;e.facilityType&&s.append("facilityType",e.facilityType),e.facilityGrade&&s.append("facilityGrade",e.facilityGrade),e.region&&s.append("region",e.region),e.careGradeLevel&&s.append("careGradeLevel",e.careGradeLevel.toString());const t=yield fetch(`/api/facilities?${s.toString()}`,{headers:{Authorization:`Bearer ${localStorage.getItem("accessToken")}`}});if(!t.ok)throw new Error(`시설 검색 실패: ${t.statusText}`);return(yield t.json()).content||[]})},getRecommendations(e,s,t){return d(this,null,function*(){const a={memberId:e.toString(),coordinatorId:t,preference:{preferredRegions:Array.from(s.preferredRegions),preferredFacilityTypes:Array.from(s.preferredFacilityTypes),maxMonthlyFee:s.maxMonthlyFee,minFacilityGrade:s.minFacilityGrade,requiredSpecialties:Array.from(s.requiredSpecialties),maxDistanceKm:s.maxDistanceKm,prioritizeAvailability:s.prioritizeAvailability,prioritizeCost:s.prioritizeCost,prioritizeQuality:s.prioritizeQuality},maxResults:10},i=yield fetch("/api/facilities/recommendations",{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${localStorage.getItem("accessToken")}`},body:JSON.stringify(a)});if(!i.ok){if(400===i.status)throw yield i.json().catch(()=>({})),new Error(`추천 시설 조회 실패: 건강 평가 데이터가 없거나 요청 데이터가 잘못되었습니다. (${i.status})`);throw new Error(`추천 시설 조회 실패: ${i.statusText} (${i.status})`)}return i.json()})},trackFacilityAction(e,s){return d(this,null,function*(){const t=yield fetch(`/api/facilities/${e}/${s}`,{method:"POST",headers:{Authorization:`Bearer ${localStorage.getItem("accessToken")}`}});if(!t.ok)throw new Error(`시설 ${s} 추적 실패: ${t.statusText}`)})},completeMatching(e,s,t,a){return d(this,null,function*(){const i={outcome:s,satisfactionScore:t,feedback:a},l=yield fetch(`/api/facilities/${e}/complete-matching`,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${localStorage.getItem("accessToken")}`},body:JSON.stringify(i)});if(!l.ok)throw new Error(`매칭 완료 처리 실패: ${l.statusText}`)})},getUserHistory(){return d(this,null,function*(){const e=yield fetch("/api/facilities/matching-history",{headers:{Authorization:`Bearer ${localStorage.getItem("accessToken")}`}});if(!e.ok)throw new Error(`매칭 이력 조회 실패: ${e.statusText}`);return e.json()})}},Me=m()(oe(de(ce((e,s)=>c(n({},Ee),{searchFacilities:s=>d(null,null,function*(){e(e=>{e.isSearching=!0,e.searchError=null});try{const t=yield Te.searchFacilities(s);e(e=>{e.searchResults=t,e.searchFilters=s,e.isSearching=!1})}catch(t){e(e=>{e.searchError=t instanceof Error?t.message:"시설 검색 중 오류가 발생했습니다.",e.isSearching=!1})}}),updateSearchFilters:s=>{e(e=>{Object.assign(e.searchFilters,s)})},clearSearchResults:()=>{e(e=>{e.searchResults=[],e.searchFilters={},e.searchError=null})},getRecommendations:(t,a)=>d(null,null,function*(){e(e=>{e.isLoadingRecommendations=!0,e.recommendationError=null});try{const i=yield Te.getRecommendations(t,s().matchingPreference,a);e(e=>{e.recommendations=i,e.isLoadingRecommendations=!1})}catch(i){e(e=>{e.recommendationError=i instanceof Error?i.message:"시설 추천 중 오류가 발생했습니다.",e.isLoadingRecommendations=!1})}}),updateMatchingPreference:s=>{e(e=>{Object.assign(e.matchingPreference,s)})},clearRecommendations:()=>{e(e=>{e.recommendations=[],e.recommendationError=null})},selectFacility:s=>{e(e=>{e.selectedFacility=s})},clearSelectedFacility:()=>{e(e=>{e.selectedFacility=null})},trackFacilityView:e=>d(null,null,function*(){}),trackFacilityContact:e=>d(null,null,function*(){try{yield Te.trackFacilityAction(e,"contact"),s().loadUserHistory()}catch(t){}}),trackFacilityVisit:e=>d(null,null,function*(){try{yield Te.trackFacilityAction(e,"visit"),s().loadUserHistory()}catch(t){}}),completeMatching:(e,t,a,i)=>d(null,null,function*(){try{yield Te.completeMatching(e,t,a,i),s().loadUserHistory()}catch(l){throw l}}),loadUserHistory:()=>d(null,null,function*(){e(e=>{e.isLoadingHistory=!0});try{const s=yield Te.getUserHistory();e(e=>{e.userHistory=s,e.isLoadingHistory=!1})}catch(s){e(e=>{e.isLoadingHistory=!1})}}),clearUserHistory:()=>{e(e=>{e.userHistory=[]})},openDetailModal:()=>{e(e=>{e.isDetailModalOpen=!0})},closeDetailModal:()=>{e(e=>{e.isDetailModalOpen=!1})},openRecommendationModal:()=>{e(e=>{e.isRecommendationModalOpen=!0})},closeRecommendationModal:()=>{e(e=>{e.isRecommendationModalOpen=!1})},openMatchingForm:()=>{e(e=>{e.isMatchingFormOpen=!0})},closeMatchingForm:()=>{e(e=>{e.isMatchingFormOpen=!1})},setSearchError:s=>{e(e=>{e.searchError=s})},setRecommendationError:s=>{e(e=>{e.recommendationError=s})},clearAllErrors:()=>{e(e=>{e.searchError=null,e.recommendationError=null})},resetFacilityState:()=>{e(()=>n({},Ee))}}))),{name:"FacilityStore"})),Pe=new WeakMap,Ae=({facility:e,viewMode:s="list",onSelect:t,showActions:a=!0,isRecommendation:i=!1,matchScore:l,recommendationReason:r})=>{const[n,c]=x.useState(null),{selectFacility:o,openDetailModal:m,trackFacilityContact:v,trackFacilityVisit:w}=Me(),b=()=>{o(e),m(),null==t||t(e)},N=s=>d(null,null,function*(){s.stopPropagation(),c("contact");try{yield v(e.id),window.open(`tel:${e.phoneNumber}`)}catch(t){}finally{c(null)}}),k=s=>d(null,null,function*(){s.stopPropagation(),c("visit");try{yield w(e.id),alert("방문 예약이 접수되었습니다. 시설에서 연락드리겠습니다.")}catch(t){}finally{c(null)}}),C=e=>{switch(e){case"A":return"text-green-600 bg-green-100";case"B":return"text-blue-600 bg-blue-100";case"C":return"text-yellow-600 bg-yellow-100";case"D":return"text-orange-600 bg-orange-100";case"E":return"text-red-600 bg-red-100";default:return"text-gray-600 bg-gray-100"}},S=e.totalCapacity-e.currentOccupancy,$=e.currentOccupancy/e.totalCapacity*100,R=e=>e?`${(e/1e4).toFixed(0)}만원`:"문의";return"grid"===s?h.jsx(ve.div,{whileHover:{y:-4},transition:{duration:.2},children:h.jsxs(me,{className:"h-full cursor-pointer hover:shadow-lg transition-shadow duration-200",onClick:b,children:[i&&l&&h.jsx("div",{className:"absolute top-4 right-4 z-10",children:h.jsxs("div",{className:"bg-purple-100 text-purple-800 px-2 py-1 rounded-full text-xs font-medium flex items-center",children:[h.jsx(u,{className:"w-3 h-3 mr-1"}),Math.round(l),"% 매칭"]})}),h.jsxs("div",{className:"relative h-48 bg-gray-200 rounded-t-lg overflow-hidden",children:[e.imageUrl?h.jsx("img",{src:e.imageUrl,alt:e.facilityName,className:"w-full h-full object-cover"}):h.jsx("div",{className:"w-full h-full flex items-center justify-center",children:h.jsx(g,{className:"w-12 h-12 text-gray-400"})}),h.jsx("div",{className:"absolute top-3 left-3",children:h.jsxs("span",{className:`px-2 py-1 rounded-full text-xs font-medium ${C(e.facilityGrade)}`,children:[e.facilityGrade,"등급"]})})]}),h.jsxs(xe,{className:"p-4",children:[h.jsxs("div",{className:"mb-3",children:[h.jsx("h3",{className:"font-semibold text-lg text-gray-900 mb-1 line-clamp-1",children:e.facilityName}),h.jsx("p",{className:"text-sm text-gray-600 mb-2",children:e.facilityType}),h.jsxs("div",{className:"flex items-center text-sm text-gray-500 mb-2",children:[h.jsx(p,{className:"w-4 h-4 mr-1"}),h.jsx("span",{className:"line-clamp-1",children:e.address})]})]}),h.jsxs("div",{className:"mb-3",children:[h.jsxs("div",{className:"flex justify-between items-center text-sm mb-1",children:[h.jsx("span",{className:"text-gray-600",children:"입소 현황"}),h.jsx("span",{className:"font-medium "+(S>0?"text-green-600":"text-red-600"),children:S>0?`${S}명 입소 가능`:"입소 대기"})]}),h.jsx("div",{className:"w-full bg-gray-200 rounded-full h-2",children:h.jsx("div",{className:"h-2 rounded-full "+($>=90?"bg-red-500":$>=70?"bg-yellow-500":"bg-green-500"),style:{width:`${Math.min($,100)}%`}})})]}),h.jsx("div",{className:"mb-4",children:h.jsxs("div",{className:"flex items-center justify-between",children:[h.jsx("span",{className:"text-sm text-gray-600",children:"월 기본료"}),h.jsx("span",{className:"font-semibold text-lg text-gray-900",children:R(e.monthlyBasicFee)})]})}),e.specialties&&e.specialties.length>0&&h.jsx("div",{className:"mb-4",children:h.jsxs("div",{className:"flex flex-wrap gap-1",children:[e.specialties.slice(0,2).map(e=>h.jsx("span",{className:"px-2 py-1 bg-blue-50 text-blue-700 text-xs rounded-full",children:e},e)),e.specialties.length>2&&h.jsxs("span",{className:"px-2 py-1 bg-gray-50 text-gray-600 text-xs rounded-full",children:["+",e.specialties.length-2]})]})}),i&&r&&h.jsx("div",{className:"mb-4 p-2 bg-purple-50 rounded-lg",children:h.jsxs("p",{className:"text-xs text-purple-700 line-clamp-2",children:["💡 ",r]})}),a&&h.jsxs("div",{className:"flex space-x-2",children:[h.jsx(he,{variant:"outline",size:"sm",onClick:N,disabled:"contact"===n,className:"flex-1",children:"contact"===n?h.jsx(ve.div,{animate:{rotate:360},transition:{duration:1,repeat:1/0,ease:"linear"},children:h.jsx(y,{className:"w-4 h-4"})}):h.jsx(y,{className:"w-4 h-4"})}),h.jsx(he,{size:"sm",onClick:k,disabled:"visit"===n,className:"flex-1",children:"visit"===n?h.jsx(ve.div,{animate:{rotate:360},transition:{duration:1,repeat:1/0,ease:"linear"},children:h.jsx(f,{className:"w-4 h-4"})}):h.jsxs(h.Fragment,{children:[h.jsx(f,{className:"w-4 h-4 mr-1"}),"방문"]})})]})]})]})}):h.jsx(ve.div,{whileHover:{x:4},transition:{duration:.2},children:h.jsx(me,{className:"cursor-pointer hover:shadow-md transition-shadow duration-200",onClick:b,children:h.jsx(xe,{className:"p-6",children:h.jsxs("div",{className:"flex items-start space-x-4",children:[h.jsx("div",{className:"relative w-24 h-24 bg-gray-200 rounded-lg overflow-hidden flex-shrink-0",children:e.imageUrl?h.jsx("img",{src:e.imageUrl,alt:e.facilityName,className:"w-full h-full object-cover"}):h.jsx("div",{className:"w-full h-full flex items-center justify-center",children:h.jsx(g,{className:"w-8 h-8 text-gray-400"})})}),h.jsxs("div",{className:"flex-1 min-w-0",children:[h.jsx("div",{className:"flex items-start justify-between mb-2",children:h.jsxs("div",{children:[h.jsx("h3",{className:"font-semibold text-xl text-gray-900 mb-1",children:e.facilityName}),h.jsxs("div",{className:"flex items-center space-x-2 mb-2",children:[h.jsx("span",{className:"text-gray-600",children:e.facilityType}),h.jsxs("span",{className:`px-2 py-1 rounded-full text-xs font-medium ${C(e.facilityGrade)}`,children:[e.facilityGrade,"등급"]}),i&&l&&h.jsxs("span",{className:"bg-purple-100 text-purple-800 px-2 py-1 rounded-full text-xs font-medium flex items-center",children:[h.jsx(u,{className:"w-3 h-3 mr-1"}),Math.round(l),"% 매칭"]})]})]})}),h.jsxs("div",{className:"flex items-center text-sm text-gray-500 mb-3",children:[h.jsx(p,{className:"w-4 h-4 mr-1"}),h.jsx("span",{children:e.address})]}),h.jsxs("div",{className:"grid grid-cols-2 gap-4 mb-3",children:[h.jsxs("div",{children:[h.jsxs("div",{className:"flex justify-between items-center text-sm mb-1",children:[h.jsx("span",{className:"text-gray-600",children:"입소 현황"}),h.jsx("span",{className:"font-medium "+(S>0?"text-green-600":"text-red-600"),children:S>0?`${S}명 가능`:"대기"})]}),h.jsx("div",{className:"w-full bg-gray-200 rounded-full h-2",children:h.jsx("div",{className:"h-2 rounded-full "+($>=90?"bg-red-500":$>=70?"bg-yellow-500":"bg-green-500"),style:{width:`${Math.min($,100)}%`}})})]}),h.jsxs("div",{className:"text-right",children:[h.jsx("div",{className:"text-sm text-gray-600 mb-1",children:"월 기본료"}),h.jsx("div",{className:"font-semibold text-lg text-gray-900",children:R(e.monthlyBasicFee)})]})]}),e.specialties&&e.specialties.length>0&&h.jsx("div",{className:"mb-3",children:h.jsxs("div",{className:"flex flex-wrap gap-1",children:[e.specialties.slice(0,4).map(e=>h.jsx("span",{className:"px-2 py-1 bg-blue-50 text-blue-700 text-xs rounded-full",children:e},e)),e.specialties.length>4&&h.jsxs("span",{className:"px-2 py-1 bg-gray-50 text-gray-600 text-xs rounded-full",children:["+",e.specialties.length-4,"개 더"]})]})}),i&&r&&h.jsx("div",{className:"mb-3 p-3 bg-purple-50 rounded-lg",children:h.jsxs("p",{className:"text-sm text-purple-700",children:["💡 ",r]})}),a&&h.jsxs("div",{className:"flex space-x-2 pt-2",children:[h.jsx(he,{variant:"outline",size:"sm",onClick:N,disabled:"contact"===n,children:"contact"===n?h.jsx(ve.div,{animate:{rotate:360},transition:{duration:1,repeat:1/0,ease:"linear"},children:h.jsx(y,{className:"w-4 h-4"})}):h.jsxs(h.Fragment,{children:[h.jsx(y,{className:"w-4 h-4 mr-1"}),"연락하기"]})}),h.jsx(he,{size:"sm",onClick:k,disabled:"visit"===n,children:"visit"===n?h.jsx(ve.div,{animate:{rotate:360},transition:{duration:1,repeat:1/0,ease:"linear"},children:h.jsx(f,{className:"w-4 h-4"})}):h.jsxs(h.Fragment,{children:[h.jsx(f,{className:"w-4 h-4 mr-1"}),"방문 예약"]})}),h.jsxs(he,{variant:"outline",size:"sm",onClick:e=>{e.stopPropagation(),b()},children:[h.jsx(j,{className:"w-4 h-4 mr-1"}),"상세보기"]})]})]})]})})})})},Le=({facilities:e,viewMode:s="list",isLoading:t=!1,emptyMessage:a="시설이 없습니다.",onFacilitySelect:i,showActions:l=!0})=>{const r=()=>h.jsx("div",{className:"space-y-4",children:Array.from({length:3}).map((e,s)=>h.jsx(me,{className:"animate-pulse",children:h.jsx(xe,{className:"p-6",children:h.jsxs("div",{className:"flex items-start space-x-4",children:[h.jsx("div",{className:"w-24 h-24 bg-gray-200 rounded-lg flex-shrink-0"}),h.jsxs("div",{className:"flex-1 space-y-3",children:[h.jsx("div",{className:"h-6 bg-gray-200 rounded w-2/3"}),h.jsx("div",{className:"h-4 bg-gray-200 rounded w-1/2"}),h.jsxs("div",{className:"space-y-2",children:[h.jsx("div",{className:"h-3 bg-gray-200 rounded w-full"}),h.jsx("div",{className:"h-3 bg-gray-200 rounded w-3/4"})]}),h.jsxs("div",{className:"flex space-x-2 pt-2",children:[h.jsx("div",{className:"h-8 bg-gray-200 rounded w-20"}),h.jsx("div",{className:"h-8 bg-gray-200 rounded w-20"})]})]}),h.jsxs("div",{className:"text-right space-y-2",children:[h.jsx("div",{className:"h-4 bg-gray-200 rounded w-16"}),h.jsx("div",{className:"h-6 bg-gray-200 rounded w-20"}),h.jsx("div",{className:"h-4 bg-gray-200 rounded w-12"})]})]})})},s))}),n=()=>h.jsx(ve.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.3},className:"text-center py-12",children:h.jsx(me,{children:h.jsx(xe,{className:"p-12",children:h.jsxs("div",{className:"flex flex-col items-center space-y-4",children:[h.jsx("div",{className:"w-16 h-16 bg-gray-100 rounded-full flex items-center justify-center",children:h.jsx(w,{className:"w-8 h-8 text-gray-400"})}),h.jsxs("div",{className:"text-center",children:[h.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"검색 결과가 없습니다"}),h.jsx("p",{className:"text-gray-500 max-w-md",children:a})]}),h.jsx("div",{className:"text-sm text-gray-400 mt-4",children:h.jsx("p",{children:"검색 조건을 변경하거나 필터를 조정해보세요."})})]})})})});return t?h.jsxs("div",{className:"space-y-4",children:[h.jsx("div",{className:"flex items-center justify-center py-8",children:h.jsxs("div",{className:"flex items-center space-x-2 text-gray-500",children:[h.jsx(v,{className:"w-5 h-5 animate-spin"}),h.jsx("span",{children:"시설을 검색하고 있습니다..."})]})}),h.jsx(r,{})]}):0===e.length?h.jsx(n,{}):"grid"===s?h.jsx(ve.div,{initial:{opacity:0},animate:{opacity:1},transition:{duration:.3},className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:h.jsx(we,{children:e.map((e,s)=>h.jsx(ve.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},exit:{opacity:0,y:-20},transition:{duration:.3,delay:.05*s},children:h.jsx(Ae,{facility:e,viewMode:"grid",onSelect:i,showActions:l})},e.id))})}):h.jsx(ve.div,{initial:{opacity:0},animate:{opacity:1},transition:{duration:.3},className:"space-y-4",children:h.jsx(we,{children:e.map((e,s)=>h.jsx(ve.div,{initial:{opacity:0,x:-20},animate:{opacity:1,x:0},exit:{opacity:0,x:20},transition:{duration:.3,delay:.05*s},children:h.jsx(Ae,{facility:e,viewMode:"list",onSelect:i,showActions:l})},e.id))})})},ze=[{value:"요양시설",label:"노인요양시설",description:"24시간 케어 서비스"},{value:"요양병원",label:"요양병원",description:"의료진 상주 치료"},{value:"양로시설",label:"양로시설",description:"독립생활 지원"},{value:"치매전문시설",label:"치매전문시설",description:"치매 특화 케어"},{value:"재활전문시설",label:"재활전문시설",description:"재활치료 중심"},{value:"단기보호시설",label:"단기보호시설",description:"임시 보호 서비스"}],Ie=[{value:"A",label:"A등급",description:"최우수 (90점 이상)",color:"text-green-600"},{value:"B",label:"B등급",description:"우수 (80-89점)",color:"text-blue-600"},{value:"C",label:"C등급",description:"양호 (70-79점)",color:"text-yellow-600"},{value:"D",label:"D등급",description:"보통 (60-69점)",color:"text-orange-600"},{value:"E",label:"E등급",description:"미흡 (60점 미만)",color:"text-red-600"}],Oe=[{value:1,label:"1등급",description:"최중증 (95점 이상)"},{value:2,label:"2등급",description:"중증 (75-94점)"},{value:3,label:"3등급",description:"중등도 (60-74점)"},{value:4,label:"4등급",description:"경증 (51-59점)"},{value:5,label:"5등급",description:"경증 (45-50점)"}],Be=["서울특별시","부산광역시","대구광역시","인천광역시","광주광역시","대전광역시","울산광역시","세종특별자치시","경기도","강원도","충청북도","충청남도","전라북도","전라남도","경상북도","경상남도","제주특별자치도"],_e=[{value:1e6,label:"100만원 이하"},{value:15e5,label:"150만원 이하"},{value:2e6,label:"200만원 이하"},{value:25e5,label:"250만원 이하"},{value:3e6,label:"300만원 이하"},{value:5e6,label:"500만원 이하"}],He=["치매케어","재활치료","물리치료","작업치료","언어치료","인지치료","호스피스케어","의료케어","영양관리","심리상담"],De=({filters:e,onFiltersChange:s,onClear:t})=>{const[a,i]=x.useState(new Set(["type","grade"])),l=e=>{const s=new Set(a);s.has(e)?s.delete(e):s.add(e),i(s)},r=(e,t)=>{s({[e]:t})},n=Object.values(e).filter(e=>null!=e&&""!==e).length;return h.jsxs("div",{className:"space-y-6",children:[h.jsxs("div",{className:"flex justify-between items-center",children:[h.jsxs("h3",{className:"text-lg font-medium text-gray-900",children:["상세 필터",n>0&&h.jsxs("span",{className:"ml-2 bg-blue-100 text-blue-800 text-sm px-2 py-1 rounded-full",children:[n,"개 적용됨"]})]}),n>0&&h.jsxs(he,{variant:"outline",size:"sm",onClick:()=>{s({facilityType:void 0,facilityGrade:void 0,region:void 0,careGradeLevel:void 0,maxMonthlyFee:void 0,minFacilityGrade:void 0,specialties:void 0,maxDistanceKm:void 0,hasAvailableSlots:void 0}),null==t||t()},className:"text-gray-500 hover:text-gray-700",children:[h.jsx(b,{className:"w-4 h-4 mr-1"}),"전체 초기화"]})]}),h.jsxs("div",{className:"border border-gray-200 rounded-lg",children:[h.jsxs("button",{onClick:()=>l("type"),className:"w-full px-4 py-3 text-left flex justify-between items-center hover:bg-gray-50",children:[h.jsxs("div",{className:"flex items-center",children:[h.jsx(g,{className:"w-5 h-5 text-gray-400 mr-2"}),h.jsx("span",{className:"font-medium",children:"시설 타입"})]}),h.jsx(ve.div,{animate:{rotate:a.has("type")?180:0},transition:{duration:.2},children:h.jsx("svg",{className:"w-5 h-5 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:h.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})})]}),a.has("type")&&h.jsx(ve.div,{initial:{height:0},animate:{height:"auto"},className:"px-4 pb-4 border-t border-gray-100",children:h.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3 mt-3",children:ze.map(s=>h.jsxs("label",{className:"flex items-start space-x-3 cursor-pointer",children:[h.jsx("input",{type:"radio",name:"facilityType",value:s.value,checked:e.facilityType===s.value,onChange:e=>r("facilityType",e.target.value),className:"mt-1 h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300"}),h.jsxs("div",{children:[h.jsx("div",{className:"text-sm font-medium text-gray-900",children:s.label}),h.jsx("div",{className:"text-xs text-gray-500",children:s.description})]})]},s.value))})})]}),h.jsxs("div",{className:"border border-gray-200 rounded-lg",children:[h.jsxs("button",{onClick:()=>l("grade"),className:"w-full px-4 py-3 text-left flex justify-between items-center hover:bg-gray-50",children:[h.jsxs("div",{className:"flex items-center",children:[h.jsx(u,{className:"w-5 h-5 text-gray-400 mr-2"}),h.jsx("span",{className:"font-medium",children:"시설 등급"})]}),h.jsx(ve.div,{animate:{rotate:a.has("grade")?180:0},transition:{duration:.2},children:h.jsx("svg",{className:"w-5 h-5 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:h.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})})]}),a.has("grade")&&h.jsx(ve.div,{initial:{height:0},animate:{height:"auto"},className:"px-4 pb-4 border-t border-gray-100",children:h.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3 mt-3",children:Ie.map(s=>h.jsxs("label",{className:"flex items-start space-x-3 cursor-pointer",children:[h.jsx("input",{type:"radio",name:"facilityGrade",value:s.value,checked:e.facilityGrade===s.value,onChange:e=>r("facilityGrade",e.target.value),className:"mt-1 h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300"}),h.jsxs("div",{children:[h.jsx("div",{className:`text-sm font-medium ${s.color}`,children:s.label}),h.jsx("div",{className:"text-xs text-gray-500",children:s.description})]})]},s.value))})})]}),h.jsxs("div",{className:"border border-gray-200 rounded-lg",children:[h.jsxs("button",{onClick:()=>l("region"),className:"w-full px-4 py-3 text-left flex justify-between items-center hover:bg-gray-50",children:[h.jsxs("div",{className:"flex items-center",children:[h.jsx(p,{className:"w-5 h-5 text-gray-400 mr-2"}),h.jsx("span",{className:"font-medium",children:"지역"})]}),h.jsx(ve.div,{animate:{rotate:a.has("region")?180:0},transition:{duration:.2},children:h.jsx("svg",{className:"w-5 h-5 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:h.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})})]}),a.has("region")&&h.jsx(ve.div,{initial:{height:0},animate:{height:"auto"},className:"px-4 pb-4 border-t border-gray-100",children:h.jsxs("select",{value:e.region||"",onChange:e=>r("region",e.target.value||void 0),className:"mt-3 w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-blue-500 focus:border-blue-500",children:[h.jsx("option",{value:"",children:"전체 지역"}),Be.map(e=>h.jsx("option",{value:e,children:e},e))]})})]}),h.jsxs("div",{className:"border border-gray-200 rounded-lg",children:[h.jsxs("button",{onClick:()=>l("care"),className:"w-full px-4 py-3 text-left flex justify-between items-center hover:bg-gray-50",children:[h.jsxs("div",{className:"flex items-center",children:[h.jsx(N,{className:"w-5 h-5 text-gray-400 mr-2"}),h.jsx("span",{className:"font-medium",children:"케어 등급"})]}),h.jsx(ve.div,{animate:{rotate:a.has("care")?180:0},transition:{duration:.2},children:h.jsx("svg",{className:"w-5 h-5 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:h.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})})]}),a.has("care")&&h.jsx(ve.div,{initial:{height:0},animate:{height:"auto"},className:"px-4 pb-4 border-t border-gray-100",children:h.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3 mt-3",children:Oe.map(s=>h.jsxs("label",{className:"flex items-start space-x-3 cursor-pointer",children:[h.jsx("input",{type:"radio",name:"careGradeLevel",value:s.value,checked:e.careGradeLevel===s.value,onChange:e=>r("careGradeLevel",parseInt(e.target.value)),className:"mt-1 h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300"}),h.jsxs("div",{children:[h.jsx("div",{className:"text-sm font-medium text-gray-900",children:s.label}),h.jsx("div",{className:"text-xs text-gray-500",children:s.description})]})]},s.value))})})]}),h.jsxs("div",{className:"border border-gray-200 rounded-lg",children:[h.jsxs("button",{onClick:()=>l("cost"),className:"w-full px-4 py-3 text-left flex justify-between items-center hover:bg-gray-50",children:[h.jsxs("div",{className:"flex items-center",children:[h.jsx(k,{className:"w-5 h-5 text-gray-400 mr-2"}),h.jsx("span",{className:"font-medium",children:"월 비용"})]}),h.jsx(ve.div,{animate:{rotate:a.has("cost")?180:0},transition:{duration:.2},children:h.jsx("svg",{className:"w-5 h-5 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:h.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})})]}),a.has("cost")&&h.jsx(ve.div,{initial:{height:0},animate:{height:"auto"},className:"px-4 pb-4 border-t border-gray-100",children:h.jsx("div",{className:"space-y-2 mt-3",children:_e.map(s=>h.jsxs("label",{className:"flex items-center space-x-3 cursor-pointer",children:[h.jsx("input",{type:"radio",name:"maxMonthlyFee",value:s.value,checked:e.maxMonthlyFee===s.value,onChange:e=>r("maxMonthlyFee",parseInt(e.target.value)),className:"h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300"}),h.jsx("span",{className:"text-sm text-gray-900",children:s.label})]},s.value))})})]}),h.jsxs("div",{className:"border border-gray-200 rounded-lg",children:[h.jsxs("button",{onClick:()=>l("specialties"),className:"w-full px-4 py-3 text-left flex justify-between items-center hover:bg-gray-50",children:[h.jsxs("div",{className:"flex items-center",children:[h.jsx(u,{className:"w-5 h-5 text-gray-400 mr-2"}),h.jsx("span",{className:"font-medium",children:"전문 서비스"})]}),h.jsx(ve.div,{animate:{rotate:a.has("specialties")?180:0},transition:{duration:.2},children:h.jsx("svg",{className:"w-5 h-5 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:h.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})})]}),a.has("specialties")&&h.jsx(ve.div,{initial:{height:0},animate:{height:"auto"},className:"px-4 pb-4 border-t border-gray-100",children:h.jsx("div",{className:"flex flex-wrap gap-2 mt-3",children:He.map(s=>h.jsx("button",{onClick:()=>{const t=e.specialties||[],a=t.includes(s)?t.filter(e=>e!==s):[...t,s];r("specialties",a.length>0?a:void 0)},className:"px-3 py-1 text-sm rounded-full border transition-colors "+((e.specialties||[]).includes(s)?"bg-blue-100 border-blue-300 text-blue-800":"bg-gray-100 border-gray-300 text-gray-700 hover:bg-gray-200"),children:s},s))})})]}),h.jsx("div",{className:"border border-gray-200 rounded-lg",children:h.jsxs("div",{className:"px-4 py-3",children:[h.jsx("h4",{className:"font-medium text-gray-900 mb-3",children:"기타 옵션"}),h.jsx("div",{className:"space-y-3",children:h.jsxs("label",{className:"flex items-center space-x-3 cursor-pointer",children:[h.jsx("input",{type:"checkbox",checked:e.hasAvailableSlots||!1,onChange:e=>r("hasAvailableSlots",!!e.target.checked||void 0),className:"h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300 rounded"}),h.jsx("span",{className:"text-sm text-gray-900",children:"입소 가능한 시설만 보기"})]})})]})})]})},Ge=({recommendations:e,isLoading:s=!1,onRefresh:t,memberId:a,showPreferences:i=!0})=>{const{matchingPreference:l,updateMatchingPreference:r}=Me(),[n,c]=x.useState(!1),[o,d]=x.useState(!1),m={averageScore:e.length>0?Math.round(e.reduce((e,s)=>e+s.matchScore,0)/e.length):0,highScoreCount:e.filter(e=>e.matchScore>=80).length,mediumScoreCount:e.filter(e=>e.matchScore>=60&&e.matchScore<80).length,lowScoreCount:e.filter(e=>e.matchScore<60).length},u=(()=>{const e=[];return m.averageScore>=80?e.push({type:"success",icon:P,title:"우수한 매칭 결과",description:"회원님의 요구사항에 잘 맞는 시설들이 많이 찾아졌습니다."}):m.averageScore>=60?e.push({type:"warning",icon:A,title:"양호한 매칭 결과",description:"일부 조건을 조정하면 더 적합한 시설을 찾을 수 있습니다."}):e.push({type:"info",icon:L,title:"매칭 조건 검토 필요",description:"선호 조건을 조정하여 더 나은 추천 결과를 받아보세요."}),0===m.highScoreCount&&e.push({type:"tip",icon:M,title:"추천 팁",description:"지역 범위를 넓히거나 비용 조건을 조정해보세요."}),e})(),g=(e,s)=>{r({[e]:s})};return s?h.jsxs("div",{className:"space-y-6",children:[h.jsx(me,{children:h.jsx(xe,{className:"p-6",children:h.jsxs("div",{className:"flex items-center justify-center space-x-3",children:[h.jsx(ve.div,{animate:{rotate:360},transition:{duration:2,repeat:1/0,ease:"linear"},children:h.jsx(C,{className:"w-6 h-6 text-purple-600"})}),h.jsxs("div",{children:[h.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"AI가 맞춤형 시설을 분석 중입니다"}),h.jsx("p",{className:"text-gray-600",children:"회원님의 건강 상태와 선호도를 종합적으로 분석하고 있어요..."})]})]})})}),h.jsx("div",{className:"space-y-4",children:Array.from({length:3}).map((e,s)=>h.jsx(me,{className:"animate-pulse",children:h.jsx(xe,{className:"p-6",children:h.jsxs("div",{className:"flex items-start space-x-4",children:[h.jsx("div",{className:"w-24 h-24 bg-gray-200 rounded-lg"}),h.jsxs("div",{className:"flex-1 space-y-3",children:[h.jsx("div",{className:"h-6 bg-gray-200 rounded w-2/3"}),h.jsx("div",{className:"h-4 bg-gray-200 rounded w-1/2"}),h.jsx("div",{className:"h-3 bg-gray-200 rounded w-full"}),h.jsx("div",{className:"h-3 bg-gray-200 rounded w-3/4"})]}),h.jsxs("div",{className:"text-right space-y-2",children:[h.jsx("div",{className:"h-8 bg-gray-200 rounded w-16"}),h.jsx("div",{className:"h-4 bg-gray-200 rounded w-20"})]})]})})},s))})]}):0===e.length?h.jsx("div",{className:"text-center py-12",children:h.jsx(me,{children:h.jsx(xe,{className:"p-12",children:h.jsxs("div",{className:"flex flex-col items-center space-y-4",children:[h.jsx("div",{className:"w-16 h-16 bg-purple-100 rounded-full flex items-center justify-center",children:h.jsx(S,{className:"w-8 h-8 text-purple-600"})}),h.jsxs("div",{className:"text-center",children:[h.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"추천 결과가 없습니다"}),h.jsx("p",{className:"text-gray-500 max-w-md",children:"현재 조건에 맞는 시설을 찾지 못했습니다. 선호 조건을 조정하거나 다시 시도해보세요."})]}),t&&h.jsxs(he,{onClick:t,variant:"outline",children:[h.jsx(v,{className:"w-4 h-4 mr-2"}),"다시 추천받기"]})]})})})}):h.jsxs("div",{className:"space-y-6",children:[h.jsxs(me,{children:[h.jsx(ue,{children:h.jsxs("div",{className:"flex items-center justify-between",children:[h.jsxs("div",{className:"flex items-center space-x-3",children:[h.jsx("div",{className:"w-10 h-10 bg-purple-100 rounded-full flex items-center justify-center",children:h.jsx(S,{className:"w-5 h-5 text-purple-600"})}),h.jsxs("div",{children:[h.jsx(ge,{className:"text-xl",children:"맞춤형 추천 결과"}),h.jsxs("p",{className:"text-gray-600",children:["AI가 분석한 회원님께 최적의 시설 ",e.length,"곳"]})]})]}),h.jsxs("div",{className:"flex items-center space-x-2",children:[t&&h.jsxs(he,{variant:"outline",size:"sm",onClick:t,children:[h.jsx(v,{className:"w-4 h-4 mr-1"}),"새로고침"]}),i&&h.jsxs(he,{variant:"outline",size:"sm",onClick:()=>c(!n),children:[h.jsx($,{className:"w-4 h-4 mr-1"}),"선호도 설정"]})]})]})}),h.jsxs(xe,{children:[h.jsxs("div",{className:"grid grid-cols-4 gap-4 mb-4",children:[h.jsxs("div",{className:"text-center",children:[h.jsxs("div",{className:"text-2xl font-bold text-purple-600",children:[m.averageScore,"%"]}),h.jsx("div",{className:"text-sm text-gray-600",children:"평균 매칭도"})]}),h.jsxs("div",{className:"text-center",children:[h.jsx("div",{className:"text-2xl font-bold text-green-600",children:m.highScoreCount}),h.jsx("div",{className:"text-sm text-gray-600",children:"우수 매칭 (80%+)"})]}),h.jsxs("div",{className:"text-center",children:[h.jsx("div",{className:"text-2xl font-bold text-yellow-600",children:m.mediumScoreCount}),h.jsx("div",{className:"text-sm text-gray-600",children:"양호 매칭 (60-79%)"})]}),h.jsxs("div",{className:"text-center",children:[h.jsx("div",{className:"text-2xl font-bold text-gray-600",children:m.lowScoreCount}),h.jsx("div",{className:"text-sm text-gray-600",children:"보통 매칭 (60% 미만)"})]})]}),h.jsxs("button",{onClick:()=>d(!o),className:"w-full flex items-center justify-between p-3 bg-gray-50 rounded-lg hover:bg-gray-100 transition-colors",children:[h.jsxs("div",{className:"flex items-center space-x-2",children:[h.jsx(C,{className:"w-5 h-5 text-purple-600"}),h.jsx("span",{className:"font-medium",children:"AI 추천 분석 결과"})]}),o?h.jsx(R,{className:"w-5 h-5 text-gray-400"}):h.jsx(F,{className:"w-5 h-5 text-gray-400"})]}),h.jsx(we,{children:o&&h.jsx(ve.div,{initial:{height:0,opacity:0},animate:{height:"auto",opacity:1},exit:{height:0,opacity:0},className:"overflow-hidden",children:h.jsx("div",{className:"pt-4 space-y-3",children:u.map((e,s)=>{const t=e.icon,a={success:"text-green-600 bg-green-50",warning:"text-yellow-600 bg-yellow-50",info:"text-blue-600 bg-blue-50",tip:"text-purple-600 bg-purple-50"}[e.type];return h.jsx("div",{className:`p-3 rounded-lg ${a}`,children:h.jsxs("div",{className:"flex items-start space-x-2",children:[h.jsx(t,{className:"w-5 h-5 mt-0.5"}),h.jsxs("div",{children:[h.jsx("div",{className:"font-medium",children:e.title}),h.jsx("div",{className:"text-sm opacity-90",children:e.description})]})]})},s)})})})})]})]}),h.jsx(we,{children:n&&h.jsx(ve.div,{initial:{height:0,opacity:0},animate:{height:"auto",opacity:1},exit:{height:0,opacity:0},className:"overflow-hidden",children:h.jsxs(me,{children:[h.jsx(ue,{children:h.jsxs(ge,{className:"text-lg flex items-center",children:[h.jsx($,{className:"w-5 h-5 mr-2"}),"추천 선호도 설정"]})}),h.jsxs(xe,{children:[h.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[h.jsxs("div",{className:"space-y-3",children:[h.jsx("h4",{className:"font-medium",children:"우선순위"}),h.jsxs("label",{className:"flex items-center space-x-2",children:[h.jsx("input",{type:"checkbox",checked:l.prioritizeQuality,onChange:e=>g("prioritizeQuality",e.target.checked),className:"rounded border-gray-300"}),h.jsx("span",{className:"text-sm",children:"품질 우선"})]}),h.jsxs("label",{className:"flex items-center space-x-2",children:[h.jsx("input",{type:"checkbox",checked:l.prioritizeCost,onChange:e=>g("prioritizeCost",e.target.checked),className:"rounded border-gray-300"}),h.jsx("span",{className:"text-sm",children:"비용 우선"})]}),h.jsxs("label",{className:"flex items-center space-x-2",children:[h.jsx("input",{type:"checkbox",checked:l.prioritizeAvailability,onChange:e=>g("prioritizeAvailability",e.target.checked),className:"rounded border-gray-300"}),h.jsx("span",{className:"text-sm",children:"입소 가능성 우선"})]})]}),h.jsxs("div",{className:"space-y-3",children:[h.jsx("h4",{className:"font-medium",children:"최대 월 비용"}),h.jsxs("select",{value:l.maxMonthlyFee||"",onChange:e=>g("maxMonthlyFee",e.target.value?parseInt(e.target.value):null),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-purple-500 focus:border-purple-500",children:[h.jsx("option",{value:"",children:"제한 없음"}),h.jsx("option",{value:"1500000",children:"150만원"}),h.jsx("option",{value:"2000000",children:"200만원"}),h.jsx("option",{value:"2500000",children:"250만원"}),h.jsx("option",{value:"3000000",children:"300만원"}),h.jsx("option",{value:"4000000",children:"400만원"}),h.jsx("option",{value:"5000000",children:"500만원"})]})]}),h.jsxs("div",{className:"space-y-3",children:[h.jsx("h4",{className:"font-medium",children:"최소 시설 등급"}),h.jsxs("select",{value:l.minFacilityGrade,onChange:e=>g("minFacilityGrade",e.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-purple-500 focus:border-purple-500",children:[h.jsx("option",{value:"E",children:"E등급 이상"}),h.jsx("option",{value:"D",children:"D등급 이상"}),h.jsx("option",{value:"C",children:"C등급 이상"}),h.jsx("option",{value:"B",children:"B등급 이상"}),h.jsx("option",{value:"A",children:"A등급만"})]})]})]}),h.jsx("div",{className:"mt-4 pt-4 border-t",children:h.jsxs(he,{onClick:t,className:"w-full",children:[h.jsx(E,{className:"w-4 h-4 mr-2"}),"새로운 조건으로 다시 추천받기"]})})]})]})})}),h.jsxs("div",{className:"space-y-4",children:[h.jsxs("div",{className:"flex items-center justify-between",children:[h.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"추천 시설 목록"}),h.jsxs("div",{className:"flex items-center space-x-2 text-sm text-gray-500",children:[h.jsx(T,{className:"w-4 h-4"}),h.jsx("span",{children:"매칭도 순으로 정렬됨"})]})]}),h.jsx(we,{children:e.map((e,s)=>h.jsx(ve.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},exit:{opacity:0,y:-20},transition:{duration:.3,delay:.1*s},children:h.jsxs("div",{className:"relative",children:[h.jsx("div",{className:"absolute -left-4 top-4 z-10",children:h.jsx("div",{className:"w-8 h-8 rounded-full flex items-center justify-center text-white text-sm font-bold "+(0===s?"bg-yellow-500":1===s?"bg-gray-400":2===s?"bg-amber-600":"bg-gray-300"),children:s+1})}),h.jsx(Ae,{facility:e.facility,viewMode:"list",isRecommendation:!0,matchScore:e.matchScore,recommendationReason:e.recommendationReason,showActions:!0})]})},e.facility.id))})]}),h.jsx(me,{children:h.jsx(xe,{className:"p-6",children:h.jsxs("div",{className:"flex items-start space-x-3",children:[h.jsx(M,{className:"w-5 h-5 text-yellow-500 mt-0.5"}),h.jsxs("div",{children:[h.jsx("h4",{className:"font-medium text-gray-900 mb-2",children:"추천 결과를 개선하려면?"}),h.jsxs("ul",{className:"text-sm text-gray-600 space-y-1",children:[h.jsx("li",{children:"• 선호 지역 범위를 조정해보세요"}),h.jsx("li",{children:"• 예산 조건을 다시 검토해보세요"}),h.jsx("li",{children:"• 필수 서비스 조건을 명확히 해보세요"}),h.jsx("li",{children:"• 시설 방문 후 피드백을 남겨주시면 더 정확한 추천이 가능합니다"})]})]})]})})})]})};var Ke={};const Ue=[{code:"HP8",name:"병원",icon:I,color:"text-red-600"},{code:"PM9",name:"약국",icon:I,color:"text-green-600"},{code:"MT1",name:"마트",icon:O,color:"text-blue-600"},{code:"CS2",name:"편의점",icon:O,color:"text-purple-600"},{code:"CE7",name:"카페",icon:B,color:"text-orange-600"},{code:"SW8",name:"지하철역",icon:_,color:"text-indigo-600"}],We=({facilities:e,width:s="100%",height:t="400px",level:a=3,showNearbyPlaces:i=!1,showTrafficInfo:l=!1,showControls:r=!0,enableClustering:o=!0,onLocationChange:m,onFacilityClick:u,onMapBoundsChange:g,className:y=""})=>{const f=x.useRef(null),j=x.useRef(null),v=x.useRef([]),[w,b]=x.useState(!0),[N,k]=x.useState(null),[C,S]=x.useState([]),[$,R]=x.useState(null),[F,E]=x.useState(null),[T,M]=x.useState([]),[P,A]=x.useState(null);x.useEffect(()=>{d(null,null,function*(){try{if(b(!0),k(null),!Ke.REACT_APP_KAKAO_MAP_API_KEY)throw new Error("카카오 지도 API 키가 설정되지 않았습니다.");yield new Promise((e,s)=>{if(window.kakao&&window.kakao.maps)return void e(window.kakao);const t=document.createElement("script");t.src=`//dapi.kakao.com/v2/maps/sdk.js?appkey=${Ke.REACT_APP_KAKAO_MAP_API_KEY}&libraries=services&autoload=false`,t.async=!0,t.onload=()=>{window.kakao.maps.load(()=>{e(window.kakao)})},t.onerror=()=>{s(new Error("카카오 지도 스크립트 로드 실패"))},document.head.appendChild(t)});const s=yield I(e);if(E(s),L(s.lat,s.lng),yield B(),i&&e.length>0){const s=yield O(e[0]);K(s.latitude,s.longitude)}}catch(s){k(s.message||"지도를 불러올 수 없습니다.")}finally{b(!1)}})},[e,a,i]);const L=(e,s)=>{if(!f.current)return;const t={center:new window.kakao.maps.LatLng(e,s),level:a},i=new window.kakao.maps.Map(f.current,t);if(j.current=i,r){const e=new window.kakao.maps.MapTypeControl;i.addControl(e,window.kakao.maps.ControlPosition.TOPRIGHT);const s=new window.kakao.maps.ZoomControl;i.addControl(s,window.kakao.maps.ControlPosition.RIGHT)}l&&i.addOverlayMapTypeId(window.kakao.maps.MapTypeId.TRAFFIC),g&&window.kakao.maps.event.addListener(i,"bounds_changed",()=>{const e=i.getBounds(),s=e.getNorthEast(),t=e.getSouthWest();g({ne:{lat:s.getLat(),lng:s.getLng()},sw:{lat:t.getLat(),lng:t.getLng()}})}),m&&window.kakao.maps.event.addListener(i,"center_changed",()=>{const e=i.getCenter();m(e.getLat(),e.getLng())})},I=e=>d(null,null,function*(){if(0===e.length)return{lat:37.5665,lng:126.978};if(1===e.length){const s=yield O(e[0]);return{lat:s.latitude,lng:s.longitude}}const s=yield Promise.all(e.map(e=>O(e))),t=s.reduce((e,s)=>e+s.latitude,0),a=s.reduce((e,s)=>e+s.longitude,0);return{lat:t/s.length,lng:a/s.length}}),O=e=>d(null,null,function*(){if(e.latitude&&e.longitude)return e;try{const t=yield(s=e.address,new Promise((e,t)=>{(new window.kakao.maps.services.Geocoder).addressSearch(s,(s,a)=>{if(a===window.kakao.maps.services.Status.OK){const t={lat:parseFloat(s[0].y),lng:parseFloat(s[0].x)};e(t)}else t(new Error("주소를 찾을 수 없습니다."))})}));return c(n({},e),{latitude:t.lat,longitude:t.lng})}catch(t){return c(n({},e),{latitude:37.5665,longitude:126.978})}var s}),B=()=>d(null,null,function*(){if(!j.current||0===e.length)return;const s=yield Promise.all(e.map(e=>O(e)));if(s.forEach((e,s)=>{_(j.current,e,s)}),s.length>1){const e=new window.kakao.maps.LatLngBounds;s.forEach(s=>{e.extend(new window.kakao.maps.LatLng(s.latitude,s.longitude))}),j.current.setBounds(e)}}),_=(e,s,t)=>{const a=new window.kakao.maps.LatLng(s.latitude,s.longitude),i=H(s),l=s.isRecommended?{width:36,height:45}:{width:28,height:35},r="data:image/svg+xml;base64,"+btoa(`\n      <svg width="${l.width}" height="${l.height}" viewBox="0 0 ${l.width} ${l.height}" xmlns="http://www.w3.org/2000/svg">\n        <path d="M${l.width/2} 0C${.225*l.width} 0 0 ${.225*l.width} 0 ${.5*l.width}c0 ${.5*l.width} ${l.width/2} ${.6*l.height} ${l.width/2} ${.6*l.height}s${l.width/2}-${.1*l.height} ${l.width/2}-${.6*l.height}C${l.width} ${.225*l.width} ${.775*l.width} 0 ${l.width/2} 0z" fill="${i}"/>\n        <circle cx="${l.width/2}" cy="${.5*l.width}" r="${.25*l.width}" fill="white"/>\n        ${s.isRecommended?`<path d="M${l.width/2} ${.3*l.width}l${.06*l.width} ${.12*l.width}h${.13*l.width}l-${.105*l.width} ${.075*l.width}l${.04*l.width} ${.12*l.width}l-${.105*l.width}-${.075*l.width}l-${.105*l.width} ${.075*l.width}l${.04*l.width}-${.12*l.width}l-${.105*l.width}-${.075*l.width}h${.13*l.width}z" fill="${i}"/>`:""}\n      </svg>\n    `),n=new window.kakao.maps.Size(l.width,l.height),c={offset:new window.kakao.maps.Point(l.width/2,l.height)},o=new window.kakao.maps.MarkerImage(r,n,c),d=new window.kakao.maps.Marker({position:a,image:o});d.setMap(e),v.current.push(d);const m=D(s),x=new window.kakao.maps.InfoWindow({content:m});window.kakao.maps.event.addListener(d,"click",()=>{v.current.forEach((e,s)=>{window.infoWindows&&window.infoWindows[s]&&window.infoWindows[s].close()}),x.open(e,d),A(s),u&&u(s)}),window.infoWindows||(window.infoWindows=[]),window.infoWindows[t]=x},H=e=>{if(e.isRecommended)return"#FF6B6B";if(!e.availableBeds||0===e.availableBeds)return"#9CA3AF";switch(e.grade){case"A":case"A등급":return"#10B981";case"B":case"B등급":return"#3B82F6";case"C":case"C등급":return"#F59E0B";default:return"#6366F1"}},D=e=>`\n      <div style="padding: 15px; font-size: 14px; max-width: 280px; font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;">\n        <div style="display: flex; align-items: center; margin-bottom: 8px;">\n          <div style="font-weight: bold; font-size: 16px; color: #1f2937; flex: 1;">${e.name}</div>\n          ${e.isRecommended?'<span style="background: #ef4444; color: white; padding: 2px 6px; border-radius: 4px; font-size: 11px; margin-left: 8px;">추천</span>':""}\n        </div>\n        \n        <div style="color: #6b7280; margin-bottom: 4px; font-size: 13px;">${e.address}</div>\n        \n        <div style="display: flex; gap: 12px; margin: 8px 0; align-items: center;">\n          ${e.grade?`<span style="background: ${G(e.grade)}; color: white; padding: 2px 8px; border-radius: 12px; font-size: 12px;">${e.grade}</span>`:""}\n          ${e.rating?`<span style="color: #f59e0b;">★ ${e.rating.toFixed(1)}</span>`:""}\n          ${void 0!==e.availableBeds?`<span style="color: ${e.availableBeds>0?"#10b981":"#ef4444"}; font-size: 12px;">\n            ${e.availableBeds>0?`입소가능 ${e.availableBeds}개`:"대기필요"}\n          </span>`:""}\n        </div>\n        \n        ${e.facilityType?`<div style="color: #6b7280; font-size: 12px; margin-bottom: 4px;">${e.facilityType}</div>`:""}\n        ${e.phone?`<div style="color: #3b82f6; font-size: 12px;">${e.phone}</div>`:""}\n        \n        <div style="text-align: center; margin-top: 10px;">\n          <button onclick="window.facilityDetailClick(${e.id})" style="background: #3b82f6; color: white; border: none; padding: 6px 12px; border-radius: 6px; cursor: pointer; font-size: 12px;">상세보기</button>\n        </div>\n      </div>\n    `,G=e=>{switch(e){case"A":case"A등급":return"#10b981";case"B":case"B등급":return"#3b82f6";case"C":case"C등급":return"#f59e0b";default:return"#6b7280"}},K=(e,s)=>d(null,null,function*(){if(!window.kakao.maps.services)return;const t=new window.kakao.maps.services.Places,a={location:new window.kakao.maps.LatLng(e,s),radius:1e3,sort:window.kakao.maps.services.SortBy.DISTANCE};try{const e=[];for(const s of Ue){const i=yield U(t,s.code,a);e.push(...i.slice(0,3))}S(e)}catch(i){}}),U=(e,s,t)=>new Promise((a,i)=>{e.categorySearch(s,(e,t)=>{if(t===window.kakao.maps.services.Status.OK){const t=e.map(e=>({id:e.id,name:e.place_name,address:e.address_name,latitude:parseFloat(e.y),longitude:parseFloat(e.x),phone:e.phone,category:s,distance:parseInt(e.distance)}));a(t)}else a([])},t)});return x.useEffect(()=>(window.facilityDetailClick=s=>{const t=e.find(e=>e.id===s);t&&u&&u(t)},()=>{delete window.facilityDetailClick}),[e,u]),x.useEffect(()=>()=>{v.current.forEach(e=>e.setMap(null)),v.current=[]},[]),h.jsxs("div",{className:`relative ${y}`,children:[h.jsx("div",{ref:f,style:{width:s,height:t},className:"rounded-lg overflow-hidden shadow-lg"}),w&&h.jsx("div",{className:"absolute inset-0 bg-gray-100 flex items-center justify-center rounded-lg",style:{width:s,height:t},children:h.jsx(pe,{size:"lg",text:"지도를 불러오는 중..."})}),N&&h.jsx("div",{className:"absolute inset-0 bg-gray-100 flex items-center justify-center rounded-lg",style:{width:s,height:t},children:h.jsxs("div",{className:"text-center",children:[h.jsx(p,{className:"h-12 w-12 text-gray-400 mx-auto mb-4"}),h.jsx("p",{className:"text-gray-600 mb-2",children:N}),h.jsx(he,{variant:"outline",size:"sm",onClick:()=>window.location.reload(),children:"다시 시도"})]})}),!w&&!N&&h.jsxs(h.Fragment,{children:[h.jsxs("div",{className:"absolute top-4 right-4 z-10 flex flex-col gap-2",children:[P&&h.jsxs(he,{onClick:()=>(e=>{const s=e||P;if(!s)return;const t=`https://map.kakao.com/link/to/${encodeURIComponent(s.name)},${s.latitude},${s.longitude}`;window.open(t,"_blank")})(P),className:"bg-white shadow-lg hover:shadow-xl flex items-center space-x-2",variant:"outline",size:"sm",children:[h.jsx(z,{className:"h-4 w-4"}),h.jsx("span",{children:"길찾기"})]}),e.length>1&&h.jsxs(he,{onClick:()=>{if(j.current){const s=new window.kakao.maps.LatLngBounds;e.forEach(e=>{e.latitude&&e.longitude&&s.extend(new window.kakao.maps.LatLng(e.latitude,e.longitude))}),j.current.setBounds(s)}},className:"bg-white shadow-lg hover:shadow-xl flex items-center space-x-2",variant:"outline",size:"sm",children:[h.jsx(p,{className:"h-4 w-4"}),h.jsx("span",{children:"전체보기"})]})]}),h.jsxs("div",{className:"absolute bottom-4 left-4 right-4 z-10",children:[P&&h.jsx(me,{className:"p-4 bg-white/95 backdrop-blur-sm mb-3",children:h.jsxs("div",{className:"flex items-center justify-between",children:[h.jsxs("div",{className:"flex-1",children:[h.jsx("h3",{className:"font-semibold text-gray-900",children:P.name}),h.jsx("p",{className:"text-sm text-gray-600",children:P.address}),h.jsxs("div",{className:"flex items-center gap-2 mt-2",children:[P.grade&&h.jsx(Badge,{className:"text-xs",style:{backgroundColor:G(P.grade)},children:P.grade}),P.rating&&h.jsxs("span",{className:"text-sm text-yellow-600",children:["★ ",P.rating.toFixed(1)]})]})]}),h.jsx(he,{variant:"outline",size:"sm",onClick:()=>A(null),children:"✕"})]})}),i&&C.length>0&&h.jsxs(me,{className:"p-3 bg-white/95 backdrop-blur-sm",children:[h.jsx("p",{className:"text-sm font-medium text-gray-700 mb-3",children:"주변 편의시설"}),h.jsx("div",{className:"flex flex-wrap gap-2",children:Ue.map(e=>{const s=C.filter(s=>s.category===e.code).length;if(0===s)return null;const t=e.icon;return h.jsxs(he,{variant:$===e.code?"default":"outline",size:"sm",onClick:()=>(e=>{if(!j.current)return;if(v.current.slice(1).forEach(e=>e.setMap(null)),v.current=v.current.slice(0,1),$===e)return void R(null);R(e);const s=C.filter(s=>s.category===e),t=Ue.find(s=>s.code===e);t&&s.forEach(e=>{const s=new window.kakao.maps.LatLng(e.latitude,e.longitude),a=t.color.includes("red")?"#EF4444":t.color.includes("green")?"#10B981":t.color.includes("blue")?"#3B82F6":t.color.includes("purple")?"#8B5CF6":t.color.includes("orange")?"#F59E0B":"#6366F1",i="data:image/svg+xml;base64,"+btoa(`\n        <svg width="24" height="30" viewBox="0 0 24 30" xmlns="http://www.w3.org/2000/svg">\n          <path d="M12 0C5.4 0 0 5.4 0 12c0 12 12 18 12 18s12-6 12-18C24 5.4 18.6 0 12 0z" fill="${a}"/>\n          <circle cx="12" cy="12" r="6" fill="white"/>\n        </svg>\n      `),l=new window.kakao.maps.Size(24,30),r={offset:new window.kakao.maps.Point(12,30)},n=new window.kakao.maps.MarkerImage(i,l,r),c=new window.kakao.maps.Marker({position:s,image:n});c.setMap(j.current),v.current.push(c);const o=new window.kakao.maps.InfoWindow({content:`\n          <div style="padding: 10px; font-size: 12px; max-width: 200px;">\n            <div style="font-weight: bold; margin-bottom: 2px;">${e.name}</div>\n            <div style="color: #666; margin-bottom: 2px;">${e.address}</div>\n            <div style="color: #007bff; font-size: 11px;">\n              ${e.distance?`거리: ${e.distance}m`:""}\n              ${e.phone?` | ${e.phone}`:""}\n            </div>\n          </div>\n        `});window.kakao.maps.event.addListener(c,"click",()=>{o.open(j.current,c)})})})(e.code),className:"flex items-center space-x-1",children:[h.jsx(t,{className:`h-3 w-3 ${e.color}`}),h.jsxs("span",{className:"text-xs",children:[e.name," (",s,")"]})]},e.code)})})]}),e.length>1&&h.jsx(me,{className:"p-3 bg-white/95 backdrop-blur-sm mt-2",children:h.jsxs("div",{className:"flex items-center justify-between text-sm",children:[h.jsxs("span",{className:"text-gray-600",children:["총 ",e.length,"개 시설"]}),h.jsxs("div",{className:"flex gap-3",children:[h.jsxs("span",{className:"text-green-600",children:["A등급 ",e.filter(e=>{var s;return null==(s=e.grade)?void 0:s.includes("A")}).length,"개"]}),h.jsxs("span",{className:"text-blue-600",children:["입소가능 ",e.filter(e=>e.availableBeds&&e.availableBeds>0).length,"개"]}),h.jsxs("span",{className:"text-red-600",children:["추천 ",e.filter(e=>e.isRecommended).length,"개"]})]})]})})]})]})]})};const Ye=()=>{const e=Me(e=>e.selectedFacility),{isDetailModalOpen:s,closeDetailModal:t,clearSelectedFacility:a,trackFacilityContact:i,trackFacilityVisit:l,openMatchingForm:r}=Me(),{reviews:n,reviewStatistics:c,loading:o,pagination:m,currentSort:j,currentFilter:v,loadReviews:w,loadReviewStatistics:k,changeSort:C,applyFilter:S,voteHelpful:$,voteNotHelpful:R,goToPage:F}=Fe(),[E,T]=x.useState("overview"),[M,A]=x.useState(null),[I,O]=x.useState(0),[B,_]=x.useState(Ne.LATEST),[re,ne]=x.useState({}),[ce,oe]=x.useState(!1),[de]=x.useState([]),ue=function({isActive:e,initialFocus:s,returnFocus:t=!0}){const a=x.useRef(null),i=x.useRef(null);return x.useEffect(()=>{if(!e)return;i.current=document.activeElement;const l=a.current;if(!l)return;const r=["button:not([disabled])","input:not([disabled])","textarea:not([disabled])","select:not([disabled])","a[href]",'[tabindex]:not([tabindex="-1"])','[contenteditable="true"]'].join(", "),n=()=>Array.from(l.querySelectorAll(r)).filter(e=>{const s=window.getComputedStyle(e);return"none"!==s.display&&"hidden"!==s.visibility}),c=e=>{if("Tab"!==e.key)return;const s=n();if(0===s.length)return;const t=s[0],a=s[s.length-1],i=document.activeElement;e.shiftKey?i===t&&(e.preventDefault(),a.focus()):i===a&&(e.preventDefault(),t.focus())},o=setTimeout(()=>{{const e=l.querySelector(s);if(e)return void e.focus()}const e=n();e.length>0&&e[0].focus()},0);return document.addEventListener("keydown",c),()=>{clearTimeout(o),document.removeEventListener("keydown",c),t&&i.current&&i.current.focus()}},[e,s,t]),a}({isActive:s,initialFocus:"button[data-close]",returnFocus:!0}),ge=()=>{t(),setTimeout(()=>{a()},300)};x.useEffect(()=>{const t=e=>{"Escape"===e.key&&ge()};return s&&(document.addEventListener("keydown",t),document.body.style.overflow="hidden",e&&(w(e.id),k(e.id))),()=>{document.removeEventListener("keydown",t),document.body.style.overflow="unset"}},[s,e,w,k]);const pe=()=>d(null,null,function*(){if(e){A("contact");try{yield i(e.id),window.open(`tel:${e.phoneNumber}`)}catch(s){}finally{A(null)}}}),ye=()=>d(null,null,function*(){if(e){A("visit");try{yield l(e.id),alert("방문 예약이 접수되었습니다. 시설에서 연락드리겠습니다.")}catch(s){}finally{A(null)}}}),fe=()=>{r()},je=(e,s)=>d(null,null,function*(){try{s?yield $(e):yield R(e)}catch(t){}}),be=()=>{O(e=>0===e?Re.length-1:e-1)},ke=()=>{O(e=>e===Re.length-1?0:e+1)};if(!s||!e)return null;const Ce=e.totalCapacity-e.currentOccupancy,Se=e.currentOccupancy/e.totalCapacity*100,$e=e=>e?`${(e/1e4).toFixed(0)}만원`:"문의",Re=e.imageUrl?[e.imageUrl]:["/images/facility-placeholder-1.jpg","/images/facility-placeholder-2.jpg","/images/facility-placeholder-3.jpg"],Ee=[{icon:K,label:"무료 WiFi",available:!0},{icon:U,label:"주차장",available:!0},{icon:W,label:"식당",available:!0},{icon:Y,label:"운동시설",available:!1},{icon:q,label:"CCTV",available:!0},{icon:V,label:"24시간 보안",available:!0}];return h.jsxs(we,{children:[h.jsxs(ve.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"fixed inset-0 z-50 flex items-center justify-center p-4",onClick:ge,children:[h.jsx("div",{className:"absolute inset-0 bg-black bg-opacity-50"}),h.jsxs(ve.div,{ref:ue,initial:{scale:.95,opacity:0},animate:{scale:1,opacity:1},exit:{scale:.95,opacity:0},transition:{type:"spring",damping:25,stiffness:300},className:"relative w-full max-w-4xl max-h-[90vh] bg-white rounded-lg shadow-xl overflow-hidden",onClick:e=>e.stopPropagation(),role:"dialog","aria-modal":"true","aria-labelledby":"modal-title","aria-describedby":"modal-description",children:[h.jsxs("div",{className:"relative",children:[h.jsxs("div",{className:"relative h-64 bg-gray-200",children:[h.jsx("img",{src:Re[I],alt:e.facilityName,className:"w-full h-full object-cover",onError:e=>{e.currentTarget.src="/images/facility-default.jpg"}}),Re.length>1&&h.jsx("div",{className:"absolute bottom-4 left-1/2 transform -translate-x-1/2 flex space-x-2",children:Re.map((e,s)=>h.jsx("button",{onClick:()=>O(s),className:"w-2 h-2 rounded-full "+(s===I?"bg-white":"bg-white bg-opacity-50")},s))}),h.jsx("div",{className:"absolute top-4 left-4",children:h.jsxs("span",{className:`px-3 py-1 rounded-full text-sm font-medium ${(e=>{switch(e){case"A":return"text-green-600 bg-green-100";case"B":return"text-blue-600 bg-blue-100";case"C":return"text-yellow-600 bg-yellow-100";case"D":return"text-orange-600 bg-orange-100";case"E":return"text-red-600 bg-red-100";default:return"text-gray-600 bg-gray-100"}})(e.facilityGrade)}`,children:[e.facilityGrade,"등급"]})}),h.jsx("button",{"data-close":!0,onClick:ge,className:"absolute top-4 right-4 w-8 h-8 bg-black bg-opacity-50 text-white rounded-full flex items-center justify-center hover:bg-opacity-70 transition-colors focus:outline-none focus:ring-2 focus:ring-white focus:ring-offset-2 focus:ring-offset-black","aria-label":"모달 닫기",children:h.jsx(b,{className:"w-5 h-5","aria-hidden":"true"})})]}),h.jsxs("div",{className:"p-6 border-b",children:[h.jsxs("div",{className:"flex justify-between items-start mb-4",children:[h.jsxs("div",{children:[h.jsx("h1",{id:"modal-title",className:"text-2xl font-bold text-gray-900 mb-2",children:e.facilityName}),h.jsxs("p",{id:"modal-description",className:"sr-only",children:[e.facilityType," 시설의 상세 정보를 확인하고 연락, 방문 예약, 매칭 신청을 할 수 있습니다."]}),h.jsx("p",{className:"text-gray-600 mb-2",children:e.facilityType}),h.jsxs("div",{className:"flex items-center text-gray-500",children:[h.jsx(p,{className:"w-4 h-4 mr-1"}),h.jsx("span",{children:e.address})]})]}),h.jsxs("div",{className:"text-right",children:[h.jsx("div",{className:"text-sm text-gray-600 mb-1",children:"월 기본료"}),h.jsx("div",{className:"text-2xl font-bold text-gray-900",children:$e(e.monthlyBasicFee)})]})]}),h.jsxs("div",{className:"grid grid-cols-3 gap-4 mb-4",children:[h.jsxs("div",{className:"text-center",children:[h.jsx("div",{className:"text-sm text-gray-600",children:"총 정원"}),h.jsxs("div",{className:"text-lg font-semibold",children:[e.totalCapacity,"명"]})]}),h.jsxs("div",{className:"text-center",children:[h.jsx("div",{className:"text-sm text-gray-600",children:"현재 입소"}),h.jsxs("div",{className:"text-lg font-semibold",children:[e.currentOccupancy,"명"]})]}),h.jsxs("div",{className:"text-center",children:[h.jsx("div",{className:"text-sm text-gray-600",children:"입소 가능"}),h.jsx("div",{className:"text-lg font-semibold "+(Ce>0?"text-green-600":"text-red-600"),children:Ce>0?`${Ce}명`:"대기"})]})]}),h.jsxs("div",{className:"mb-4",children:[h.jsxs("div",{className:"flex justify-between text-sm text-gray-600 mb-1",children:[h.jsx("span",{children:"입소율"}),h.jsxs("span",{children:[Math.round(Se),"%"]})]}),h.jsx("div",{className:"w-full bg-gray-200 rounded-full h-2",children:h.jsx("div",{className:"h-2 rounded-full "+(Se>=90?"bg-red-500":Se>=70?"bg-yellow-500":"bg-green-500"),style:{width:`${Math.min(Se,100)}%`}})})]}),h.jsxs("div",{className:"flex space-x-3",children:[h.jsxs(he,{onClick:pe,disabled:"contact"===M,className:"flex-1",children:["contact"===M?h.jsx(ve.div,{animate:{rotate:360},transition:{duration:1,repeat:1/0,ease:"linear"},children:h.jsx(y,{className:"w-4 h-4 mr-2"})}):h.jsx(y,{className:"w-4 h-4 mr-2"}),"연락하기"]}),h.jsxs(he,{variant:"outline",onClick:ye,disabled:"visit"===M,className:"flex-1",children:["visit"===M?h.jsx(ve.div,{animate:{rotate:360},transition:{duration:1,repeat:1/0,ease:"linear"},children:h.jsx(f,{className:"w-4 h-4 mr-2"})}):h.jsx(f,{className:"w-4 h-4 mr-2"}),"방문 예약"]}),h.jsxs(he,{variant:"outline",onClick:fe,className:"flex-1",children:[h.jsx(N,{className:"w-4 h-4 mr-2"}),"매칭 신청"]})]})]})]}),h.jsx("div",{className:"border-b",children:h.jsx("nav",{className:"flex px-6 overflow-x-auto",role:"tablist","aria-label":"시설 정보 탭",children:[{key:"overview",label:"개요",icon:H},{key:"services",label:"서비스",icon:D},{key:"location",label:"위치",icon:p},{key:"reviews",label:"리뷰",icon:u,badge:null==c?void 0:c.totalCount},{key:"photos",label:"사진",icon:G,badge:Re.length}].map(({key:e,label:s,icon:t,badge:a})=>h.jsxs("button",{onClick:()=>T(e),className:"flex items-center px-4 py-3 border-b-2 font-medium text-sm focus:outline-none focus:ring-2 focus:ring-elderberry-500 focus:ring-offset-2 "+(E===e?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"),role:"tab","aria-selected":E===e,"aria-controls":`tabpanel-${e}`,id:`tab-${e}`,children:[h.jsx(t,{className:"w-4 h-4 mr-2","aria-hidden":"true"}),h.jsx("span",{children:s}),a&&a>0&&h.jsx("span",{className:"ml-1 bg-blue-100 text-blue-800 text-xs px-2 py-0.5 rounded-full",children:a})]},e))})}),h.jsx("div",{className:"flex-1 overflow-y-auto max-h-96",children:h.jsxs(we,{mode:"wait",children:["overview"===E&&h.jsxs(ve.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},exit:{opacity:0,y:-20},className:"p-6",role:"tabpanel",id:"tabpanel-overview","aria-labelledby":"tab-overview",children:[h.jsxs("div",{className:"mb-6",children:[h.jsx("h3",{className:"text-lg font-semibold mb-3",children:"시설 소개"}),h.jsx("p",{className:"text-gray-700 leading-relaxed",children:e.description||`${e.facilityName}은(는) ${e.facilityType}로서 전문적인 돌봄 서비스를 제공합니다. \n                        숙련된 전문 인력과 체계적인 케어 프로그램을 통해 입소자분들의 건강하고 안전한 생활을 지원하고 있습니다.`})]}),e.specialties&&e.specialties.length>0&&h.jsxs("div",{className:"mb-6",children:[h.jsx("h3",{className:"text-lg font-semibold mb-3",children:"전문 서비스"}),h.jsx("div",{className:"flex flex-wrap gap-2",children:e.specialties.map(e=>h.jsx("span",{className:"px-3 py-1 bg-blue-50 text-blue-700 rounded-full text-sm",children:e},e))})]}),h.jsxs("div",{className:"mb-6",children:[h.jsx("h3",{className:"text-lg font-semibold mb-3",children:"편의시설"}),h.jsx("div",{className:"grid grid-cols-2 gap-3",children:Ee.map(({icon:e,label:s,available:t})=>h.jsxs("div",{className:"flex items-center space-x-2 "+(t?"text-gray-900":"text-gray-400"),children:[h.jsx(e,{className:"w-4 h-4"}),h.jsx("span",{className:"text-sm",children:s}),t?h.jsx(P,{className:"w-4 h-4 text-green-500"}):h.jsx(b,{className:"w-4 h-4 text-gray-400"})]},s))})]}),h.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[h.jsxs("div",{children:[h.jsx("h3",{className:"text-lg font-semibold mb-3",children:"운영 정보"}),h.jsxs("div",{className:"space-y-3",children:[h.jsxs("div",{className:"flex items-center",children:[h.jsx(Q,{className:"w-4 h-4 mr-2 text-gray-400"}),h.jsxs("span",{children:["운영시간: ",e.operatingHours||"24시간 운영"]})]}),h.jsxs("div",{className:"flex items-center",children:[h.jsx(y,{className:"w-4 h-4 mr-2 text-gray-400"}),h.jsxs("span",{children:["연락처: ",e.phoneNumber]})]}),h.jsxs("div",{className:"flex items-center",children:[h.jsx(g,{className:"w-4 h-4 mr-2 text-gray-400"}),h.jsxs("span",{children:["정원: ",e.totalCapacity,"명"]})]}),h.jsxs("div",{className:"flex items-center",children:[h.jsx(J,{className:"w-4 h-4 mr-2 text-gray-400"}),h.jsxs("span",{children:["등급: ",e.facilityGrade,"등급"]})]})]})]}),h.jsxs("div",{children:[h.jsx("h3",{className:"text-lg font-semibold mb-3",children:"비용 정보"}),h.jsxs("div",{className:"space-y-3",children:[h.jsxs("div",{className:"flex items-center justify-between",children:[h.jsx("span",{className:"text-gray-600",children:"월 기본료"}),h.jsx("span",{className:"font-semibold",children:$e(e.monthlyBasicFee)})]}),h.jsxs("div",{className:"flex items-center justify-between",children:[h.jsx("span",{className:"text-gray-600",children:"식비"}),h.jsx("span",{className:"text-gray-500",children:"별도 문의"})]}),h.jsxs("div",{className:"flex items-center justify-between",children:[h.jsx("span",{className:"text-gray-600",children:"간병비"}),h.jsx("span",{className:"text-gray-500",children:"등급별 상이"})]}),h.jsx("div",{className:"text-xs text-gray-500 mt-2",children:"* 정확한 비용은 상담을 통해 확인하실 수 있습니다."})]})]})]}),h.jsxs("div",{className:"mt-6 p-4 bg-gradient-to-r from-blue-50 to-indigo-50 rounded-lg",children:[h.jsx("h4",{className:"font-medium text-gray-900 mb-3",children:"빠른 연락 및 예약"}),h.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-3",children:[h.jsxs(he,{onClick:pe,disabled:"contact"===M,className:"flex items-center justify-center space-x-2",children:[h.jsx(y,{className:"w-4 h-4"}),h.jsx("span",{children:"전화 상담"})]}),h.jsxs(he,{variant:"outline",onClick:ye,disabled:"visit"===M,className:"flex items-center justify-center space-x-2",children:[h.jsx(f,{className:"w-4 h-4"}),h.jsx("span",{children:"방문 예약"})]}),h.jsxs(he,{variant:"outline",onClick:fe,className:"flex items-center justify-center space-x-2",children:[h.jsx(N,{className:"w-4 h-4"}),h.jsx("span",{children:"매칭 신청"})]})]}),h.jsxs("div",{className:"mt-3 text-sm text-gray-600 text-center",children:[h.jsx("p",{children:"📞 상담 가능 시간: 평일 09:00 ~ 18:00"}),h.jsx("p",{children:"🏥 방문 상담 시 사전 예약을 권장합니다."})]})]})]},"overview"),"services"===E&&h.jsxs(ve.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},exit:{opacity:0,y:-20},className:"p-6",children:[h.jsx("h3",{className:"text-lg font-semibold mb-4",children:"제공 서비스"}),h.jsxs("div",{className:"mb-6",children:[h.jsx("h4",{className:"font-medium mb-3",children:"케어 등급별 서비스"}),h.jsx("div",{className:"space-y-2",children:e.availableCareGrades.map(e=>h.jsxs("div",{className:"flex items-center justify-between py-2 px-3 bg-gray-50 rounded",children:[h.jsxs("span",{children:[e,"등급 케어"]}),h.jsx(P,{className:"w-4 h-4 text-green-500"})]},e))})]}),h.jsxs("div",{className:"space-y-4",children:[h.jsx(me,{children:h.jsxs(xe,{className:"p-4",children:[h.jsx("h5",{className:"font-medium mb-2",children:"일상생활 지원"}),h.jsx("p",{className:"text-sm text-gray-600",children:"식사, 목욕, 배설, 이동 등 일상생활 전반에 대한 전문적인 돌봄 서비스"})]})}),h.jsx(me,{children:h.jsxs(xe,{className:"p-4",children:[h.jsx("h5",{className:"font-medium mb-2",children:"건강 관리"}),h.jsx("p",{className:"text-sm text-gray-600",children:"정기 건강검진, 투약 관리, 응급상황 대응 등 체계적인 건강 관리"})]})}),h.jsx(me,{children:h.jsxs(xe,{className:"p-4",children:[h.jsx("h5",{className:"font-medium mb-2",children:"여가 활동"}),h.jsx("p",{className:"text-sm text-gray-600",children:"다양한 프로그램과 여가 활동을 통한 정서적 지원 및 사회적 교류"})]})})]})]},"services"),"location"===E&&h.jsxs(ve.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},exit:{opacity:0,y:-20},className:"p-6 space-y-6",children:[h.jsx("h3",{className:"text-lg font-semibold mb-4",children:"위치 정보"}),h.jsxs("div",{className:"bg-gray-50 rounded-lg p-4",children:[h.jsxs("h4",{className:"font-medium mb-3 flex items-center",children:[h.jsx(p,{className:"w-4 h-4 mr-2 text-blue-600"}),"지도"]}),h.jsx(We,{facility:{id:e.id,name:e.facilityName,address:e.address,latitude:e.latitude||void 0,longitude:e.longitude||void 0,phone:e.phoneNumber},height:"350px",showNearbyPlaces:!0,showControls:!0,className:"rounded-lg overflow-hidden"})]}),h.jsxs("div",{className:"space-y-4",children:[h.jsxs("div",{children:[h.jsxs("div",{className:"flex items-center mb-2",children:[h.jsx(p,{className:"w-4 h-4 mr-2 text-gray-400"}),h.jsx("span",{className:"font-medium",children:"주소"})]}),h.jsx("p",{className:"text-gray-700 ml-6",children:e.address})]}),e.latitude&&e.longitude&&h.jsxs("div",{children:[h.jsxs("div",{className:"flex items-center mb-2",children:[h.jsx(z,{className:"w-4 h-4 mr-2 text-gray-400"}),h.jsx("span",{className:"font-medium",children:"좌표"})]}),h.jsxs("p",{className:"text-gray-700 ml-6",children:["위도: ",e.latitude,", 경도: ",e.longitude]})]}),h.jsxs("div",{className:"flex space-x-3",children:[h.jsxs(he,{onClick:()=>{if((null==e?void 0:e.latitude)&&(null==e?void 0:e.longitude)){const s=`https://map.kakao.com/link/map/${e.facilityName},${e.latitude},${e.longitude}`;window.open(s,"_blank")}},variant:"outline",className:"flex-1",children:[h.jsx(p,{className:"w-4 h-4 mr-2"}),"카카오맵에서 보기"]}),h.jsxs(he,{onClick:()=>{const s=`https://map.naver.com/v5/search/${encodeURIComponent(e.address)}`;window.open(s,"_blank")},variant:"outline",className:"flex-1",children:[h.jsx(z,{className:"w-4 h-4 mr-2"}),"네이버지도에서 보기"]})]}),h.jsxs("div",{children:[h.jsx("h4",{className:"font-medium mb-3",children:"교통 정보"}),h.jsxs("div",{className:"space-y-2 text-sm",children:[h.jsxs("div",{className:"flex items-center",children:[h.jsx(U,{className:"w-4 h-4 mr-2 text-gray-400"}),h.jsx("span",{children:"주차장 이용 가능"})]}),h.jsx("div",{className:"text-gray-600 ml-6",children:"대중교통 이용 시 가장 가까운 지하철역에서 도보 10분 거리"})]})]}),de.length>0&&h.jsxs("div",{children:[h.jsx("h4",{className:"font-medium mb-3",children:"주변 편의시설"}),h.jsx("div",{className:"grid grid-cols-2 gap-3",children:de.slice(0,6).map((e,s)=>h.jsxs("div",{className:"flex items-center space-x-2 text-sm",children:[h.jsx("div",{className:"w-2 h-2 bg-blue-500 rounded-full"}),h.jsx("span",{className:"text-gray-700",children:e.name}),h.jsxs("span",{className:"text-gray-500 text-xs",children:["(",e.distance,"m)"]})]},s))})]})]})]},"location"),"reviews"===E&&h.jsxs(ve.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},exit:{opacity:0,y:-20},className:"p-6 space-y-6",children:[h.jsxs("div",{className:"flex items-center justify-between",children:[h.jsx("h3",{className:"text-lg font-semibold",children:"이용 후기"}),h.jsxs("div",{className:"flex items-center space-x-2",children:[h.jsxs(he,{variant:"outline",size:"sm",children:[h.jsx(Z,{className:"w-4 h-4 mr-1"}),"필터"]}),h.jsxs("select",{value:B,onChange:s=>{return t=s.target.value,d(null,null,function*(){_(t),e&&(yield C(t))});var t},className:"px-3 py-1 border rounded text-sm",children:[h.jsx("option",{value:Ne.LATEST,children:"최신순"}),h.jsx("option",{value:Ne.HIGHEST_RATING,children:"평점 높은순"}),h.jsx("option",{value:Ne.LOWEST_RATING,children:"평점 낮은순"}),h.jsx("option",{value:Ne.MOST_HELPFUL,children:"도움됨순"})]})]})]}),c&&h.jsxs("div",{className:"bg-gradient-to-r from-blue-50 to-indigo-50 rounded-lg p-6",children:[h.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[h.jsxs("div",{className:"text-center",children:[h.jsx("div",{className:"text-3xl font-bold text-blue-600 mb-2",children:c.averageRating.toFixed(1)}),h.jsx("div",{className:"flex items-center justify-center mb-2",children:Array.from({length:5}).map((e,s)=>h.jsx(u,{className:"w-5 h-5 "+(s<Math.round(c.averageRating)?"text-yellow-400 fill-current":"text-gray-300")},s))}),h.jsxs("div",{className:"text-sm text-gray-600",children:[c.totalCount,"개의 리뷰"]}),h.jsxs("div",{className:"text-sm text-blue-600 font-medium mt-2",children:["추천률 ",c.recommendationPercentage,"%"]})]}),h.jsx("div",{className:"space-y-2",children:Object.entries(c.ratingDistribution).sort(([e],[s])=>Number(s)-Number(e)).map(([e,s])=>h.jsxs("div",{className:"flex items-center space-x-2",children:[h.jsxs("span",{className:"text-sm w-4",children:[e,"점"]}),h.jsx("div",{className:"flex-1 bg-gray-200 rounded-full h-2",children:h.jsx("div",{className:"bg-yellow-400 h-2 rounded-full",style:{width:(c.totalCount>0?s/c.totalCount*100:0)+"%"}})}),h.jsx("span",{className:"text-sm text-gray-600 w-8",children:s})]},e))})]}),h.jsxs("div",{className:"mt-4 pt-4 border-t border-blue-100",children:[h.jsx("h4",{className:"font-medium mb-3 text-gray-700",children:"카테고리별 평점"}),h.jsx("div",{className:"grid grid-cols-2 md:grid-cols-5 gap-3",children:Object.entries(c.categoryRatings).map(([e,s])=>h.jsxs("div",{className:"text-center",children:[h.jsx("div",{className:"text-sm font-medium text-gray-600 mb-1",children:"serviceQuality"===e?"서비스":"facility"===e?"시설":"staff"===e?"직원":"price"===e?"가격":"accessibility"===e?"접근성":e}),h.jsx("div",{className:"text-lg font-semibold text-blue-600",children:s>0?s.toFixed(1):"-"})]},e))})]})]}),h.jsx("div",{className:"space-y-4",children:o.reviews?h.jsxs("div",{className:"text-center py-8",children:[h.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600 mx-auto"}),h.jsx("p",{className:"mt-2 text-gray-600",children:"리뷰를 불러오는 중..."})]}):0===n.length?h.jsxs("div",{className:"text-center py-8 text-gray-500",children:[h.jsx(X,{className:"w-12 h-12 mx-auto mb-4 text-gray-300"}),h.jsx("p",{children:"아직 등록된 리뷰가 없습니다."}),h.jsx("p",{className:"text-sm mt-1",children:"첫 번째 리뷰를 작성해보세요!"})]}):n.map(e=>h.jsx(me,{className:"hover:shadow-md transition-shadow",children:h.jsxs(xe,{className:"p-4",children:[h.jsxs("div",{className:"flex items-center justify-between mb-3",children:[h.jsxs("div",{className:"flex items-center space-x-3",children:[h.jsx("div",{className:"w-8 h-8 bg-blue-100 rounded-full flex items-center justify-center",children:h.jsx("span",{className:"text-sm font-medium text-blue-600",children:e.reviewer.name.charAt(0)})}),h.jsxs("div",{children:[h.jsxs("div",{className:"flex items-center space-x-2",children:[h.jsx("span",{className:"font-medium text-gray-900",children:e.anonymous?"익명":e.reviewer.name}),e.verified&&h.jsx("span",{className:"px-2 py-0.5 bg-green-100 text-green-800 text-xs rounded-full",children:"인증됨"})]}),h.jsxs("div",{className:"flex items-center space-x-2",children:[h.jsx("div",{className:"flex items-center",children:Array.from({length:5}).map((s,t)=>h.jsx(u,{className:"w-4 h-4 "+(t<e.overallRating?"text-yellow-400 fill-current":"text-gray-300")},t))}),h.jsx("span",{className:"text-sm text-gray-500",children:new Date(e.createdDate).toLocaleDateString()})]})]})]}),h.jsx(he,{variant:"ghost",size:"sm",children:h.jsx(ee,{className:"w-4 h-4"})})]}),e.title&&h.jsx("h4",{className:"font-medium text-gray-900 mb-2",children:e.title}),h.jsx("p",{className:"text-gray-700 mb-3 leading-relaxed",children:e.content}),e.tags.length>0&&h.jsx("div",{className:"flex flex-wrap gap-1 mb-3",children:e.tags.map((e,s)=>h.jsx("span",{className:"px-2 py-1 bg-gray-100 text-gray-600 text-xs rounded-full",children:e},s))}),e.imageUrls.length>0&&h.jsxs("div",{className:"flex space-x-2 mb-3",children:[e.imageUrls.slice(0,3).map((e,s)=>h.jsx("img",{src:e,alt:`리뷰 이미지 ${s+1}`,className:"w-16 h-16 object-cover rounded-lg cursor-pointer hover:opacity-80",onClick:()=>{}},s)),e.imageUrls.length>3&&h.jsxs("div",{className:"w-16 h-16 bg-gray-100 rounded-lg flex items-center justify-center text-gray-500 text-xs",children:["+",e.imageUrls.length-3]})]}),h.jsxs("div",{className:"flex items-center justify-between pt-3 border-t border-gray-100",children:[h.jsxs("div",{className:"flex items-center space-x-4",children:[h.jsxs("button",{onClick:()=>je(e.id,!0),className:"flex items-center space-x-1 text-sm text-gray-500 hover:text-blue-600",disabled:o.vote,children:[h.jsx(se,{className:"w-4 h-4"}),h.jsxs("span",{children:["도움됨 ",e.helpfulCount]})]}),h.jsxs("button",{onClick:()=>je(e.id,!1),className:"flex items-center space-x-1 text-sm text-gray-500 hover:text-red-600",disabled:o.vote,children:[h.jsx(te,{className:"w-4 h-4"}),h.jsx("span",{children:e.notHelpfulCount})]}),h.jsxs("button",{className:"flex items-center space-x-1 text-sm text-gray-500 hover:text-red-600",children:[h.jsx(ae,{className:"w-4 h-4"}),h.jsx("span",{children:"신고"})]})]}),e.recommended&&h.jsx("span",{className:"text-sm text-green-600 font-medium",children:"추천합니다"})]}),e.adminResponse&&h.jsxs("div",{className:"mt-4 p-3 bg-blue-50 rounded-lg border-l-4 border-blue-400",children:[h.jsxs("div",{className:"flex items-center mb-2",children:[h.jsx(L,{className:"w-4 h-4 text-blue-600 mr-2"}),h.jsx("span",{className:"text-sm font-medium text-blue-900",children:"시설 관리자 답변"}),e.adminResponseDate&&h.jsx("span",{className:"text-xs text-blue-600 ml-auto",children:new Date(e.adminResponseDate).toLocaleDateString()})]}),h.jsx("p",{className:"text-sm text-blue-800",children:e.adminResponse})]})]})},e.id))}),m.totalPages>1&&h.jsxs("div",{className:"flex items-center justify-center space-x-2",children:[h.jsx(he,{variant:"outline",size:"sm",onClick:()=>F(m.page-1),disabled:!m.hasPrevious,children:h.jsx(ie,{className:"w-4 h-4"})}),h.jsxs("span",{className:"text-sm text-gray-600",children:[m.page+1," / ",m.totalPages]}),h.jsx(he,{variant:"outline",size:"sm",onClick:()=>F(m.page+1),disabled:!m.hasNext,children:h.jsx(le,{className:"w-4 h-4"})})]}),h.jsx("div",{className:"text-center pt-4 border-t",children:h.jsxs(he,{className:"px-6",children:[h.jsx(u,{className:"w-4 h-4 mr-2"}),"리뷰 작성하기"]})})]},"reviews"),"photos"===E&&h.jsxs(ve.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},exit:{opacity:0,y:-20},className:"p-6",children:[h.jsxs("div",{className:"flex items-center justify-between mb-6",children:[h.jsx("h3",{className:"text-lg font-semibold",children:"시설 사진"}),h.jsxs("span",{className:"text-sm text-gray-600",children:["총 ",Re.length,"장"]})]}),h.jsxs("div",{className:"relative mb-6",children:[h.jsx("div",{className:"aspect-video bg-gray-200 rounded-lg overflow-hidden",children:h.jsx("img",{src:Re[I],alt:`${e.facilityName} 사진 ${I+1}`,className:"w-full h-full object-cover",onError:e=>{e.currentTarget.src="/images/facility-default.jpg"}})}),Re.length>1&&h.jsxs(h.Fragment,{children:[h.jsx("button",{onClick:be,className:"absolute left-4 top-1/2 transform -translate-y-1/2 w-10 h-10 bg-white bg-opacity-80 hover:bg-opacity-100 rounded-full flex items-center justify-center shadow-lg transition-all",children:h.jsx(ie,{className:"w-5 h-5 text-gray-700"})}),h.jsx("button",{onClick:ke,className:"absolute right-4 top-1/2 transform -translate-y-1/2 w-10 h-10 bg-white bg-opacity-80 hover:bg-opacity-100 rounded-full flex items-center justify-center shadow-lg transition-all",children:h.jsx(le,{className:"w-5 h-5 text-gray-700"})}),h.jsxs("div",{className:"absolute bottom-4 right-4 bg-black bg-opacity-50 text-white px-3 py-1 rounded-full text-sm",children:[I+1," / ",Re.length]})]}),h.jsx("button",{onClick:()=>oe(!0),className:"absolute top-4 right-4 bg-black bg-opacity-50 text-white p-2 rounded-full hover:bg-opacity-70 transition-colors",children:h.jsx(G,{className:"w-5 h-5"})})]}),h.jsxs("div",{className:"grid grid-cols-4 md:grid-cols-6 gap-3",children:[Re.map((s,t)=>h.jsx("div",{className:"aspect-square bg-gray-200 rounded-lg overflow-hidden cursor-pointer transition-all "+(t===I?"ring-2 ring-blue-500 ring-offset-2":"hover:opacity-80"),onClick:()=>O(t),children:h.jsx("img",{src:s,alt:`${e.facilityName} 썸네일 ${t+1}`,className:"w-full h-full object-cover",onError:e=>{e.currentTarget.src="/images/facility-default.jpg"}})},t)),Array.from({length:Math.max(0,12-Re.length)}).map((e,s)=>h.jsx("div",{className:"aspect-square bg-gray-100 rounded-lg flex items-center justify-center",children:h.jsx(G,{className:"w-6 h-6 text-gray-400"})},`placeholder-${s}`))]}),h.jsxs("div",{className:"mt-6 space-y-4",children:[h.jsx("h4",{className:"font-medium text-gray-900",children:"사진 카테고리"}),h.jsx("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[{name:"외관",count:3,icon:H},{name:"내부시설",count:5,icon:Y},{name:"객실",count:4,icon:g},{name:"편의시설",count:2,icon:K}].map(e=>h.jsx(me,{className:"cursor-pointer hover:shadow-md transition-shadow",children:h.jsxs(xe,{className:"p-4 text-center",children:[h.jsx(e.icon,{className:"w-8 h-8 mx-auto mb-2 text-blue-600"}),h.jsx("h5",{className:"font-medium text-gray-900",children:e.name}),h.jsxs("p",{className:"text-sm text-gray-600",children:[e.count,"장"]})]})},e.name))})]}),h.jsxs("div",{className:"mt-6 p-4 bg-gray-50 rounded-lg",children:[h.jsx("h4",{className:"font-medium text-gray-900 mb-2",children:"사진 정보"}),h.jsxs("div",{className:"text-sm text-gray-600 space-y-1",children:[h.jsx("p",{children:"• 모든 사진은 실제 시설을 촬영한 것입니다."}),h.jsx("p",{children:"• 사진은 정기적으로 업데이트됩니다."}),h.jsx("p",{children:"• 궁금한 부분이 있으시면 시설에 직접 문의해주세요."})]})]})]},"photos")]})})]})]}),ce&&h.jsx(ve.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"fixed inset-0 z-[60] flex items-center justify-center bg-black bg-opacity-90",onClick:()=>oe(!1),children:h.jsxs("div",{className:"relative w-full h-full flex items-center justify-center",children:[h.jsx("img",{src:Re[I],alt:`${e.facilityName} 사진 ${I+1}`,className:"max-w-full max-h-full object-contain",onClick:e=>e.stopPropagation()}),h.jsx("button",{onClick:()=>oe(!1),className:"absolute top-4 right-4 w-12 h-12 bg-white bg-opacity-20 hover:bg-opacity-30 text-white rounded-full flex items-center justify-center",children:h.jsx(b,{className:"w-6 h-6"})}),Re.length>1&&h.jsxs(h.Fragment,{children:[h.jsx("button",{onClick:be,className:"absolute left-4 top-1/2 transform -translate-y-1/2 w-12 h-12 bg-white bg-opacity-20 hover:bg-opacity-30 text-white rounded-full flex items-center justify-center",children:h.jsx(ie,{className:"w-6 h-6"})}),h.jsx("button",{onClick:ke,className:"absolute right-4 top-1/2 transform -translate-y-1/2 w-12 h-12 bg-white bg-opacity-20 hover:bg-opacity-30 text-white rounded-full flex items-center justify-center",children:h.jsx(le,{className:"w-6 h-6"})}),h.jsxs("div",{className:"absolute bottom-4 left-1/2 transform -translate-x-1/2 bg-black bg-opacity-50 text-white px-4 py-2 rounded-full text-sm",children:[I+1," / ",Re.length]})]})]})})]})},qe=Object.freeze(Object.defineProperty({__proto__:null,default:({memberId:e,coordinatorId:s,showRecommendations:t=!0})=>{ye(je.facilitySearch),x.useEffect(()=>{fe({"@context":"https://schema.org","@type":"WebApplication",name:"요양원 시설 검색",description:"재외동포를 위한 한국 요양원 검색 및 매칭 서비스",applicationCategory:"HealthApplication",operatingSystem:"Web",offers:{"@type":"Offer",price:"0",priceCurrency:"KRW"}},"facility-search-data")},[]);const a=Me(e=>(Pe.has(e)&&Pe.get(e)===e.searchResults||Pe.set(e,e.searchResults),Pe.get(e))),i=Me(e=>e.isSearching),l=Me(e=>e.isLoadingRecommendations),r=Me(e=>e.searchError),c=Me(e=>e.recommendationError),{recommendations:o,searchFilters:m,isDetailModalOpen:u,isRecommendationModalOpen:g,searchFacilities:p,getRecommendations:y,updateSearchFilters:f,clearSearchResults:j,clearRecommendations:b,openRecommendationModal:N,closeRecommendationModal:k,clearAllErrors:C}=Me(),[$,R]=x.useState("list"),[F,E]=x.useState(!1),[T,M]=x.useState(""),[P,L]=x.useState("search");x.useEffect(()=>(C(),t&&e&&(L("recommendations"),I()),()=>{j(),b()}),[e,t]);const z=()=>d(null,null,function*(){if(!T.trim()&&0===Object.keys(m).length)return;const e=n(n({},m),T&&{region:T});yield p(e),L("search")}),I=()=>d(null,null,function*(){e&&(yield y(e,s))});return h.jsx("div",{className:"min-h-screen bg-gray-50 py-8",children:h.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:[h.jsxs("div",{className:"mb-8",children:[h.jsx("h1",{className:"text-3xl font-bold text-gray-900 mb-2",children:"시설 검색 및 추천"}),h.jsx("p",{className:"text-gray-600",children:"맞춤형 요양 시설을 찾아보세요. AI 기반 추천으로 최적의 시설을 제안해드립니다."})]}),h.jsx("div",{className:"mb-6",children:h.jsx("div",{className:"border-b border-gray-200",children:h.jsxs("nav",{className:"-mb-px flex space-x-8",children:[h.jsxs("button",{onClick:()=>L("search"),className:"py-2 px-1 border-b-2 font-medium text-sm "+("search"===P?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"),children:[h.jsx(w,{className:"w-4 h-4 inline mr-2"}),"시설 검색"]}),t&&h.jsxs("button",{onClick:()=>{L("recommendations"),e&&I()},className:"py-2 px-1 border-b-2 font-medium text-sm "+("recommendations"===P?"border-purple-500 text-purple-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"),children:[h.jsx(S,{className:"w-4 h-4 inline mr-2"}),"맞춤 추천",o.length>0&&h.jsx("span",{className:"ml-2 bg-purple-100 text-purple-800 text-xs px-2 py-1 rounded-full",children:o.length})]})]})})}),h.jsxs(we,{mode:"wait",children:["search"===P&&h.jsxs(ve.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},exit:{opacity:0,y:-20},transition:{duration:.3},children:[h.jsx(me,{className:"mb-6",children:h.jsxs(xe,{className:"p-6",children:[h.jsxs("div",{className:"flex flex-col lg:flex-row gap-4",children:[h.jsx("div",{className:"flex-1",children:h.jsxs("div",{className:"relative",children:[h.jsx(w,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-5 h-5"}),h.jsx("input",{type:"text",placeholder:"지역명을 입력하세요 (예: 서울시 강남구)",value:T,onChange:e=>{M(e.target.value)},onKeyPress:e=>{"Enter"===e.key&&z()},className:"w-full pl-10 pr-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]})}),h.jsx(he,{onClick:z,disabled:i,className:"px-8 py-3",children:i?h.jsxs(h.Fragment,{children:[h.jsx(v,{className:"w-4 h-4 mr-2 animate-spin"}),"검색 중..."]}):h.jsxs(h.Fragment,{children:[h.jsx(w,{className:"w-4 h-4 mr-2"}),"검색"]})}),h.jsxs(he,{variant:"outline",onClick:()=>E(!F),className:"px-4 py-3",children:[h.jsx(Z,{className:"w-4 h-4 mr-2"}),"필터"]})]}),h.jsx(we,{children:F&&h.jsx(ve.div,{initial:{height:0,opacity:0},animate:{height:"auto",opacity:1},exit:{height:0,opacity:0},transition:{duration:.3},className:"overflow-hidden",children:h.jsx("div",{className:"mt-6 pt-6 border-t border-gray-200",children:h.jsx(De,{filters:m,onFiltersChange:e=>{f(e),"search"===P&&setTimeout(()=>{z()},500)}})})})})]})}),r&&h.jsx(ve.div,{initial:{opacity:0,y:-10},animate:{opacity:1,y:0},className:"mb-6",children:h.jsx("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4",children:h.jsxs("div",{className:"flex items-center",children:[h.jsx(A,{className:"w-5 h-5 text-red-500 mr-2"}),h.jsx("span",{className:"text-red-700",children:r})]})})}),a.length>0&&h.jsxs("div",{className:"flex justify-between items-center mb-6",children:[h.jsxs("div",{children:[h.jsx("h2",{className:"text-xl font-semibold text-gray-900",children:"검색 결과"}),h.jsxs("p",{className:"text-gray-600",children:["총 ",a.length,"개의 시설을 찾았습니다."]})]}),h.jsxs("div",{className:"flex items-center space-x-2",children:[h.jsx(he,{variant:"list"===$?"default":"outline",size:"sm",onClick:()=>R("list"),children:h.jsx(re,{className:"w-4 h-4"})}),h.jsx(he,{variant:"grid"===$?"default":"outline",size:"sm",onClick:()=>R("grid"),children:h.jsx(ne,{className:"w-4 h-4"})})]})]}),h.jsx(Le,{facilities:a,viewMode:$,isLoading:i,emptyMessage:"검색 조건에 맞는 시설이 없습니다."})]},"search"),"recommendations"===P&&h.jsxs(ve.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},exit:{opacity:0,y:-20},transition:{duration:.3},children:[c&&h.jsx(ve.div,{initial:{opacity:0,y:-10},animate:{opacity:1,y:0},className:"mb-6",children:h.jsx("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4",children:h.jsxs("div",{className:"flex items-center",children:[h.jsx(A,{className:"w-5 h-5 text-red-500 mr-2"}),h.jsx("span",{className:"text-red-700",children:c})]})})}),h.jsx(Ge,{recommendations:o,isLoading:l,onRefresh:I,memberId:e})]},"recommendations")]}),h.jsx(Ye,{})]})})}},Symbol.toStringTag,{value:"Module"}));export{qe as F,Fe as u};

var e=Object.defineProperty,r=Object.defineProperties,a=Object.getOwnPropertyDescriptors,t=Object.getOwnPropertySymbols,l=Object.prototype.hasOwnProperty,i=Object.prototype.propertyIsEnumerable,s=(r,a,t)=>a in r?e(r,a,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[a]=t,n=(e,r)=>{for(var a in r||(r={}))l.call(r,a)&&s(e,a,r[a]);if(t)for(var a of t(r))i.call(r,a)&&s(e,a,r[a]);return e},c=(e,t)=>r(e,a(t));import{aF as d,e as m,r as o,al as b,aq as h,j as x,A as y,ae as p,V as g,aU as u}from"./react-vendor-BtXaCJgl.js";import{S as f,r as N}from"./StarRating-Ynunmu7C.js";import{f as v}from"./facility-pages-UHQS1ynl.js";import{B as w}from"./core-ui-CIyy5Fk7.js";import{C as j,a as k}from"./chat-pages-Bd-211Ah.js";import{E as R,L as C}from"./board-pages-D7wDb-_I.js";import{m as O}from"./animation-lib-shoFM1zt.js";import"./vendor-lkuvNL7c.js";import"./state-management-DFZwgI-2.js";import"./style-utils-DeQRAeyh.js";import"./http-client-9JY-woyA.js";import"./theme-layout-CH0OfMSw.js";const A=[{key:"serviceQualityRating",label:"서비스 품질",description:"직원 친절도, 서비스 질"},{key:"facilityRating",label:"시설 환경",description:"시설 청결도, 편의시설"},{key:"staffRating",label:"직원 전문성",description:"전문성, 케어 능력"},{key:"priceRating",label:"가격 만족도",description:"비용 대비 만족도"},{key:"accessibilityRating",label:"접근성",description:"교통편, 위치 접근성"}],F=["친절한 직원","깨끗한 시설","전문적 케어","좋은 위치","합리적 가격","맛있는 식사","다양한 프로그램","편리한 교통","안전한 환경","개별 케어","가족 같은 분위기","의료진 우수","최신 시설","넓은 공간","조용한 환경"],I=()=>{const[e]=d(),r=m(),a=e.get("facilityId"),[t,l]=o.useState(1),[i,s]=o.useState({title:"",content:"",overallRating:0,serviceQualityRating:0,facilityRating:0,staffRating:0,priceRating:0,accessibilityRating:0,tags:[],images:[],isAnonymous:!1,wouldRecommend:!0}),{data:I,isLoading:L,error:q}=b({queryKey:["facility",a],queryFn:()=>v.getFacilityById(parseInt(a)),enabled:!!a}),z=h({mutationFn:e=>N.createReview(c(n({},e),{facilityId:parseInt(a)})),onSuccess:()=>{r("/reviews/my",{state:{message:"리뷰가 성공적으로 작성되었습니다."}})}}),S=(e,r)=>{s(a=>c(n({},a),{[e]:r}))};return a?L?x.jsx("div",{className:"min-h-screen bg-elderberry-25 py-8",children:x.jsx("div",{className:"max-w-2xl mx-auto px-4",children:x.jsx(C,{})})}):q||!I?x.jsx("div",{className:"min-h-screen bg-elderberry-25 py-8",children:x.jsx("div",{className:"max-w-2xl mx-auto px-4",children:x.jsx(R,{message:"시설 정보를 불러올 수 없습니다."})})}):x.jsx("div",{className:"min-h-screen bg-elderberry-25 py-8",children:x.jsxs("div",{className:"max-w-2xl mx-auto px-4",children:[x.jsxs("div",{className:"mb-8",children:[x.jsxs(w,{variant:"ghost",size:"sm",onClick:()=>r(-1),className:"mb-4 flex items-center gap-2",children:[x.jsx(y,{className:"w-4 h-4"}),"돌아가기"]}),x.jsxs("div",{className:"text-center",children:[x.jsx("h1",{className:"text-3xl font-bold text-elderberry-900 mb-2",children:"리뷰 작성"}),x.jsxs("div",{className:"bg-white rounded-lg p-4 shadow-sm mb-6",children:[x.jsx("h2",{className:"font-semibold text-elderberry-900",children:I.name}),x.jsx("p",{className:"text-sm text-elderberry-600",children:I.address})]})]})]}),x.jsxs("div",{className:"mb-8",children:[x.jsx("div",{className:"flex items-center justify-center space-x-4",children:[1,2,3,4].map(e=>x.jsxs("div",{className:"flex items-center",children:[x.jsx("div",{className:"w-8 h-8 rounded-full flex items-center justify-center text-sm font-medium "+(t>=e?"bg-elderberry-600 text-white":"bg-gray-200 text-gray-500"),children:t>e?x.jsx(p,{className:"w-5 h-5"}):e}),e<4&&x.jsx("div",{className:"w-12 h-0.5 "+(t>e?"bg-elderberry-600":"bg-gray-200")})]},e))}),x.jsx("div",{className:"flex justify-center mt-2",children:x.jsxs("span",{className:"text-sm text-elderberry-600",children:[1===t&&"전체 평점",2===t&&"세부 평점",3===t&&"리뷰 작성",4===t&&"추가 정보"]})})]}),x.jsx(j,{children:x.jsxs(k,{className:"p-6",children:[1===t&&x.jsxs(O.div,{initial:{opacity:0,x:50},animate:{opacity:1,x:0},className:"text-center",children:[x.jsx("h3",{className:"text-xl font-semibold text-elderberry-900 mb-6",children:"전체적으로 어떠셨나요?"}),x.jsx(f,{value:i.overallRating,onChange:e=>S("overallRating",e),size:"lg",className:"justify-center mb-4"}),x.jsx("p",{className:"text-elderberry-600 mb-8",children:"별점을 클릭해서 평가해주세요"})]}),2===t&&x.jsxs(O.div,{initial:{opacity:0,x:50},animate:{opacity:1,x:0},className:"space-y-6",children:[x.jsx("h3",{className:"text-xl font-semibold text-elderberry-900 mb-6",children:"세부 항목별 평가"}),A.map(e=>x.jsx("div",{className:"border-b border-elderberry-100 pb-4",children:x.jsxs("div",{className:"flex items-center justify-between mb-2",children:[x.jsxs("div",{children:[x.jsx("h4",{className:"font-medium text-elderberry-900",children:e.label}),x.jsx("p",{className:"text-sm text-elderberry-600",children:e.description})]}),x.jsx(f,{value:i[e.key],onChange:r=>S(e.key,r),size:"sm"})]})},e.key))]}),3===t&&x.jsxs(O.div,{initial:{opacity:0,x:50},animate:{opacity:1,x:0},className:"space-y-6",children:[x.jsx("h3",{className:"text-xl font-semibold text-elderberry-900 mb-6",children:"리뷰 내용 작성"}),x.jsxs("div",{children:[x.jsx("label",{className:"block text-sm font-medium text-elderberry-700 mb-2",children:"리뷰 제목 *"}),x.jsx("input",{type:"text",value:i.title,onChange:e=>s(r=>c(n({},r),{title:e.target.value})),placeholder:"리뷰 제목을 입력해주세요",className:"w-full px-4 py-3 border border-elderberry-200 rounded-lg focus:outline-none focus:ring-2 focus:ring-elderberry-500",maxLength:100}),x.jsxs("div",{className:"text-right text-xs text-elderberry-500 mt-1",children:[i.title.length,"/100"]})]}),x.jsxs("div",{children:[x.jsx("label",{className:"block text-sm font-medium text-elderberry-700 mb-2",children:"상세 리뷰 *"}),x.jsx("textarea",{value:i.content,onChange:e=>s(r=>c(n({},r),{content:e.target.value})),placeholder:"시설 이용 경험을 자세히 작성해주세요. 다른 이용자들에게 도움이 되는 정보를 포함해주시면 감사하겠습니다.",className:"w-full px-4 py-3 border border-elderberry-200 rounded-lg focus:outline-none focus:ring-2 focus:ring-elderberry-500",rows:6,maxLength:1e3}),x.jsxs("div",{className:"text-right text-xs text-elderberry-500 mt-1",children:[i.content.length,"/1000"]})]})]}),4===t&&x.jsxs(O.div,{initial:{opacity:0,x:50},animate:{opacity:1,x:0},className:"space-y-6",children:[x.jsx("h3",{className:"text-xl font-semibold text-elderberry-900 mb-6",children:"추가 정보"}),x.jsxs("div",{children:[x.jsx("label",{className:"block text-sm font-medium text-elderberry-700 mb-3",children:"태그 선택 (선택사항)"}),x.jsx("div",{className:"flex flex-wrap gap-2",children:F.map(e=>x.jsx("button",{type:"button",onClick:()=>(e=>{s(r=>c(n({},r),{tags:r.tags.includes(e)?r.tags.filter(r=>r!==e):[...r.tags,e]}))})(e),className:"px-3 py-2 text-sm rounded-full border transition-colors "+(i.tags.includes(e)?"bg-elderberry-100 border-elderberry-500 text-elderberry-700":"bg-white border-gray-300 text-gray-700 hover:border-elderberry-300"),children:e},e))})]}),x.jsxs("div",{children:[x.jsx("label",{className:"block text-sm font-medium text-elderberry-700 mb-3",children:"이 시설을 다른 분들께 추천하시겠어요?"}),x.jsxs("div",{className:"flex gap-4",children:[x.jsx("button",{type:"button",onClick:()=>s(e=>c(n({},e),{wouldRecommend:!0})),className:"px-4 py-2 rounded-lg border transition-colors "+(i.wouldRecommend?"bg-green-50 border-green-500 text-green-700":"bg-white border-gray-300 text-gray-700 hover:border-green-300"),children:"추천합니다"}),x.jsx("button",{type:"button",onClick:()=>s(e=>c(n({},e),{wouldRecommend:!1})),className:"px-4 py-2 rounded-lg border transition-colors "+(i.wouldRecommend?"bg-white border-gray-300 text-gray-700 hover:border-red-300":"bg-red-50 border-red-500 text-red-700"),children:"추천하지 않습니다"})]})]}),x.jsxs("div",{className:"flex items-center",children:[x.jsx("input",{type:"checkbox",id:"anonymous",checked:i.isAnonymous,onChange:e=>s(r=>c(n({},r),{isAnonymous:e.target.checked})),className:"mr-3 text-elderberry-600 focus:ring-elderberry-500"}),x.jsx("label",{htmlFor:"anonymous",className:"text-sm text-elderberry-700",children:"익명으로 리뷰 작성하기"})]})]}),x.jsxs("div",{className:"flex justify-between mt-8",children:[x.jsx(w,{variant:"outline",onClick:()=>l(Math.max(1,t-1)),disabled:1===t,children:"이전"}),t<4?x.jsx(w,{variant:"primary",onClick:()=>l(t+1),disabled:!(e=>{switch(e){case 1:return i.overallRating>0;case 2:return A.every(e=>i[e.key]>0);case 3:return i.title.trim()&&i.content.trim();default:return!1}})(t),children:"다음"}):x.jsx(w,{variant:"primary",onClick:()=>{i.title.trim()&&i.content.trim()&&0!==i.overallRating?z.mutate(i):alert("제목, 내용, 전체 평점은 필수입니다.")},disabled:z.isPending||!i.title.trim()||!i.content.trim(),className:"flex items-center gap-2",children:z.isPending?x.jsxs(x.Fragment,{children:[x.jsx(g,{className:"w-4 h-4 animate-spin"}),"작성 중..."]}):x.jsxs(x.Fragment,{children:[x.jsx(u,{className:"w-4 h-4"}),"리뷰 작성 완료"]})})]}),z.error&&x.jsx("div",{className:"mt-4 p-3 bg-red-50 border border-red-200 rounded-lg",children:x.jsx("p",{className:"text-red-800 text-sm",children:"리뷰 작성 중 오류가 발생했습니다. 다시 시도해주세요."})})]})})]})}):x.jsx("div",{className:"min-h-screen bg-elderberry-25 py-8",children:x.jsx("div",{className:"max-w-2xl mx-auto px-4",children:x.jsx(R,{message:"잘못된 접근입니다. 시설을 선택해주세요."})})})};export{I as default};
